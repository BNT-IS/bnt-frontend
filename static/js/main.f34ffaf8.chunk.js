(this["webpackJsonpexample-client"]=this["webpackJsonpexample-client"]||[]).push([[0],{148:function(e,t,a){},16:function(e,t){e.exports={BACKEND_BASE_URI:"http://localhost:3000",INFURA_URI:"https://mainnet.infura.io/v3/efaece4f5f4443979063839c124c8171"}},257:function(e,t,a){e.exports=a(532)},262:function(e,t,a){},263:function(e,t,a){},269:function(e,t,a){},297:function(e,t){},298:function(e,t){},299:function(e,t){},300:function(e,t){},301:function(e,t){},302:function(e,t){},303:function(e,t){},304:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=304},305:function(e,t){},306:function(e,t,a){},322:function(e,t){},347:function(e,t){},349:function(e,t){},393:function(e,t){},395:function(e,t){},424:function(e,t){},532:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(47),s=a.n(i),c=a(22),l=(a(262),a(5)),o=a(6),u=a(3),h=a(7),d=a(8),m=(a(263),r.a.createContext()),p=a(2),f=a.n(p),b=a(10),g=a(31),k=a(546),v=a(144),E=a(254),S=a(557),T=a(16),w=a.n(T),O=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).createUser=n.createUser.bind(Object(u.a)(n)),n.login=n.login.bind(Object(u.a)(n)),n.loginPassHandler=n.loginPassHandler.bind(Object(u.a)(n)),n.mailHandler=n.mailHandler.bind(Object(u.a)(n)),n.otpBest\u00e4tigen=n.otpBest\u00e4tigen.bind(Object(u.a)(n)),n.otpInputHandler=n.otpInputHandler.bind(Object(u.a)(n)),n.pass1Handler=n.pass1Handler.bind(Object(u.a)(n)),n.pass2Handler=n.pass2Handler.bind(Object(u.a)(n)),n.setState1=n.setState1.bind(Object(u.a)(n)),n.setState6=n.setState6.bind(Object(u.a)(n)),n.state={dhbw_mail:"",login_pass:"",new_pass:"",otp:"",pass1:"",pass2:"",step:0,access_token:""},n.tokenHandler=n.tokenHandler.bind(Object(u.a)(n)),n.verifyPasswort=n.verifyPasswort.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"otpInputHandler",value:function(e){this.setState({otp:e.target.value})}},{key:"tokenHandler",value:function(e){this.setState({access_token:e.target.value})}},{key:"otpBest\xe4tigen",value:function(){console.log(this.state.otp),this.setState({step:2})}},{key:"pass1Handler",value:function(e){this.setState({pass1:e.target.value})}},{key:"pass2Handler",value:function(e){this.setState({pass2:e.target.value})}},{key:"mailHandler",value:function(e){this.setState({dhbw_mail:e.target.value})}},{key:"loginPassHandler",value:function(e){this.setState({login_pass:e.target.value})}},{key:"verifyPasswort",value:function(){this.state.pass1===this.state.pass2?(alert("Die angegebenen Passw\xf6rter stimmen \xfcberein!"),this.createUser(this.state.pass2)):(alert("Die angegebenen Passw\xf6rter stimmen nicht \xfcberein!"),this.setState({pass1:""}),this.setState({pass2:""}))}},{key:"displayError",value:function(){alert("Ups, das hat leider nicht funktioniert. Bitte versuchen Sie es erneut.")}},{key:"createUser",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/auth/createUser/"+this.state.otp,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({newPassword:t})}).catch(console.log);case 2:if((a=e.sent).ok){e.next=12;break}return alert("F\xfcr das eingegebene OTP konnte kein User angelegt werden."),e.next=7,a.json().catch(console.log);case 7:return(n=e.sent).message&&(alert(n.message+" Ihr angegebenes OTP scheint nicht zu exisitieren. Bitte \xfcberpr\xfcfen Sie die Eingabe."),this.setState({step:1})),e.abrupt("return");case 12:return e.next=14,a.json().catch(console.log);case 14:(r=e.sent)&&(alert("Der Nutzer wurde erfolgreich angelegt."),this.handleFinalLogin(r));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/auth/login",{method:"POST",mose:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.state.dhbw_mail,password:this.state.login_pass})}).catch(console.log);case 2:if((t=e.sent).ok){e.next=19;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,e.t0=t.status,e.next=401===e.t0?10:500===e.t0?12:14;break;case 10:return alert("Ihre Anmeldedaten scheinen nicht zu stimmen. Bitte \xfcberpr\xfcfen Sie ihre Angaben."),e.abrupt("break",15);case 12:return alert("Die Anmeldung ist aufgrund eines Server-Fehlers fehlgeschlagen. Bitte versuchen Sie es sp\xe4ter erneut."),e.abrupt("break",15);case 14:alert(a.message);case 15:return this.setState({step:6}),e.abrupt("return");case 19:return e.next=21,t.json().catch(console.log);case 21:(n=e.sent)&&this.handleFinalLogin(n);case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleFinalLogin",value:function(e){localStorage.setItem("userContext",JSON.stringify(e)),this.context.reloadLocalStorage()}},{key:"setState1",value:function(){this.setState({step:1})}},{key:"setState6",value:function(){this.setState({step:6})}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"AccountManagement",gap:"small"},r.a.createElement(k.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(v.a,null,"BNT Ticketsystem")),r.a.createElement(g.a,{pad:"small"},0===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Klicke hier, um einen neuen Account anzulegen"),r.a.createElement(E.a,{label:"Neuen Account anlegen",gap:"small",onClick:this.setState1}),r.a.createElement(v.a,null,"Klicke hier, um dich mit einem bestehenden Account anzumelden"),r.a.createElement(E.a,{label:"Mit bestehendem Account anmelden",onClick:this.setState6})),1===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Bitte geben Sie das OneTime-Passwort ein, das wir an Ihre DHBW-Mailadresse versendet haben, und best\xe4tigen Sie die Eingabe"),r.a.createElement(S.a,{placeholder:"OTP eingeben",value:this.state.otp,onChange:this.otpInputHandler}),r.a.createElement(E.a,{label:"Eingabe best\xe4tigen",onClick:this.otpBest\u00e4tigen})),2===this.state.step&&r.a.createElement(g.a,{classname:"Passwortvergabe",direction:"column",gap:"small"},r.a.createElement("h1",null,"Passwortvergabe"),r.a.createElement(v.a,null,"Bitte vergeben Sie ein neues Passwort f\xfcr Ihren Account"),r.a.createElement(S.a,{placeholder:"Neues Passwort vergeben",value:this.state.pass1,onChange:this.pass1Handler}),r.a.createElement(S.a,{placeholder:"Neues Passwort best\xe4tigen",value:this.state.pass2,onChange:this.pass2Handler}),r.a.createElement(E.a,{label:"Passwort best\xe4tigen",onClick:this.verifyPasswort})),6===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement("h1",null,"Anmeldung mit einem vorhandenen Account"),r.a.createElement(S.a,{placeholder:"DHBW-Mailadresse eingeben",value:this.state.dhbw_mail,onChange:this.mailHandler}),r.a.createElement(S.a,{placeholder:"Account-Passwort eingeben",value:this.state.login_pass,onChange:this.loginPassHandler}),r.a.createElement(E.a,{label:"Anmelden",onClick:this.login}))))}}]),a}(r.a.Component);O.contextType=m;var y=O,C=a(549),x=a(48),j=(a(269),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(g.a,{className:"UserMainMenu",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(c.b,{className:"MenuLink",to:"/guest/tickets"},"Tickets Anzeigen"),r.a.createElement(c.b,{className:"MenuLink",to:"/guest/buy"},"Tickets Buchen"),r.a.createElement(c.b,{className:"MenuLink",to:"/guest/bookings"},"Buchungen Anzeigen"))}}]),a}(r.a.Component)),A=(a(148),a(66)),B=a.n(A),R=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).state={},n.identifier=window.location.hash.replace("#/guest/tickets/",""),n.ticket={forename:null,surename:null,ticketType:null};var r=n.props.tickets.find((function(e){return e.identifier===n.identifier}));return r&&(n.ticket=r),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.generateQRCode(this.ticket)}},{key:"generateQRCode",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={id:t.identifier,sIG:this.context.user.secretIngredient},B.a.toDataURL(JSON.stringify(a)).then((function(e){n.setState({qrcode:e})})).catch(console.log);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(g.a,{className:"SingleTicket"},r.a.createElement(g.a,{pad:"small"},r.a.createElement("p",null,this.ticket.forename),r.a.createElement("p",null,this.ticket.surname),r.a.createElement("p",null,this.ticket.ticketType)),r.a.createElement(g.a,{pad:"small"},r.a.createElement("img",{width:"300",height:"300",src:this.state.qrcode,alt:"Hier sollte ein QR-Code stehen"})))}}]),a}(r.a.Component);function z(e){return r.a.createElement(g.a,{className:"TicketListItem",direction:"row",gap:"small",pad:"small"},r.a.createElement(v.a,{className:"Name"},e.ticket.forename," ",e.ticket.surname),r.a.createElement(v.a,{className:"Type"},e.ticket.ticketType),r.a.createElement(E.a,{label:"Anzeigen",onClick:function(){window.location.assign("#/guest/tickets/"+e.ticket.identifier)}}))}R.contextType=m;var N=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={tickets:[],loading:!1},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.fetchTickets()}},{key:"fetchTickets",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,fetch(w.a.BACKEND_BASE_URI+"/api/v2/users/"+this.context.user.id+"/tickets",{mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.context.token}}).catch(console.log);case 3:if((t=e.sent).ok){e.next=8;break}return this.setState({loading:!1}),alert("Beim Laden der Tickets ist ein Fehler aufgetreten."),e.abrupt("return");case 8:return e.next=10,t.json().catch(console.log);case 10:if(a=e.sent){e.next=13;break}return e.abrupt("return");case 13:a.forEach((function(e){switch(e.ticketType){case"0":e.ticketType="Absolvent";break;case"1":e.ticketType="Begleitperson";break;case"2":e.ticketType="Parkticket"}})),this.setState({tickets:a,loading:!1});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setToken",value:function(e){localStorage.setItem("Tokenwert",e)}},{key:"getToken",value:function(){var e=localStorage.getItem("Tokenwert");console.log(e)}},{key:"render",value:function(){var e=this.state.tickets.map((function(e){return r.a.createElement(z,{key:e.identifier,ticket:e})}));return r.a.createElement(g.a,{className:"TicketOverview",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/guest/tickets/:identifier"},r.a.createElement(c.b,{to:"/guest/tickets/"},"Alle Tickets anzeigen"),r.a.createElement(R,{tickets:this.state.tickets})),r.a.createElement(x.a,{path:"/guest/tickets/"},r.a.createElement(g.a,null,r.a.createElement(g.a,null,r.a.createElement("h1",{className:"NumberOfTickets"},this.state.tickets.length)),r.a.createElement(g.a,{className:"TicketList"},this.state.loading&&r.a.createElement("p",{className:"loader"}),e)))))}}]),a}(r.a.Component);N.contextType=m;var D=N,H=a(556),I=a(548),M=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){var e=[];this.props.tickets.forEach((function(t){e.push(r.a.createElement(g.a,{key:t.identifier,pad:"small"},r.a.createElement("span",null,"Ticket Identifier: ",t.identifier),r.a.createElement("span",null,"Nachname: ",t.surname),r.a.createElement("span",null,"Vorname: ",t.forename),r.a.createElement("span",null,"Ticket Typ: ",t.ticketType)))}));var t=this.props.booking,a="Buchung "+t.id+", gebucht am "+new Date(t.createdAt).toLocaleDateString()+" - "+(t.paidAt?"Bezahlt":"Zahlung ausstehend");return r.a.createElement(H.a,{label:a},e.length>0&&r.a.createElement(v.a,{margin:"small"},"Folgende Tickets wurden gebucht:"),e.length>0&&e,0===e.length&&r.a.createElement(v.a,{margin:"small"},"Keine Daten vorhanden."))}}]),a}(r.a.Component),P=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).loadListHandler=n.loadListHandler.bind(Object(u.a)(n)),n.loadTicketsHandler=n.loadTicketsHandler.bind(Object(u.a)(n)),n.state={buchungen:[],tickets:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.loadListHandler()}},{key:"loadListHandler",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,fetch(w.a.BACKEND_BASE_URI+"/api/v2/users/"+this.context.user.id+"/bookings",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.context.token}}).catch(console.log);case 3:if((t=e.sent).ok){e.next=7;break}return alert("Buchungen konnten nicht geladen werden."),e.abrupt("return");case 7:return e.next=9,t.json().catch(console.log);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:this.setState({buchungen:a,loading:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadTicketsHandler",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(a=this.state.buchungen[t].id,-1===this.state.tickets.findIndex((function(e){return e.bookingId===a}))){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,fetch(w.a.BACKEND_BASE_URI+"/api/v2/bookings/"+a+"/ticketsBooked",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.context.token}}).catch(console.log);case 8:if((n=e.sent).ok){e.next=12;break}return alert("Gebuchte Tickets konnten nicht geladen werden."),e.abrupt("return");case 12:return e.next=14,n.json().catch(console.log);case 14:if(r=e.sent){e.next=17;break}return e.abrupt("return");case 17:i=(i=this.state.tickets).concat(r),this.setState({tickets:i});case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[];return this.state.buchungen.forEach((function(a){var n=e.state.tickets.filter((function(e){return e.bookingId===a.id}));t.push(r.a.createElement(M,{key:a.id,booking:a,tickets:n}))})),r.a.createElement(g.a,{className:"BookingOverview",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(g.a,null,this.state.loading&&r.a.createElement("p",{className:"loader"}),t.length>0&&r.a.createElement(I.a,{onActive:function(t){e.loadTicketsHandler(t[0])}},t),0===t.length&&r.a.createElement(v.a,null,"Keine Buchungen vorhanden")))}}]),a}(r.a.Component);P.contextType=m;var _=P,L=a(85),U=a(558),V=(a(296),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onInputHandler=n.onInputHandler.bind(Object(u.a)(n)),n.onCheckBox=n.onCheckBox.bind(Object(u.a)(n)),n.state={forename:"",surname:"",isWheelchairUser:!1},n}return Object(o.a)(a,[{key:"onInputHandler",value:function(e){var t=this.state;t[e.target.name]=e.target.value,this.setState(t),this.props.onInput(this.state)}},{key:"onCheckBox",value:function(e){var t=this.state;t[e.target.name]=!t[e.target.name],this.setState(t),this.props.onInput(this.state)}},{key:"render",value:function(){return r.a.createElement(g.a,null,r.a.createElement(S.a,{name:"forename",placeholder:"Vorname des Gastes",value:this.state.forename,onChange:this.onInputHandler}),r.a.createElement(S.a,{name:"surname",placeholder:"Nachname des Gastes",value:this.state.surname,onChange:this.onInputHandler}),r.a.createElement(U.a,{name:"isWheelchairUser",label:"Rollstuhlfahrer bitte ankreuzen",onChange:this.onCheckBox,checked:this.state.isWheelchairUser}))}}]),a}(r.a.Component)),W=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).increment=function(e){if("guest"===e&&n.state.guestcount<2){var t=n.state.persons.length,a=r.a.createElement(V,{key:t,onInput:function(e){var a=n.state.persons;a[t]=e,n.setState({persons:a})}}),i=n.state.persons;i[t]={},n.state.personInputFields.push(a),n.setState({persons:i,personInputFields:n.state.personInputFields,guestcount:n.state.guestcount+1})}else"park"===e&&n.state.parkcount<3&&n.setState({parkcount:n.state.parkcount+1})},n.decrement=function(e){"guest"===e&&n.state.guestcount>0?(n.state.personInputFields.pop(),n.state.persons.pop(),n.setState({guestcount:n.state.guestcount-1,personInputFields:n.state.personInputFields,persons:n.state.persons})):"park"===e&&n.state.parkcount>0&&n.setState({parkcount:n.state.parkcount-1})},n.WindowAbsolventTicket=n.WindowAbsolventTicket.bind(Object(u.a)(n)),n.WindowGuestTicket=n.WindowGuestTicket.bind(Object(u.a)(n)),n.WindowParkTicket=n.WindowParkTicket.bind(Object(u.a)(n)),n.ToOverview=n.ToOverview.bind(Object(u.a)(n)),n.ToOrder=n.ToOrder.bind(Object(u.a)(n)),n.ToPayment=n.ToPayment.bind(Object(u.a)(n)),n.createTickets=n.createTickets.bind(Object(u.a)(n)),n.createBooking=n.createBooking.bind(Object(u.a)(n)),n.onInputHandler=n.onInputHandler.bind(Object(u.a)(n)),n.state={guestcount:0,parkcount:0,step:0,persons:[],personInputFields:[],graduate:{forename:"",surname:"",isWheelchairUser:!1},bookingResult:null},n}return Object(o.a)(a,[{key:"onInputHandler",value:function(e,t){"forename"===t?this.setState({graduate:{forename:e.target.value,surname:this.state.graduate.surname}}):this.setState({graduate:{surname:e.target.value,forename:this.state.graduate.forename}})}},{key:"WindowAbsolventTicket",value:function(){this.setState({step:0})}},{key:"WindowGuestTicket",value:function(){this.setState({step:1})}},{key:"WindowParkTicket",value:function(){this.setState({step:2})}},{key:"ToOverview",value:function(){this.setState({step:3})}},{key:"ToPayment",value:function(){this.setState({step:4})}},{key:"ToOrder",value:function(){this.setState({step:5})}},{key:"createBooking",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"1",e.next=3,fetch(w.a.BACKEND_BASE_URI+"/api/v2/bookings",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"},body:JSON.stringify({userId:"1"})}).catch(console.log);case 3:if(t=e.sent){e.next=7;break}return this.setState({step:100}),e.abrupt("return");case 7:return e.next=9,t.json().catch(console.log);case 9:if(a=e.sent,console.log(a),this.setState({bookingResult:a}),a){e.next=15;break}return this.setState({step:100}),e.abrupt("return");case 15:return console.log(a),e.next=18,this.createTickets();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateIdentifier",value:function(){return 1e5*Math.random()}},{key:"createTickets",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a,n,r,i,s,c,l,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(this.state),t=this.state.bookingResult.id,a=Object(L.a)(this.state.persons),e.prev=3,a.s();case 5:if((n=a.n()).done){e.next=23;break}return r=n.value,console.log(r),e.next=10,fetch(w.a.BACKEND_BASE_URI+"/api/v2/ticketsBooked",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 16888740f668f0c4b660e0fd259fc0f0b7b784493a114ca44ad9528192384ca3fc7e85c71bb32c25c52637677b850b95739d9f7128014fe42a904efb027f46f91c342428c74fb734487898bbf64d796b565fa54b8099015388212e45e72b36b859e729aaf343d885fd976d10be72c5e4a172d0223b34a361ed796944c912cfdef23a2d5e4cf2fbf3cf0febe0843fa7e9b2d18d26d299745451f2930f24766077f2b3520f920bde85fe2d7f012c06bd47384aa402789e9c8c640da8aa3c43b442f649710e3a589b5c72ebf3e621987740f3af49fae6d2a484f50f40466091ae6c249ccbb116c209ccadffe899a819eabc82b54f69e7da3599f74f371015709150"},body:JSON.stringify({identifier:this.generateIdentifier(),bookingId:t,ticketType:1,forename:r.forename,surname:r.surname,isWheelchairUser:r.isWheelchairUser})}).catch(console.log);case 10:if(i=e.sent){e.next=14;break}return this.setState({step:100}),e.abrupt("return");case 14:return e.next=16,i.json().catch(console.log);case 16:if(s=e.sent){e.next=20;break}return this.setState({step:100}),e.abrupt("return");case 20:console.log(s);case 21:e.next=5;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(3),a.e(e.t0);case 28:return e.prev=28,a.f(),e.finish(28);case 31:return e.next=33,fetch(w.a.BACKEND_BASE_URI+"/api/v2/ticketsBooked",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"},body:JSON.stringify({identifier:this.generateIdentifier(),bookingId:t,ticketType:0,forename:this.state.graduate.forename,surname:this.state.graduate.surname,isWheelchairUser:!1})}).catch(console.log);case 33:if(i=e.sent){e.next=37;break}return this.setState({step:100}),e.abrupt("return");case 37:return e.next=39,i.json().catch(console.log);case 39:if(s=e.sent){e.next=43;break}return this.setState({step:100}),e.abrupt("return");case 43:console.log(s),this.ToOrder(),c=Object(L.a)(this.state.parkcount),e.prev=46,c.s();case 48:if((l=c.n()).done){e.next=66;break}return o=l.value,console.log(o),e.next=53,fetch(w.a.BACKEND_BASE_URI+"/api/v2/ticketsBooked",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"},body:JSON.stringify({identifier:this.generateIdentifier(),bookingId:t,ticketType:2,forename:o.forename,surname:o.surname,isWheelchairUser:o.isWheelchairUser})}).catch(console.log);case 53:if(i=e.sent){e.next=57;break}return this.setState({step:100}),e.abrupt("return");case 57:return e.next=59,i.json().catch(console.log);case 59:if(s=e.sent){e.next=63;break}return this.setState({step:100}),e.abrupt("return");case 63:console.log(s);case 64:e.next=48;break;case 66:e.next=71;break;case 68:e.prev=68,e.t1=e.catch(46),c.e(e.t1);case 71:return e.prev=71,c.f(),e.finish(71);case 74:case"end":return e.stop()}}),e,this,[[3,25,28,31],[46,68,71,74]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return console.log(this.state.persons),r.a.createElement(g.a,{className:"TicketBestellung",direction:"column",gap:"medium",pad:"medium"},0===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Bitte tragen Sie ihren Namen in die Felder ein und best\xe4tigen Sie die Eingabe mit dem Button!"),r.a.createElement(S.a,{name:"forename",placeholder:"Vorname des Absolventen",value:this.state.graduate.forename,onChange:function(t){return e.onInputHandler(t,"forename")}}),r.a.createElement(S.a,{name:"surname",placeholder:"Nachname des Absolventen",value:this.state.graduate.surname,onChange:function(t){return e.onInputHandler(t,"surname")}}),r.a.createElement(U.a,{name:"isWheelchairUser",label:"Rollstuhlfahrer bitte ankreuzen",value:this.state.graduate.isWheelchairUser,onChange:this.onCheckBox,checked:this.state.isWheelchairUser}),r.a.createElement(E.a,{label:" Ein Absolventen Ticket kaufen",onClick:this.WindowGuestTicket,gap:"small"})),1===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Bitte geben sie an, wie viele Begleitpersonen Sie mitnehmen wollen."),r.a.createElement(E.a,{onClick:function(){return e.increment("guest")},className:"guestcount",label:"+"}),r.a.createElement(E.a,{onClick:function(){return e.decrement("guest")},className:"guestcount",label:"-"}),r.a.createElement("h2",null,this.state.guestcount),this.state.personInputFields,r.a.createElement(E.a,{onClick:this.WindowAbsolventTicket,label:"Zur\xfcck"}),r.a.createElement(E.a,{onClick:this.WindowParkTicket,label:"Weiter"})),2===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Bitte geben sie an, wie viele Parktickets Sie ben\xf6tigen."),r.a.createElement(E.a,{onClick:function(){return e.increment("park")},className:"parkcount",label:"+"}),r.a.createElement(E.a,{onClick:function(){return e.decrement("park")},className:"parkcount",label:"-"}),r.a.createElement("h2",null,"Anzahl der Parktickets: ",this.state.parkcount),r.a.createElement(E.a,{onClick:this.WindowGuestTicket,label:"Zur\xfcck"}),r.a.createElement(E.a,{onClick:this.ToOverview,label:"Weiter"})),3===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Sie haben folgende Tickets bestellt: ",r.a.createElement("br",null),"Absolventent: 1 ",r.a.createElement("br",null),"Begleitpersonen: ",this.state.guestcount," ",r.a.createElement("br",null),"Parkticket ",this.state.parkcount),r.a.createElement(E.a,{onClick:this.WindowParkTicket,label:"Zur\xfcck"}),r.a.createElement(E.a,{onClick:this.ToPayment,label:"Zahlungspflichtig bestellen"})),4===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Sie haben folgende Tickets Zahlungspflichtig bestellt.  ",r.a.createElement("br",null),"Bitte \xfcberweisen Sie folgenden Betrag auf das Konto: XXXXYYYYZZZZ.",r.a.createElement("br",null),"Geben Sie ihren Namen als Verwendungszweck an.",r.a.createElement("br",null),"Nach Rechnungseingang erhalten Sie Ihre Tickets an ihr Wallet gesendet.",r.a.createElement("br",null)),r.a.createElement(v.a,null,"Sie haben folgende Tickets bestellt: ",r.a.createElement("br",null),"Absolventent: 1 ",r.a.createElement("br",null),"Begleitpersonen: ",this.state.guestcount," ",r.a.createElement("br",null),"Parkticket ",this.state.parkcount),r.a.createElement(E.a,{label:"Buchung erstellen",onClick:this.createBooking})),5===this.state.step&&r.a.createElement(g.a,{gap:"small"},"Erfolgreich bestellt!"),100===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(v.a,null,"Ein Fehler im Bestellvorgang ist aufgetreten!")))}}]),a}(r.a.Component),F=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(g.a,{className:"Guest"},r.a.createElement(k.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(c.b,{to:"/guest"},"Home"),r.a.createElement(m.Consumer,null,(function(e){return r.a.createElement(C.a,{label:"Account",items:[{label:"Logout",onClick:e.logout}]})}))),r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/guest/buy"},r.a.createElement(W,null)),r.a.createElement(x.a,{path:"/guest/tickets/"},r.a.createElement(D,null)),r.a.createElement(x.a,{path:"/guest/bookings"},r.a.createElement(_,null)),r.a.createElement(x.a,{path:"/guest/"},r.a.createElement(j,null))))}}]),a}(r.a.Component),K=a(250),G=a(246),q=a.n(G),J=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.video=r.a.createRef(),n.canvasElement=r.a.createRef(),n.startScan=n.startScan.bind(Object(u.a)(n)),n.tick=n.tick.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"componentWillUnmount",value:function(){this.stopScan()}},{key:"tick",value:function(){if(this.video&&this.video.current){if(this.video.current.readyState===this.video.current.HAVE_ENOUGH_DATA){this.canvasElement.current.height=320,this.canvasElement.current.width=320,this.canvas.drawImage(this.video.current,0,0,this.canvasElement.current.width,this.canvasElement.current.height);var e=this.canvas.getImageData(0,0,this.canvasElement.current.width,this.canvasElement.current.height),t=q()(e.data,e.width,e.height,{inversionAttempts:"dontInvert"});if(t)switch(this.props.contentType){case"ETHEREUM_ADDRESS":var a=t.data.match(Object(K.a)(/(?:ethereum:)(0x[0-9A-Za-z]*)/,{address:1}));if(a&&a.groups.address)return this.stopScan(),void this.props.onDone(a.groups.address);break;case"ETHEREUM_SIGNATURE":case"IP_ADDRESS":case"JSON_DATA":break;default:return this.stopScan(),void this.props.onDone(t.data)}}requestAnimationFrame(this.tick)}}},{key:"startScan",value:function(){var e=this;if(!navigator.mediaDevices)return alert("Der Browser unterst\xfctzt diese Funktion nicht.");navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:320,height:320}}).then((function(t){e.canvas=e.canvasElement.current.getContext("2d"),e.video.current.srcObject=t,e.video.current.setAttribute("playsinline",!0),e.video.current.play(),requestAnimationFrame(e.tick),e.setState({isScanning:!0})})).catch((function(e){console.error(e),alert("Sorry, Kamera-Stream konnte nicht geladen werden.")}))}},{key:"stopScan",value:function(){this.video&&this.video.current&&this.video.current.srcObject&&(this.video.current.srcObject.getVideoTracks()[0].stop(),this.setState({isScanning:!1}))}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"QRScanner"},r.a.createElement("div",null,r.a.createElement("canvas",{ref:this.canvasElement,hidden:!this.state.isScanning}),r.a.createElement("video",{ref:this.video,hidden:!0})),!this.state.isScanning&&r.a.createElement(E.a,{label:this.props.label||"Scan",onClick:this.startScan}))}}]),a}(r.a.Component),Q=(a(306),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"dialog"},r.a.createElement("div",{className:"dialog-background-box"}),r.a.createElement("div",{className:"dialog-center"},r.a.createElement("div",{className:"dialog-content"},r.a.createElement("div",{className:"dialog-header"},r.a.createElement("h1",null,this.props.title),r.a.createElement(E.a,{className:"abort",onClick:this.props.onAbort},"X")),r.a.createElement("div",{className:"dialog-body"},this.props.children))))}}]),a}(r.a.Component)),Z=(a(229),function(){function e(){Object(l.a)(this,e),this._iceCandidatesHandler=this._iceCandidatesHandler.bind(this),this._dataChannelOpenHandler=this._dataChannelOpenHandler.bind(this),this._receiveChannelHandler=this._receiveChannelHandler.bind(this),this._dataChannelClosedHandler=this._dataChannelClosedHandler.bind(this),this._connectionChangeHandler=this._connectionChangeHandler.bind(this),this._generateAnswer=this._generateAnswer.bind(this),this._messageHandler=this._messageHandler.bind(this),this.requestMap=new Map,this.icecandidates=[],this.remoteICECandidates=[],this.onConnectionChanged=function(e){},this._initConnection()}return Object(o.a)(e,[{key:"_initConnection",value:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null,this.localPeerConnection=new RTCPeerConnection(null),this.localPeerConnection.addEventListener("icecandidate",this._iceCandidatesHandler),this.localPeerConnection.addEventListener("connectionstatechange",this._connectionChangeHandler),this.localPeerConnection.addEventListener("datachannel",this._receiveChannelHandler);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_iceCandidatesHandler",value:function(e){this.icecandidates.push(e.candidate),this.answer&&!this.qrcode&&setTimeout(this._generateAnswer,200)}},{key:"_connectionChangeHandler",value:function(e){console.debug(e);var t=e.target.connectionState;this.onConnectionChanged(t)}},{key:"_dataChannelOpenHandler",value:function(e){console.debug(e),this.onReady()}},{key:"_dataChannelClosedHandler",value:function(e){console.debug(e)}},{key:"_messageHandler",value:function(e){console.debug(e.data);try{var t=JSON.parse(e.data);if(t.reqId){var a=this.requestMap.get(t.reqId);t.error?a.reject(t.error):a.resolve(t.result)}}catch(n){console.error(n)}}},{key:"_receiveChannelHandler",value:function(e){this.dataChannel=e.channel,this.dataChannel.addEventListener("message",this._messageHandler),this.dataChannel.addEventListener("open",this._dataChannelOpenHandler),this.dataChannel.addEventListener("close",this._dataChannelClosedHandler)}},{key:"_createUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:0&a).toString(16)}))}},{key:"readTicketRemote",value:function(e){var t=this;return new Promise((function(a,n){var r=t._createUUID();t.requestMap.set(r,{resolve:a,reject:n});var i={type:"Request",reqId:r,context:"ticketMirror",method:"getTicket",params:[e]};try{t.dataChannel.send(JSON.stringify(i))}catch(s){n(s)}}))}},{key:"obliterateTicketRemote",value:function(e,t){var a=this;return new Promise((function(n,r){var i=a._createUUID();a.requestMap.set(i,{resolve:n,reject:r});var s={type:"Request",reqId:i,context:"ticketMirror",method:"obliterateTicket",params:[e,t]};try{a.dataChannel.send(JSON.stringify(s))}catch(c){r(c)}}))}},{key:"setMasterConfig",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(t.offer)).catch(console.error);case 2:return t.candidates.forEach((function(e){a.localPeerConnection.addIceCandidate(e).catch(console.error),a.remoteICECandidates.push(e)})),e.next=5,this.localPeerConnection.createAnswer().catch(console.error);case 5:return this.answer=e.sent,e.next=8,this.localPeerConnection.setLocalDescription(this.answer).catch(console.error);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_generateAnswer",value:function(){var e={answer:this.answer,candidates:this.icecandidates};this.onAnswer(e)}},{key:"toJSON",value:function(){var e={localDescription:this.localPeerConnection.currentLocalDescription,remoteDescription:this.localPeerConnection.currentRemoteDescription,candidates:this.remoteICECandidates};return JSON.stringify(e)}}]),e}()),X=a(69),Y=a.n(X),$=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={connected:null,currentTicket:null},n.connectTicketReader=n.connectTicketReader.bind(Object(u.a)(n)),n.scanDoneHandler=n.scanDoneHandler.bind(Object(u.a)(n)),n.capturedTicketHandler=n.capturedTicketHandler.bind(Object(u.a)(n)),n.obliterateTicketHandler=n.obliterateTicketHandler.bind(Object(u.a)(n)),n.closeTicketViewHandler=n.closeTicketViewHandler.bind(Object(u.a)(n)),n.ticketReader=null,n}return Object(o.a)(a,[{key:"translateTicketType",value:function(e){switch(e){case"0":return"Absolvent";case"1":return"Begleitperson";case"2":return"Parkticket"}}},{key:"connectTicketReader",value:function(){var e=this,t=new Z;t.onReady=function(){e.ticketReader=e.state.connectTR,e.setState({connectTR:null})},t.onConnectionChanged=function(t){switch(t){case"connected":case"disconnected":case"failed":case"closed":e.setState({connected:t})}},t.onAnswer=function(){var t=Object(b.a)(f.a.mark((function t(a){var n,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Y.a.deflate(JSON.stringify(a),{level:9,to:"string"}),t.next=3,B.a.toDataURL(n).catch(console.error);case 3:r=t.sent,e.setState({TRQRCode:r,connectTRStep:1});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.setState({connectTR:t,connectTRStep:0})}},{key:"scanDoneHandler",value:function(e){var t=JSON.parse(Y.a.inflate(e,{to:"string"}));this.state.connectTR.setMasterConfig(t)}},{key:"capturedTicketHandler",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(a=JSON.parse(t)).id&&a.sIG){e.next=4;break}throw Error("Fehlende Angaben im Ticket-QR-Code. M\xf6glicherweise liegt eine F\xe4lschung vor.");case 4:return e.next=6,this.ticketReader.readTicketRemote(a.id);case 6:n=e.sent,this.setState({currentTicket:n,currentSecretIngredient:a.sIG}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),alert(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"obliterateTicketHandler",value:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ticketReader.obliterateTicketRemote(this.state.currentTicket.identifier,this.state.currentSecretIngredient);case 3:alert("Erfolgreich entwertet!"),this.closeTicketViewHandler(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"closeTicketViewHandler",value:function(){this.setState({currentTicket:null,currentSecretIngredient:null})}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{className:"Entrance",pad:"medium"},!this.state.connected&&r.a.createElement(g.a,null,r.a.createElement("p",null,"Wenn Sie dieses Ger\xe4t als Ticket Leser verwenden m\xf6chten, m\xfcssen Sie es erst mit dem Event-Manager verbinden."),r.a.createElement("p",null,"Bitte stellen Sie sicher, dass dieses Ger\xe4t mit dem selben lokalen Netzwerk, wie der Event-Manager verbunden ist."),r.a.createElement(E.a,{onClick:this.connectTicketReader,label:"Ticket Reader Aktivieren"}),this.state.connectTR&&r.a.createElement(Q,{title:"Als Ticket Reader verbinden",onAbort:function(){e.setState({connectTR:null})}},0===this.state.connectTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"scanner"},r.a.createElement(J,{onDone:this.scanDoneHandler,label:"Scanvorgang starten"})),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"Bitte den Code des Initiators scannen"))),1===this.state.connectTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"qrcode"},!this.state.TRQRCode&&r.a.createElement("div",{className:"loader"},"Loading..."),this.state.TRQRCode&&r.a.createElement("img",{src:this.state.TRQRCode,width:"100%",alt:"Ein QR-Code sollte hier angezeigt werden."})),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"Bitte nun mit dem Initiator Ger\xe4t scannen"))))),"connected"===this.state.connected&&r.a.createElement(g.a,null,r.a.createElement("p",null,"Sie sind verbunden"),null===this.state.currentTicket&&r.a.createElement(J,{onDone:this.capturedTicketHandler,label:"Scanvorgang starten"}),this.state.currentTicket&&r.a.createElement(g.a,null,r.a.createElement("h1",null,this.state.currentTicket.surname,", ",this.state.currentTicket.forename),r.a.createElement(v.a,{size:"2em",pad:"small"},this.translateTicketType(this.state.currentTicket.ticketType)),r.a.createElement(v.a,{size:"2em",pad:"small"},this.state.currentTicket.isValid&&!this.state.currentTicket.isUsed?"OK":"Ung\xfcltiges Ticket!"),r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,{label:"Entwerte Ticket",onClick:this.obliterateTicketHandler}),r.a.createElement(E.a,{label:"Schlie\xdfen",onClick:this.closeTicketViewHandler})))),"disconnected"===this.state.connected&&r.a.createElement(g.a,null,r.a.createElement("p",null,"Die Verbindung wurde unterbrochen!"),r.a.createElement("p",null,"Bitte warten Sie einen Moment..."),r.a.createElement("p",{className:"loader"})),"failed"===this.state.connected&&r.a.createElement(g.a,null,r.a.createElement("p",null,"Die Verbindung wurde unterbrochen!"),r.a.createElement("p",null,"Bitte aktivieren Sie den Reader erneut."),r.a.createElement(E.a,{onClick:function(){e.setState({connected:null}),e.connectTicketReader()},label:"Ticket Reader Aktivieren"})))}}]),a}(r.a.Component),ee=a(99),te=a.n(ee),ae=function(){function e(){if(Object(l.a)(this,e),this._createDB=this._createDB.bind(this),this.saveTicketMirror=this.saveTicketMirror.bind(this),this.getTicketList=this.getTicketList.bind(this),!window.indexedDB)throw Error("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");this.waitingForIDBReadyQueue=[],this._initDB()}return Object(o.a)(e,[{key:"_initDB",value:function(){var e=this;console.debug("Initializing IDB Connection");var t=window.indexedDB.open("TicketMirror",1);t.addEventListener("upgradeneeded",this._createDB),t.addEventListener("success",(function(t){console.debug("IDB Connection established"),e.db=t.target.result,e.waitingForIDBReadyQueue.forEach((function(t){t(e.db)}))})),t.addEventListener("error",(function(e){console.error("Database error: "+e.target.errorCode)}))}},{key:"_createDB",value:function(e){this.db=e.target.result,this.db.createObjectStore("tickets",{keyPath:"identifier"})}},{key:"_getIDB",value:function(){var e=this;return new Promise((function(t){e.db?t(e.db):e.waitingForIDBReadyQueue.push(t)}))}},{key:"saveTicketMirror",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._getIDB();case 3:a=e.sent,n=a.transaction("tickets","readwrite").objectStore("tickets"),t.forEach((function(e){n.add(e)})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0),alert("Es ist ein Fehler bei der Indexed DB aufgetreten");case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getTicketList",value:function(){var e=this;return new Promise(function(){var t=Object(b.a)(f.a.mark((function t(a,n){var r,i,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._getIDB().catch(console.error);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",n());case 5:i=r.transaction("tickets","readonly").objectStore("tickets"),(s=i.getAll()).onerror=n,s.onsuccess=function(e){var t=e.target.result;return a(t)};case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getTicket",value:function(e){var t=this;return new Promise(function(){var a=Object(b.a)(f.a.mark((function a(n,r){var i,s,c;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._getIDB().catch(console.error);case 2:if(i=a.sent){a.next=5;break}return a.abrupt("return",r());case 5:s=i.transaction("tickets","readonly").objectStore("tickets"),(c=s.get(e)).onerror=r,c.onsuccess=function(e){var t=e.target.result;return t?n(t):r("Ticket does not exist.")};case 9:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"obliterateTicket",value:function(e,t){var a=this;return new Promise(function(){var n=Object(b.a)(f.a.mark((function n(r,i){var s,c,l;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a._getIDB().catch(console.error);case 2:if(s=n.sent){n.next=5;break}return n.abrupt("return",i());case 5:c=s.transaction("tickets","readwrite").objectStore("tickets"),(l=c.get(e)).onerror=i,l.onsuccess=function(a){var n=a.target.result;if(!n)return i("Das Ticket existiert nicht.");var s=t+n.forename+n.surname+n.ticketType;if(te.a.utils.sha3(s)!==e)return i("Die Identit\xe4t des Tickets konnte nicht verifiziert werden.");if(!n.isValid)return i("Das Ticket ist nicht g\xfcltig.");if(n.isUsed)return i("Das Ticket wurde breits entwertet.");n.isUsed=!0;var l=c.put(n);l.onerror=i,l.onsuccess=r};case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}}]),e}(),ne=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;if(Object(l.a)(this,a),(n=t.call(this,e)).state={tickets:[]},n.handleDumpMirror=n.handleDumpMirror.bind(Object(u.a)(n)),n.showTickets=n.showTickets.bind(Object(u.a)(n)),!n.props.localTicketMirror)throw new Error("Missing LocalTicketMirror");return n.showTickets(),n}return Object(o.a)(a,[{key:"handleDumpMirror",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.localTicketMirror,e.next=3,fetch(w.a.BACKEND_BASE_URI+"/api/v2/tickets/",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.context.token}}).catch(console.log);case 3:if((a=e.sent).ok){e.next=7;break}return this.setState({loading:!1}),e.abrupt("return",alert("Beim Laden der Tickets ist ein Fehler aufgetreten."));case 7:return e.next=9,a.json().catch(console.log);case 9:if(n=e.sent){e.next=12;break}return e.abrupt("return",alert("Beim Laden der Tickets ist ein Fehler aufgetreten."));case 12:t.saveTicketMirror(n),this.showTickets();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showTickets",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.localTicketMirror,e.next=3,t.getTicketList().catch(console.error);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:this.setState({tickets:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.tickets.map((function(e){return r.a.createElement("li",{key:e.identifier},e.isValid&&"Valid",!e.isValid&&"Not Valid"," -  ",e.isUsed&&"Used",!e.isUsed&&"Not Used"," - ",e.ticketType)}));return r.a.createElement(g.a,{className:"EntranceDashboard",pad:"medium"},r.a.createElement(E.a,{label:"Ticketdaten f\xfcr den Offline-Einlass herunterladen",onClick:this.handleDumpMirror}),r.a.createElement("ul",null,e))}}]),a}(r.a.Component);ne.contextType=m;var re=ne,ie=function(){function e(){Object(l.a)(this,e),this.iceCandidatesHandler=this.iceCandidatesHandler.bind(this),this.dataChannelOpenHandler=this.dataChannelOpenHandler.bind(this),this.generateOfferCode=this.generateOfferCode.bind(this),this.dataChannelClosedHandler=this.dataChannelClosedHandler.bind(this),this.connectionChangeHandler=this.connectionChangeHandler.bind(this),this.setTicketReaderConfig=this.setTicketReaderConfig.bind(this),this.messageHandler=this.messageHandler.bind(this),this.uuid=this.createUUID(),this.onConnectionChanged=function(e){},this.onReady=function(){},this.onOffer=function(e){},this.onGetTicket=function(e,t){},this.onObliterateTicket=function(e,t,a){},this.initConnection()}return Object(o.a)(e,[{key:"initConnection",value:function(){this.icecandidates=[],this.localPeerConnection=new RTCPeerConnection(null),this.localPeerConnection.addEventListener("icecandidate",this.iceCandidatesHandler),this.localPeerConnection.addEventListener("connectionstatechange",this.connectionChangeHandler),this.dataChannel=this.localPeerConnection.createDataChannel("sendDataChannel",null),this.dataChannel.addEventListener("message",this.messageHandler),this.dataChannel.addEventListener("open",this.dataChannelOpenHandler),this.dataChannel.addEventListener("close",this.dataChannelClosedHandler),this.createOffer()}},{key:"iceCandidatesHandler",value:function(e){this.icecandidates.push(e.candidate),this.offer&&!this.qrcode&&setTimeout(this.generateOfferCode,200)}},{key:"connectionChangeHandler",value:function(e){console.debug(e);var t=e.target.connectionState;this.onConnectionChanged(t)}},{key:"dataChannelOpenHandler",value:function(e){console.debug(e),this.onReady(),this.dataChannel.send("Hallo Client!")}},{key:"dataChannelClosedHandler",value:function(e){console.debug("Data Channel Closed",e)}},{key:"messageHandler",value:function(e){var t,a=this;console.debug("Message received:",e.data);try{t=JSON.parse(e.data)}catch(n){return console.error(n),void console.debug("Message was:",e.data)}switch(t.context){case"ticketMirror":"getTicket"===t.method?this.onGetTicket(t.params[0],(function(e,n){var r={reqId:t.reqId,result:e,error:n};try{a.dataChannel.send(JSON.stringify(r))}catch(i){console.error(i)}})):"obliterateTicket"===t.method&&this.onObliterateTicket(t.params[0],t.params[1],(function(e,n){var r={reqId:t.reqId,result:e,error:n};try{a.dataChannel.send(JSON.stringify(r))}catch(i){console.error(i)}}))}}},{key:"createUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:0&a).toString(16)}))}},{key:"createOffer",value:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.createOffer().catch(console.error);case 2:return this.offer=e.sent,e.next=5,this.localPeerConnection.setLocalDescription(this.offer).catch(console.error);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateOfferCode",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={offer:this.offer,candidates:this.icecandidates},this.onOffer(t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setTicketReaderConfig",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var a=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(t.answer)).catch(this.handleError);case 2:t.candidates.forEach((function(e){a.localPeerConnection.addIceCandidate(e).catch(a.handleError)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),se=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.connectRemoteTicketReader=n.connectRemoteTicketReader.bind(Object(u.a)(n)),n.scanDoneHandler=n.scanDoneHandler.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"scanDoneHandler",value:function(e){var t=JSON.parse(Y.a.inflate(e,{to:"string"}));this.state.connectRTR.setTicketReaderConfig(t)}},{key:"connectRemoteTicketReader",value:function(){var e=this,t=new ie;t.onReady=function(){e.setState({connectRTR:null}),e.props.onRTR(t)},t.onOffer=function(){var t=Object(b.a)(f.a.mark((function t(a){var n,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Y.a.deflate(JSON.stringify(a),{level:9,to:"string"}),t.next=3,B.a.toDataURL(n).catch(console.error);case 3:r=t.sent,e.setState({RTRQRCode:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.setState({connectRTR:t,addRTRStep:0})}},{key:"disconnectRemoteTicketReader",value:function(e){}},{key:"disconnectAll",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{className:"TicketReaderManager",pad:"medium"},r.a.createElement("p",null,"Derzeit sind ",this.props.RTRList.length," Ticket Leser verbunden."),r.a.createElement(E.a,{onClick:this.connectRemoteTicketReader,label:"Ticket Leser Hinzuf\xfcgen"}),this.state.connectRTR&&r.a.createElement(Q,{title:"Remote Ticket Reader Hinzuf\xfcgen",onAbort:function(){e.setState({connectRTR:null})}},0===this.state.addRTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-qrcode"},!this.state.RTRQRCode&&r.a.createElement("div",{className:"loader"},"Loading..."),this.state.RTRQRCode&&r.a.createElement("img",{src:this.state.RTRQRCode,width:"100%",alt:"Ein QR-Code sollte hier angezeigt werden."})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte mit dem Zielger\xe4t scannen")),r.a.createElement("div",{className:"ticket-reader-action"},r.a.createElement(E.a,{onClick:function(){e.setState({addRTRStep:1})},label:"Weiter"}))),1===this.state.addRTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-scanner"},r.a.createElement(J,{onDone:this.scanDoneHandler,label:"Scanvorgang starten"})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte nun den Code des Zielger\xe4ts scannen")))))}}]),a}(r.a.Component),ce=a(550),le=a(554),oe=a(248),ue=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.getConfigured=n.getConfigured.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"getConfigured",value:function(e){var t=this.props.mapTest.get(e);return t?t?r.a.createElement(v.a,{key:e},"Erledigt"):void 0:r.a.createElement(v.a,{key:e},"Nicht erledigt")}},{key:"render",value:function(){var e=[];return 0===this.props.initializeStep&&(e[0]=r.a.createElement(g.a,{pad:"medium",key:"start"},r.a.createElement(v.a,{textAlign:"center",weight:"bold",size:"xxlarge"},"Guten Tag und Herzlich Wilkommen zum Ticketsystem."),r.a.createElement(g.a,{pad:"medium"}),r.a.createElement(v.a,null,"Die n\xe4chsten Schritte dienen zur Initalisierung des Systems. Sie werden durch die notwendigen Vorbereitungsschritte gef\xfchrt."),r.a.createElement(v.a,{textAlign:"center"},"F\xfcr die Initalisierung sind folgende Schritte notwendig"))),6===this.props.initializeStep&&(e[0]=r.a.createElement(g.a,{pad:"medium",key:"end"},r.a.createElement(v.a,{textAlign:"center"},"Herzlich Gl\xfcckwunsch Sie haben das Ticketsystem erfolgreich konfiguriert! Mit Zur\xfcck gelangen Sie wieder zur ersten Ansicht und k\xf6nnen erneut durch die Konfiguration navigieren."))),e[1]=r.a.createElement(g.a,null,r.a.createElement(ce.a,{primaryKey:"initializeStep",secondaryKey:"doneSteps",data:[{initializeStep:r.a.createElement(v.a,{size:"large",weight:"bold",key:"header"},"Vorbereitsungsschritt"),doneSteps:r.a.createElement(v.a,{size:"large",weight:"bold",key:"headerZustand"},"Zustand")},{initializeStep:r.a.createElement(v.a,{weight:"normal",key:"StatusDB"}," Initalisieren der Datenbank"),doneSteps:this.getConfigured("DB")},{initializeStep:r.a.createElement(v.a,{weight:"normal",key:"StatusAdminAccount"},"Hinzuf\xfcgen eines Administratorbenutzers"),doneSteps:this.getConfigured("AA")},{initializeStep:r.a.createElement(v.a,{weight:"normal",key:"StatusMS"},"Initialisieren des Mailservers"),doneSteps:this.getConfigured("MS")},{initializeStep:r.a.createElement(v.a,{weight:"normal",key:"StatusAdminWallet"},"Einrichten des Master-Wallets"),doneSteps:this.getConfigured("AW")},{initializeStep:r.a.createElement(v.a,{weight:"normal",key:"StatusListe"},"Einlesen der Absolventen-Liste und Erstellung der One Time Passw\xf6rter"),doneSteps:this.getConfigured("AL")}]})),e}}]),a}(r.a.Component),he=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={httpProvider:""},n.configureTheAdminWallet=n.configureTheAdminWallet.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"configureTheAdminWallet",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/setup/generateWallet",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({http_provider:this.state.httpProvider})}).catch(console.log);case 2:if((t=e.sent).ok){e.next=17;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,e.t0=t.status,e.next=400===e.t0?10:410===e.t0?12:500===e.t0?14:16;break;case 10:case 12:case 14:return alert(a.message),e.abrupt("break",17);case 16:alert(a.message);case 17:t.ok&&(n=t.json().catch(console.log),this.props.setWalletAddress(n.wallet_address),this.props.changeValueOfmapTest("AW"),this.props.changeStep());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{size:"large",weight:"bold"},"Hinzuf\xfcgen des Wallets f\xfcr den Master-User:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(S.a,{placeholder:"HTTP-Provider DNS:Port",value:this.state.httpProvider,onChange:function(t){e.setState({httpProvider:t.target.value})}})),r.a.createElement(E.a,{onClick:this.configureTheAdminWallet,label:"Hinzuf\xfcgen"}))}}]),a}(r.a.Component),de=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={walletBalance:"",neededBalance:""},a.deploySmartContract=a.deploySmartContract.bind(Object(u.a)(a)),a.getBalanceFromWallet=a.getBalanceFromWallet.bind(Object(u.a)(a)),a.getPriceOfContract=a.getPriceOfContract.bind(Object(u.a)(a)),a}return Object(o.a)(n,[{key:"getPriceOfContract",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/api/v2/shopConfig",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.context.token}}).catch(console.log);case 2:if((t=e.sent).ok){e.next=8;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,alert(a.message);case 8:return e.next=10,t.json().catch(console.log);case 10:if(n=e.sent){e.next=13;break}return e.abrupt("return");case 13:console.log(n);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBalanceFromWallet",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(99),new t(new t.providers.HttpProvider(this.props.httpProvider)).eth.getBalance("0x6c1afA1A56d92EeFd99926636b1a1c284B0CE298",(function(e,t){if(e&&console.log("Fehler beim Abruf der Balance des Wallets"),t||(console.log("Fehler beim Abruf der Balance des Wallets"),alert(t.message)),console.log(t),t){var a=t;console.log(a),n.setState({walletBalance:a})}}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deploySmartContract",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/setup/deployContract",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"}}).catch(console.log);case 2:if((t=e.sent).ok){e.next=17;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,e.t0=t.status,e.next=400===e.t0?10:410===e.t0?12:500===e.t0?14:16;break;case 10:case 12:case 14:return alert(a.message),e.abrupt("break",17);case 16:alert(a.message);case 17:t.ok&&(this.props.changeValueOfmapTest("DC"),this.props.changeStep());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{size:"large",weight:"bold"},"Smart Contract auf der Blockchain ver\xf6ffentlichen:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(S.a,{placeholder:"HTTP-Provider DNS:Port",value:this.state.httpProvider,onChange:function(t){e.setState({httpProvider:t.target.value})}}),r.a.createElement(E.a,{label:"TEST",onClick:this.getPriceOfContract})),r.a.createElement(E.a,{onClick:this.configureTheAdminWallet,label:"Hinzuf\xfcgen"}))}}]),n}(r.a.Component),me=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={email:"",password:""},n.configureTheAdminAcc=n.configureTheAdminAcc.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"configureTheAdminAcc",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/setup/adminUser",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password})}).catch(console.log);case 2:if((t=e.sent).ok){e.next=17;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,e.t0=t.status,e.next=400===e.t0?10:410===e.t0?12:500===e.t0?14:16;break;case 10:case 12:case 14:return alert(a.message),e.abrupt("break",17);case 16:alert(a.message);case 17:t.ok&&(this.props.changeValueOfmapTest("AA"),this.props.changeStep());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{size:"large",weight:"bold"},"Hinzuf\xfcgen des Administratorbenutzers:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"E-Mail-Adresse"),r.a.createElement(S.a,{placeholder:"E-Mail",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"Passwort:"),r.a.createElement(S.a,{placeholder:"Passwort",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),r.a.createElement(E.a,{onClick:this.configureTheAdminAcc,label:"Hinzuf\xfcgen"}))}}]),a}(r.a.Component),pe=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={host:"",user:"",password:"",db:"",port:""},n.configureTheDatabase=n.configureTheDatabase.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"configureTheDatabase",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/setup/database",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:this.state.host,user:this.state.user,password:this.state.password,database:this.state.db,port:this.state.port})}).catch(console.log);case 2:if((t=e.sent).ok){e.next=17;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,e.t0=t.status,e.next=400===e.t0?10:410===e.t0?12:500===e.t0?14:16;break;case 10:case 12:case 14:return alert(a.message),e.abrupt("break",17);case 16:alert(a.message);case 17:t.ok&&(this.props.changeValueOfmapTest("DB"),this.props.changeStep());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{size:"large",weight:"bold"},"Konfigurieren der Datenbank:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"Datenbank-Host:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Datenbank-Host eingeben",value:this.state.host,onChange:function(t){e.setState({host:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"Port:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Port eingeben",value:this.state.port,onChange:function(t){e.setState({port:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Benutzer:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Benutzer eingeben",value:this.state.user,onChange:function(t){e.setState({user:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Passwort:"),r.a.createElement(S.a,{placeholder:"Hier bitte das Passwort eingeben",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"}," Datenbank:"),r.a.createElement(S.a,{placeholder:"Hier bitte die Datenbank eingeben",value:this.state.db,onChange:function(t){e.setState({db:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{onClick:this.configureTheDatabase,label:"Abschlie\xdfen"})))}}]),a}(r.a.Component),fe=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={host:"",port:null,conncetion:!0,user:"",password:"",standardMail:"",standardPrefix:""},n.configureTheMailserver=n.configureTheMailserver.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"configureTheMailserver",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/setup/mailserver",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:this.state.host,port:this.state.port,secure:this.state.conncetion,user:this.state.user,password:this.state.password,default_from:this.state.standardMail,default_subject_prefix:this.state.standardPrefix})}).catch(console.log);case 2:if((t=e.sent).ok){e.next=17;break}return e.next=6,t.json().catch(console.log);case 6:a=e.sent,e.t0=t.status,e.next=400===e.t0?10:410===e.t0?12:500===e.t0?14:16;break;case 10:case 12:case 14:return alert(a.message),e.abrupt("break",17);case 16:alert(a.message);case 17:t.ok&&(this.props.changeValueOfmapTest("MS"),this.props.changeStep());case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(v.a,{size:"large",weight:"bold"},"Konfigurieren des Mailservers:"),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Mailserver-Host:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Mailserver-Host eingeben",value:this.state.textInput,onChange:function(t){e.setState({host:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"}," Port:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Port eingeben",value:this.state.port,onChange:function(t){e.setState({port:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Sichere Verbindung:"),r.a.createElement(le.a,{options:["true","false"],value:this.state.conncetion,onChange:function(t){t.value;var a=t.option;e.setState({conncetion:a})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"}," Benutzer:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Benutzer eingeben",value:this.state.user,onChange:function(t){e.setState({user:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Passwort: "),r.a.createElement(S.a,{placeholder:"Hier bitte das Passwort eingeben",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Standard Mail:"),r.a.createElement(S.a,{placeholder:"Hier bitte die Standard Mail eingeben",value:this.state.standardMail,onChange:function(t){e.setState({standardMail:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(v.a,{weight:"bold"},"Standard Subject Prefix:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Standard Prefix eingeben",value:this.state.standardPrefix,onChange:function(t){e.setState({standardPrefix:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{onClick:this.configureTheMailserver,label:"Abschlie\xdfen"})))}}]),a}(r.a.Component),be=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleOnDrop=function(e){var t=[];console.log("---------------------------"),console.log(e),console.log("---------------------------"),e.forEach((function(e){console.log(e.data),t.push(e.data)})),n.setState({listeEingelesen:!0,initialeListe:t})},n.handleOnError=function(e,t,a,n){console.log(e)},n.handleOnRemoveFile=function(e){console.log("---------------------------"),console.log(e),console.log("---------------------------")},n.state={listeEingelesen:!1,finished:!1,initialeListe:[],dateiTyp:"CSV",path:""},n.useListAndSendMail=n.useListAndSendMail.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"useListAndSendMail",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer f1df51e1835233014368105514f07a70e9f2255b279e5535810d7fbf2d565cc1d692d8b06d53f6157423bb3c63b97e5a42adfbe6277e48dc028d8043683acca13b1b9f83773015ff5f3533e9ad08943bac2eb003f24fc3e6c910d2e83e69f39ec1d3e3ac98d4d2965312670810aab8ec152338654bcab32e7c82cbe83545b0b5f307feed1976239fbe2718c97abab76768e6dcdb3e243fcead76ef2bc2ca72045f748da22dee9881a3aefe0b18ce9dd6d34eb4032ed56e1cb4d8bf11d2ff0d663b65f3ee2b2da04af8bc3b0473c4046fdc53248905d3499955f635c6ed9bb7e2defb03b54414ac617e4f73c96e6639bf1b89111458f5d830387f0c51e2c5a5d6"}}).catch(console.log);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.json().catch(console.log);case 7:if(e.sent.message){e.next=10;break}return e.abrupt("return");case 10:this.setState({finished:!0}),this.props.changeValueOfmapTest("AL"),this.props.changeStep();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.initialeListe;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{size:"large",weight:"bold"},"Einlesen der Absolventen Liste")),!this.state.listeEingelesen&&!this.state.finished&&r.a.createElement(g.a,{className:"Eingaben"},r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,null,"Bitte eine Liste in der folgenden Darstellung einlesen:"),r.a.createElement("span",null,r.a.createElement(v.a,{weight:"bold"},"Header: "),r.a.createElement(v.a,null,"E-Mail; Name")),r.a.createElement("span",null,r.a.createElement(v.a,{weight:"bold"},"Datensatz 1: "),r.a.createElement(v.a,null,"Beispiel@web.de; Mustermann, Max"))),r.a.createElement(oe.a,{onDrop:this.handleOnDrop,onError:this.handleOnError,config:{delimiter:";",header:!0},addRemoveButton:!0,onRemoveFile:this.handleOnRemoveFile},r.a.createElement("span",null,"Drop CSV file here or click to upload."))),this.state.listeEingelesen&&!this.state.finished&&r.a.createElement(ce.a,{className:"langeListe",pad:"medium",primaryKey:"E-Mail",secondaryKey:"Name",data:e}),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{onClick:this.useListAndSendMail,label:"Abschlie\xdfen"})),this.state.listeEingelesen&&this.state.finished&&r.a.createElement(v.a,null,"Bitte den N\xe4chsten Schritt"))}}]),a}(r.a.Component),ge=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).changeStep=n.changeStep.bind(Object(u.a)(n)),n.changeValueOfmapTest=n.changeValueOfmapTest.bind(Object(u.a)(n)),n.setWalletAddress=n.setWalletAddress.bind(Object(u.a)(n)),n.state={initializeStep:0,mapTest:new Map([["AW",!1],["DB",!1],["MS",!1],["AL",!1],["AA",!1],["DC",!1]]),walletAddress:"",httpProvider:""},n}return Object(o.a)(a,[{key:"changeValueOfmapTest",value:function(e){this.setState(this.state.mapTest.set(e,!0))}},{key:"setWalletAddress",value:function(e){this.setState({walletAddress:e})}},{key:"setHttpProvider",value:function(e){this.setState({httpProvider:e})}},{key:"changeStep",value:function(){var e;this.state.initializeStep>5&&(e=0),this.state.initializeStep<6&&(e=1+this.state.initializeStep),this.setState({initializeStep:e})}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"SystemInitalisierung",direction:"column",gap:"medium",pad:"medium",align:"center"},0===this.state.initializeStep&&r.a.createElement(ue,{mapTest:this.state.mapTest,initializeStep:this.state.initializeStep}),1===this.state.initializeStep&&r.a.createElement(pe,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this),changeStep:this.changeStep.bind(this)}),2===this.state.initializeStep&&r.a.createElement(me,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this),changeStep:this.changeStep.bind(this)}),3===this.state.initializeStep&&r.a.createElement(fe,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this),changeStep:this.changeStep.bind(this)}),4===this.state.initializeStep&&r.a.createElement(he,{setWalletAddress:this.setWalletAddress.bind(this),changeValueOfmapTest:this.changeValueOfmapTest.bind(this),changeStep:this.changeStep.bind(this)}),4===this.state.initializeStep&&r.a.createElement(de,{httpProvider:this.state.httpProvider,walletAddress:this.state.walletAddress,changeValueOfmapTest:this.changeValueOfmapTest.bind(this),changeStep:this.changeStep.bind(this)}),5===this.state.initializeStep&&r.a.createElement(be,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this),changeStep:this.changeStep.bind(this)}),6===this.state.initializeStep&&r.a.createElement(ue,{mapTest:this.state.mapTest,initializeStep:this.state.initializeStep,changeStep:this.changeStep.bind(this)}),0===this.state.initializeStep&&r.a.createElement(E.a,{onClick:this.changeStep,label:"Konfiguration Beginnen"}),0!=this.state.initializeStep&&this.state.initializeStep<6&&r.a.createElement(E.a,{onClick:this.changeStep,label:"Schritt \xdcberspringen"}),6===this.state.initializeStep&&r.a.createElement(g.a,{pad:"medium"}," ",r.a.createElement(E.a,{label:"Zur\xfcck",onClick:this.changeStep})))}}]),a}(r.a.Component),ke=a(251),ve=a(552),Ee=(a(98),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={Absolvententickets:"",Begleitertickets:"",Parktickets:""},n.changeValues=n.changeValues.bind(Object(u.a)(n)),n.setValuesAndChangeStep=n.setValuesAndChangeStep.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"changeValues",value:function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setValuesAndChangeStep",value:function(){this.props.setMaxTicketMenge(this.state.Absolvententickets,this.state.Begleitertickets,this.state.Parktickets),this.props.changeInitializeStep(0)}},{key:"render",value:function(){var e=this;return[][0]=r.a.createElement(g.a,{className:"outerBoxOverview",direction:"column",align:"center"},r.a.createElement(v.a,{weight:"bold",size:"xxlarge"},"Ticketkonfiguration"),r.a.createElement(g.a,{pad:"medium"}),"Hier k\xf6nnen die maximalen Tickets, die ein Benutzer (Absolvent) erwerben kann, konfiguriert werden.",r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"Absolvententickets:"),r.a.createElement(S.a,{placeholder:"Absolvententickets",value:this.state.Absolvententickets,onChange:function(t){e.setState({Absolvententickets:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"Begleitertickets:"),r.a.createElement(S.a,{placeholder:"Begleitertickets",value:this.state.Begleitertickets,onChange:function(t){e.setState({Begleitertickets:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(v.a,{weight:"bold"},"Parktickets:"),r.a.createElement(S.a,{placeholder:"Parktickets",value:this.state.Parktickets,onChange:function(t){e.setState({Parktickets:t.target.value})}})),r.a.createElement(E.a,{label:"Best\xe4tigen",onClick:this.setValuesAndChangeStep}))}}]),a}(r.a.Component)),Se=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.changeStep=n.changeStep.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"changeStep",value:function(){this.props.changeInitializeStep(0)}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"outerBoxOverview",direction:"column",align:"center"},r.a.createElement(E.a,{label:"Best\xe4tigen",onClick:this.changeStep}))}}]),a}(r.a.Component),Te=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.changeStep=n.changeStep.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"changeStep",value:function(){this.props.changeInitializeStep(0)}},{key:"render",value:function(){return[][0]=r.a.createElement("box",{className:"outerBoxOverview",direction:"column",align:"center"},r.a.createElement(v.a,{weight:"bold",size:"xlarge"},"Bestellungs\xfcbersicht"),r.a.createElement(g.a,{pad:"medium"}),r.a.createElement(v.a,null,"Hier k\xf6nnen die Bestellungen eingesehen und freigegeben werden."),r.a.createElement(g.a,{pad:"medium"}),r.a.createElement(E.a,{label:"Zur\xfcck zur \xdcbersicht",onClick:this.changeStep}))}}]),a}(r.a.Component),we=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.callShopManagamentConfTickets=n.callShopManagamentConfTickets.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"callShopManagamentConfTickets",value:function(){this.props.changeInitializeStep(1)}},{key:"render",value:function(){var e=[];return e[1]=r.a.createElement(g.a,{name:"purchaseableTicketsPerPerson",className:"quickViewOuterBox"},r.a.createElement(v.a,null,"Anzahl der Tickets die ein Absolvent erwerben kann:"),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(ve.a,{className:"quickViewDatatables",columns:[{property:"Tickettype",header:r.a.createElement(v.a,{weight:"bold"},"Tickettyp"),primary:!0},{property:"Anzahl",header:r.a.createElement(v.a,{weight:"bold"},"Freigebene Anzahl")}],data:this.props.maxTicketmenge}),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(g.a,{className:"ButtonBox"},r.a.createElement(E.a,{className:"buttonInDash",label:"Ticketanzahl konfigurieren",onClick:this.callShopManagamentConfTickets}))),e}}]),a}(r.a.Component),Oe=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"switchBooleanToString",value:function(){var e,t=[],a=Object(L.a)(this.props.konfigurierteBezahloptionen);try{for(a.s();!(e=a.n()).done;){var n=Object(ke.a)(e.value,2),r=n[0],i=n[1],s="";i||(s="Nicht Konfiguriert"),i&&(s="Konfiguriert"),t.push({bezahlOption:r,konfiguriert:s})}}catch(c){a.e(c)}finally{a.f()}return t}},{key:"render",value:function(){var e=[];return e[0]=r.a.createElement(g.a,{name:"paymentOptions",className:"quickViewOuterBox"},r.a.createElement(v.a,null,"\xdcbersicht der Konfigurierten Bezahloptionen:"),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(ve.a,{className:"quickViewDatatables",columns:[{property:"bezahlOption",header:r.a.createElement(v.a,{weight:"bold"},"Bezahloption"),primary:!0},{property:"konfiguriert",header:r.a.createElement(v.a,{weight:"bold"},"Ist Konfiguriert")}],data:this.switchBooleanToString()}),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(g.a,{className:"ButtonBox"},r.a.createElement(E.a,{className:"buttonInDash",label:"Bezahloptionen konfigurieren"}))),e}}]),a}(r.a.Component),ye=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.callShopManagementViewBookings=n.callShopManagementViewBookings.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"callShopManagementViewBookings",value:function(){this.props.changeInitializeStep(3)}},{key:"render",value:function(){var e=[];return e[1]=r.a.createElement(g.a,{name:"statusBookings",className:"quickViewOuterBox"},r.a.createElement(v.a,null,"Anzahl und Status der Buchungen im System:"),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(ve.a,{className:"quickViewDatatables",columns:[{property:"status",header:r.a.createElement(v.a,{weight:"bold"},"Status"),primary:!0},{property:"Anzahl",header:r.a.createElement(v.a,{weight:"bold"},"Anzahl")}],data:this.props.statusBookings}),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(g.a,{className:"ButtonBox"},r.a.createElement(E.a,{className:"buttonInDash",label:"Buchungen ",onClick:this.callShopManagementViewBookings}))),e}}]),a}(r.a.Component),Ce=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.callShopManagementSalesStatistics=n.callShopManagementSalesStatistics.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"callShopManagementSalesStatistics",value:function(){this.props.changeInitializeStep(4)}},{key:"render",value:function(){var e=[];return e[1]=r.a.createElement(g.a,{name:"statusSales",className:"quickViewOuterBox"},r.a.createElement(v.a,null,"Anzahl und Status der Ticketbuchungen im System:"),r.a.createElement(g.a,{pad:"small"}),r.a.createElement(ve.a,{className:"quickViewDatatables",columns:[{property:"status",header:r.a.createElement(v.a,{weight:"bold"},"Status"),primary:!0},{property:"Anzahl",header:r.a.createElement(v.a,{weight:"bold"},"Anzahl")}],data:this.props.statusSales}),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(g.a,{"Class-Name":"ButtonBox"},r.a.createElement(E.a,{className:"buttonInDash",label:"Tickets verwalten",onClick:this.callShopManagementSalesStatistics}))),e}}]),a}(r.a.Component),xe=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"callShopManagementManageSales",value:function(){this.props.changeInitializeStep(5)}},{key:"render",value:function(){var e;this.props.salesStatus&&(e={Beschreibung:"Ticketverkauf",Status:"Aktiv"}),this.props.salesStatus||(e={Beschreibung:"Ticketverkauf",Status:"Deaktiviert"});var t=[];return t[1]=r.a.createElement(g.a,{name:"boxManageSales",className:"quickViewOuterBox"},r.a.createElement(v.a,null,"Anzeige f\xfcr den Status und das aktivieren und deaktivieren des Ticketverkaufs"),r.a.createElement(g.a,{pad:"small"}),r.a.createElement(ve.a,{className:"quickViewDatatables",columns:[{property:"Beschreibung",header:r.a.createElement(v.a,{weight:"bold"},"Status"),primary:!0},{property:"Status",header:r.a.createElement(v.a,{weight:"bold"},"Anzahl")}],data:e}),r.a.createElement(g.a,{className:"platzhalter"}),r.a.createElement(g.a,{"Class-Name":"ButtonBox"},r.a.createElement(E.a,{className:"buttonInDash",label:"Status \xe4ndern",onClick:this.callShopManagementManageSales}))),t}}]),a}(r.a.Component),je=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={initializeStep:0,openBookings:0,salesStatus:!0,maxTicketmenge:[{Tickettype:"Absolvententickets",Anzahl:1},{Tickettype:"Begleitertickets",Anzahl:2},{Tickettype:"Parkttickets",Anzahl:1}],konfigurierteBezahloptionen:new Map([["Paypal",!1],["\xdcberweisung",!1]]),statusBookings:[{status:"Gebucht",Anzahl:0},{status:"Offen",Anzahl:0},{status:"Stornieren",Anzahl:0}],statusSales:[{status:"Verf\xfcgbar",Anzahl:0},{status:"Verkauft",Anzahl:0},{status:"Beantragt",Anzahl:0},{status:"Stornieren",Anzahl:0}]},n.changeInitializeStep=n.changeInitializeStep.bind(Object(u.a)(n)),n.setMaxTicketMenge=n.setMaxTicketMenge.bind(Object(u.a)(n)),n.getBookings=n.getBookings.bind(Object(u.a)(n)),n.componentDidMount=n.componentDidMount.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"changeInitializeStep",value:function(e){this.setState({initializeStep:e})}},{key:"componentDidMount",value:function(){this.getBookings()}},{key:"getBookings",value:function(){var e=Object(b.a)(f.a.mark((function e(){var t,a,n,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w.a.BACKEND_BASE_URI+"/api/v2/bookings/",{method:"GET",mose:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.context.token}}).catch(console.log);case 2:if((t=e.sent).ok){e.next=15;break}e.t0=t.status,e.next=500===e.t0?7:501===e.t0?9:11;break;case 7:return alert("Die Anmeldung ist aufgrund eines Server-Fehlers fehlgeschlagen. Bitte versuchen Sie es sp\xe4ter erneut."),e.abrupt("break",12);case 9:return alert("Der Server kann die gew\xfcnschte Anfrage nicht ausf\xfchren."),e.abrupt("break",12);case 11:alert(t.message);case 12:return e.abrupt("return");case 15:return e.next=17,t.json().catch(console.log);case 17:if(a=e.sent){for(console.log(a.length),n=0,r=0,i=0;i<a.length;i++)null!==a[i].paidAt&&(n+=1),null===a[i].paidAt&&(r+=1);this.setBookings(n,r)}case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setBookings",value:function(e,t){var a=[{status:"Gebucht",Anzahl:e},{status:"Offen",Anzahl:t},{status:"Stornieren",Anzahl:0}];this.setState({statusBookings:a})}},{key:"setMaxTicketMenge",value:function(e,t,a){var n=[{Tickettype:"Absolvententickets",Anzahl:e},{Tickettype:"Begleitertickets",Anzahl:t},{Tickettype:"Parkttickets",Anzahl:a}];this.setState({maxTicketmenge:n})}},{key:"setSalesStatus",value:function(e){this.setState({salesStatus:e})}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"outerBoxOverview",direction:"column",align:"center"},0===this.state.initializeStep&&r.a.createElement(g.a,null,r.a.createElement(g.a,null,r.a.createElement(v.a,{size:"xxlarge",weight:"bold"},"Hallo das ist die \xdcbersicht der Shop Verwaltung"),r.a.createElement(g.a,{pad:"medium"}),r.a.createElement(E.a,{label:"QuickView aktualisieren",onClick:this.componentDidMount})),r.a.createElement(g.a,{ClassName:"twoGroupedBoards",direction:"row",wrap:"true"},r.a.createElement(we,{maxTicketmenge:this.state.maxTicketmenge,changeInitializeStep:this.changeInitializeStep}),r.a.createElement(Oe,{konfigurierteBezahloptionen:this.state.konfigurierteBezahloptionen})),r.a.createElement(g.a,{ClassName:"twoGroupedBoards",direction:"row",wrap:"true"},r.a.createElement(ye,{statusBookings:this.state.statusBookings,changeInitializeStep:this.changeInitializeStep}),r.a.createElement(Ce,{statusSales:this.state.statusSales,changeInitializeStep:this.changeInitializeStep})),r.a.createElement(g.a,{ClassName:"twoGroupedBoards",direction:"row",wrap:"true"},r.a.createElement(xe,{salesStatus:this.state.salesStatus,setSalesStatus:this.setSalesStatus,changeInitializeStep:this.changeInitializeStep}))),1===this.state.initializeStep&&r.a.createElement(Ee,{maxTicketmenge:this.state.maxTicketmenge,setMaxTicketMenge:this.setMaxTicketMenge,changeInitializeStep:this.changeInitializeStep}),3===this.state.initializeStep&&r.a.createElement(Te,{changeInitializeStep:this.changeInitializeStep}),4===this.state.initializeStep&&r.a.createElement(Se,{changeInitializeStep:this.changeInitializeStep}))}}]),a}(r.a.Component);je.contextType=m;var Ae=je,Be=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).rTRHandler=n.rTRHandler.bind(Object(u.a)(n)),n.localTicketMirror=new ae,n.state={RTRList:[]},n}return Object(o.a)(a,[{key:"rTRHandler",value:function(e){var t=this,a=this.state.RTRList;a.push(e),this.setState({RTRList:a}),e.onConnectionChanged=function(a){switch(console.log(a),a){case"connected":case"disconnected":break;case"failed":console.debug("Attempting to remove closed remote ticket reader");var n=t.state.RTRList,r=n.indexOf(e);n.splice(r,1),t.setState({RTRList:n})}},e.onGetTicket=function(e,a){t.localTicketMirror.getTicket(e).then((function(e){a(e)})).catch((function(e){a(null,e)}))},e.onObliterateTicket=function(e,a,n){t.localTicketMirror.obliterateTicket(e,a).then((function(e){n(e)})).catch((function(e){n(null,e)}))}}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"EventManagement"},r.a.createElement(k.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(c.b,{to:"/eventmgmt"},"Home"),r.a.createElement(m.Consumer,null,(function(e){return r.a.createElement(C.a,{label:"Account",items:[{label:"Logout",onClick:e.logout}]})}))),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(c.b,{to:"/eventmgmt/rtrm"},"Manage Remote Ticket Readers")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/eventmgmt/entrancedb"},"Show Entrance Dashboard")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/eventmgmt/ticketshop"},"Manage Ticketshop")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/eventmgmt/SystemInitalisierung"},"System Initalisieren")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/eventmgmt/ShopManagement"},"Shop Management"))),r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/eventmgmt/rtrm"},r.a.createElement(se,{RTRList:this.state.RTRList,onRTR:this.rTRHandler})),r.a.createElement(x.a,{path:"/eventmgmt/entrancedb"},r.a.createElement(re,{localTicketMirror:this.localTicketMirror})),r.a.createElement(x.a,{path:"/eventmgmt/ShopManagement"},r.a.createElement(Ae,null)),r.a.createElement(x.a,{path:"/eventmgmt/SystemInitalisierung"},r.a.createElement(ge,null)),r.a.createElement(x.a,{path:"/eventmgmt/ticketshop"},r.a.createElement(g.a,{pad:"medium"},"Hier m\xfcsste dann sowas wie ein Ticketshop Management Dashboard hin..."))))}}]),a}(r.a.Component),Re=a(555),ze=a(551),Ne=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userContext:{}},n.login=n.login.bind(Object(u.a)(n)),n.logout=n.logout.bind(Object(u.a)(n)),n.init=n.init.bind(Object(u.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:function(){var e=JSON.parse(localStorage.getItem("userContext"));this.setState({userContext:e||{}},this.login)}},{key:"logout",value:function(){localStorage.clear(),this.setState({userContext:{}}),window.location.assign("#/")}},{key:"login",value:function(){this.state.userContext.user?0===this.state.userContext.user.role?window.location.assign("#/eventmgmt/"):1===this.state.userContext.user.role&&window.location.assign("#/guest/"):window.location.assign("#/Accountmanagement/")}},{key:"render",value:function(){return r.a.createElement(m.Provider,{value:Object.assign(this.state.userContext,{logout:this.logout,login:this.login,reloadLocalStorage:this.init})},r.a.createElement(Re.a,{theme:ze.a},r.a.createElement(x.c,null,r.a.createElement(x.a,{exact:!0,path:"/"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(c.b,{to:"/guest"},"Ticketshop")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/entrance"},"Einlass-Management")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/eventmgmt"},"Event-Management")),r.a.createElement("li",null,r.a.createElement(c.b,{to:"/Accountmanagement"},"Anmelden"))))),r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/guest"},r.a.createElement(F,{eigenschaft1:"test"})),r.a.createElement(x.a,{path:"/entrance"},r.a.createElement($,null)),r.a.createElement(x.a,{path:"/eventmgmt"},r.a.createElement(Be,null)),r.a.createElement(x.a,{path:"/Accountmanagement"},r.a.createElement(y,null)))))}}]),a}(r.a.Component),De=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function He(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(r.a.createElement(c.a,null,r.a.createElement(Ne,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/bnt-frontend",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/bnt-frontend","/service-worker.js");De?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):He(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):He(t,e)}))}}()},98:function(e,t,a){}},[[257,1,2]]]);
//# sourceMappingURL=main.f34ffaf8.chunk.js.map