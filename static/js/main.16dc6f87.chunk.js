(this["webpackJsonpexample-client"]=this["webpackJsonpexample-client"]||[]).push([[0],{305:function(e,t,a){},344:function(e,t,a){e.exports=a(654)},349:function(e,t,a){},350:function(e,t,a){},36:function(e,t){e.exports={BACKEND_BASE_URI:"http://localhost:3000",INFURA_URI:"https://mainnet.infura.io/v3/efaece4f5f4443979063839c124c8171"}},361:function(e,t){},386:function(e,t){},388:function(e,t){},429:function(e,t){},431:function(e,t){},460:function(e,t){},576:function(e,t){},624:function(e,t,a){},645:function(e,t,a){},654:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(82),i=a.n(c),s=a(27),l=(a(349),a(11)),o=a(12),u=a(14),d=a(16),h=(a(350),r.a.createContext()),f=a(5),b=a.n(f),m=a(18),p=a(8),g=a(51),k=a(663),v=a(664),E=a(222),w=a(340),S=a(673),T=a(212),y=a.n(T),C=a(36),O=a.n(C),j=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).createUser=n.createUser.bind(Object(p.a)(n)),n.login=n.login.bind(Object(p.a)(n)),n.loginPassHandler=n.loginPassHandler.bind(Object(p.a)(n)),n.mailHandler=n.mailHandler.bind(Object(p.a)(n)),n.otpBest\u00e4tigen=n.otpBest\u00e4tigen.bind(Object(p.a)(n)),n.otpInputHandler=n.otpInputHandler.bind(Object(p.a)(n)),n.pass1Handler=n.pass1Handler.bind(Object(p.a)(n)),n.pass2Handler=n.pass2Handler.bind(Object(p.a)(n)),n.setState1=n.setState1.bind(Object(p.a)(n)),n.setState6=n.setState6.bind(Object(p.a)(n)),n.state={dhbw_mail:"",login_pass:"",new_pass:"",otp:"",pass1:"",pass2:"",step:0,access_token:""},n.tokenHandler=n.tokenHandler.bind(Object(p.a)(n)),n.verifyPasswort=n.verifyPasswort.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"init",value:function(){}},{key:"otpInputHandler",value:function(e){this.setState({otp:e.target.value})}},{key:"tokenHandler",value:function(e){this.setState({access_token:e.target.value})}},{key:"otpBest\xe4tigen",value:function(){console.log(this.state.otp),this.setState({step:2})}},{key:"pass1Handler",value:function(e){this.setState({pass1:e.target.value})}},{key:"pass2Handler",value:function(e){this.setState({pass2:e.target.value})}},{key:"mailHandler",value:function(e){this.setState({dhbw_mail:e.target.value})}},{key:"loginPassHandler",value:function(e){this.setState({login_pass:e.target.value})}},{key:"verifyPasswort",value:function(){this.state.pass1===this.state.pass2?(alert("Die angegebenen Passw\xf6rter stimmen \xfcberein!"),this.createUser(this.state.pass2)):(alert("Die angegebenen Passw\xf6rter stimmen nicht \xfcberein!"),this.setState({pass1:""}),this.setState({pass2:""}))}},{key:"displayError",value:function(){alert("Ups, das hat leider nicht funktioniert. Bitte versuchen Sie es erneut.")}},{key:"createUser",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"/auth/createUser/"+this.state.otp,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({newPassword:t})}).catch(console.log);case 2:if(a=e.sent){e.next=6;break}return alert("F\xfcr das eingegebene OTP konnte kein User angelegt werden."),e.abrupt("return");case 6:return e.next=8,a.json().catch(console.log);case 8:"Passwort nicht existent."!==(n=e.sent).message?(alert("Der Nutzer wurde erfolgreich angelegt."),this.setState({step:3})):(alert(n.message+" Ihr angegebenes OTP scheint nicht zu exisitieren. Bitte \xfcberpr\xfcfen Sie die Eingabe."),this.setState({step:1}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"/auth/login",{method:"POST",mose:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.state.dhbw_mail,password:this.state.login_pass})}).catch(console.log);case 2:return t=e.sent,e.next=5,t.json().catch(console.log);case 5:a=e.sent,console.log(a),"Falsche E-Mailadresse oder falsches Passwort."!==a.message?(this.setToken("access_token",a.token),this.setToken("user_id",a.user.id),this.setToken("user_email",a.user.email),this.setToken("user_role",a.user.role),this.setState({step:3})):alert(a.message);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setToken",value:function(e,t){localStorage.setItem(e,t)}},{key:"getToken",value:function(){return localStorage.getItem("access_token")}},{key:"setState1",value:function(){this.setState({step:1})}},{key:"setState6",value:function(){this.setState({step:6})}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{className:"AccountManagement",gap:"small"},r.a.createElement(k.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(s.b,{to:"../"},"Home"),r.a.createElement(h.Consumer,null,(function(e){return r.a.createElement(v.a,{label:"Account",items:[{label:"Logout",onClick:e.logout},{label:"Login",onClick:e.login}]})}))),r.a.createElement(g.a,{pad:"small"},0===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Klicke hier, um einen neuen Account anzulegen"),r.a.createElement(w.a,{label:"Neuen Account anlegen",gap:"small",onClick:this.setState1}),r.a.createElement(E.a,null,"Klicke hier, um dich mit einem bestehenden Account anzumelden"),r.a.createElement(w.a,{label:"Mit bestehendem Account anmelden",onClick:this.setState6})),1===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Bitte geben Sie das OneTime-Passwort ein, das wir an Ihre DHBW-Mailadresse versendet haben, und best\xe4tigen Sie die Eingabe"),r.a.createElement(S.a,{placeholder:"OTP eingeben",value:this.state.otp,onChange:this.otpInputHandler}),r.a.createElement(w.a,{label:"Eingabe best\xe4tigen",onClick:this.otpBest\u00e4tigen})),2===this.state.step&&r.a.createElement(g.a,{classname:"Passwortvergabe",direction:"column",gap:"small"},r.a.createElement("h1",null,"Passwortvergabe"),r.a.createElement(E.a,null,"Bitte vergeben Sie ein neues Passwort f\xfcr Ihren Account"),r.a.createElement(S.a,{placeholder:"Neues Passwort vergeben",value:this.state.pass1,onChange:this.pass1Handler}),r.a.createElement(S.a,{placeholder:"Neues Passwort best\xe4tigen",value:this.state.pass2,onChange:this.pass2Handler}),r.a.createElement(w.a,{label:"Passwort best\xe4tigen",onClick:this.verifyPasswort})),3===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Sie haben sich erfolgreich angemeldet."),r.a.createElement(w.a,{label:"Test123"})),4===this.state.step&&r.a.createElement(g.a,{gap:"small"}),5===this.state.step&&r.a.createElement(g.a,{gap:"small"}),6===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement("h1",null,"Anmeldung mit einem vorhandenen Account"),r.a.createElement(S.a,{placeholder:"DHBW-Mailadresse eingeben",value:this.state.dhbw_mail,onChange:this.mailHandler}),r.a.createElement(S.a,{placeholder:"Account-Passwort eingeben",value:this.state.login_pass,onChange:this.loginPassHandler}),r.a.createElement(w.a,{label:"Anmelden",onClick:this.login})),888===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement("h1",null,"Willkommen bei Virgil's Testgel\xe4nde"),r.a.createElement(S.a,{placeholder:"Test-Token eingeben",value:this.state.access_token,onChange:this.tokenHandler}),r.a.createElement(w.a,{label:"Eingabe best\xe4tigen",onClick:function(){e.setToken(e.state.access_token)}}))))}}]),a}(r.a.Component),x=a(83),R=a(332),A=a.n(R),H=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.sign=n.sign.bind(Object(p.a)(n)),n.connectWallet=n.connectWallet.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"displayError",value:function(){alert("Ups, das hat nicht geklappt")}},{key:"init",value:function(){this.setState({walletAvailable:!!window.ethereum}),window.ethereum||(this.walletLink=new A.a({appName:"DHBW Bachelors Night Ticketing 2020",appLogoUrl:"https://einfachtierisch.de/media/cache/article_teaser/cms/2015/09/Katze-lacht-in-die-Kamera-shutterstock-Foonia-76562038.jpg?595617",darkMode:!1}),window.ethereum=this.walletLink.makeWeb3Provider("https://mainnet.infura.io/v3/efaece4f5f4443979063839c124c8171",1)),this.setState({connected:!!window.ethereum.selectedAddress}),this.web3=new y.a(window.ethereum)}},{key:"connectWallet",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.enable().catch(this.displayError);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:console.log("User's address is ".concat(t[0])),this.web3.eth.defaultAccount=t[0],this.setState({connected:!0});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var a,n,r,c,i=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.ethereum){e.next=2;break}return e.abrupt("return",this.displayError());case 2:if(window.ethereum.selectedAddress){e.next=4;break}return e.abrupt("return",this.displayError());case 4:a=window.ethereum.selectedAddress,n=t,r=this.web3.utils.stringToHex(n),c=[r,a],"personal_sign",this.web3.currentProvider.send({method:"personal_sign",params:c,from:a},(function(e,t){if(e)return console.error(e);if(t.error)return console.error(t.error);console.log(t);var n=i.web3.eth.accounts.recover(r,t.result);n.toLowerCase()===a.toLowerCase()?alert("Successfully ecRecovered signer as "+a):alert("Failed to verify signer when comparing "+n+" to "+a)}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"linkToDownloadMetaMask",value:function(){window.open("https://wallet.coinbase.com/","_blank")}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{className:"WalletSetup",direction:"column",gap:"medium",pad:"medium"},r.a.createElement("h1",null,"Wallet Setup"),r.a.createElement(E.a,null,"Um Tickets zu erwerben ben\xf6tigen Sie ein sogenanntes Wallet. Dieses ist vergleichbar mit Ihrer Geldb\xf6rse zu der nur Sie Zugriff haben."),!this.state.walletAvailable&&!this.state.connected&&r.a.createElement(g.a,{gap:"medium"},r.a.createElement(E.a,null,"F\xfcr unser Ticket-System muss dieses Wallet Ethereum-f\xe4hig sein. Wir empfehlen Ihnen daher das Coinbase Wallet. Bitte installieren Sie sich das Coinbase Wallet \xfcber die offizielle Website. Kommen Sie nach Abschluss der Einrichtung wieder auf diese Seite zur\xfcck."),r.a.createElement(w.a,{label:"Coinbase f\xfcr's Smartphone installieren",onClick:this.linkToDownloadMetaMask})),!this.state.connected&&r.a.createElement(g.a,{gap:"medium"},r.a.createElement(E.a,null,"Als N\xe4chstes ben\xf6tigt unsere Plattform die Adresse Ihres Wallets. Bitte best\xe4tigen Sie daher die Verbindung mit Ihrem Wallet \xfcber folgende Schaltfl\xe4che. Sie geben dadurch ",r.a.createElement("b",null,"nicht")," Ihre Kontrolle \xfcber das Wallet ab!"),r.a.createElement(w.a,{label:"Mit dem Wallet verbinden",onClick:this.connectWallet})),r.a.createElement(E.a,null,"Hier folgt eine DEMO!!!"),r.a.createElement(S.a,{placeholder:"Nachricht zum signieren",value:this.state.signMessage,onChange:function(t){e.setState({signMessage:t.target.value})}}),r.a.createElement(w.a,{label:"Sign and Verify Message",onClick:function(){e.sign(e.state.signMessage)}}))}}]),a}(r.a.Component),D=(a(624),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(g.a,{className:"UserMainMenu",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(s.b,{className:"MenuLink",to:"/guest/tickets"},"Tickets Anzeigen"),r.a.createElement(s.b,{className:"MenuLink",to:"/guest/ticketbestellen"},"Tickets Bestellen"),r.a.createElement(s.b,{className:"MenuLink",to:"/guest/bestellungsuebersicht"},"Bestellungen Anzeigen"),r.a.createElement(s.b,{className:"MenuLink",to:"/guest/setup"},"Setup"))}}]),a}(r.a.Component)),B=(a(305),a(115)),I=a.n(B);function M(e){var t=Object(x.f)().identifier,a=e.tickets.find((function(e){return e.identifier===t}));return r.a.createElement(g.a,{className:"SingleTicket"},a.forename,a.surname,a.ticketType)}function N(e){return r.a.createElement(g.a,{className:"TicketListItem",direction:"row",gap:"small",pad:"small"},r.a.createElement(E.a,{className:"Name"},e.ticket.forename," ",e.ticket.surname),r.a.createElement(E.a,{className:"Type"},e.ticket.ticketType),r.a.createElement(w.a,{label:"Anzeigen",onClick:function(){window.location.assign("#/guest/tickets/"+e.ticket.identifier)}}))}var _=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={tickets:[],loading:!1},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.fetchTickets()}},{key:"fetchTickets",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),"0x3Da85f73bC1B1662FE247391dEcD2a52f139fd13",e.next=4,fetch(O.a.BACKEND_BASE_URI+"/api/v1/users/0x3Da85f73bC1B1662FE247391dEcD2a52f139fd13/tickets",{mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 43059960ead1db519cbbed4aa934462808262fa6204daefabcab4b0b38b667d61828556556e4b9e80b6a91e9990fc8704bbf399cdafd41b06ddc0c31a500accb94b96fa096bf8789c7c582f9e5df0ead8f23ef77a9b045ccbb78a60cd2401592e79b8c396cd4520297cfb0603011a7f373f9dbbc6a37527bd160b5e754850cbf8779a4c5049e816a9b9bee268e110baf53e901e80aa8df89d6a07b92cf33b581294bedc1b8da2c9a583845b13766f4c89abc9ac3466b69748a1ba0bf6a80a8c2b6aa6ec084c88c2cc4d212470089dbb9e4bce056c90e8a0ebaa5b9e563c80d20ac173b791769eac9d29c509810086f1700c7cec0071a03bb7aed67fec7215979"}}).catch(console.log);case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,t.json().catch(console.log);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:a.forEach((function(e){switch(e.ticketType){case"0":e.ticketType="Absolvent";break;case"1":e.ticketType="Begleitperson";break;case"2":e.ticketType="Parkticket"}})),this.setState({tickets:a,loading:!1});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateQRCodes",value:function(){var e=this,t=[];this.state.tickets.forEach((function(a,n,r){var c=a.identifier;I.a.toDataURL(c).then((function(c){a.qrcode=c,t.push(a),n===r.length-1&&e.setState({tickets:t})})).catch(console.log)}))}},{key:"setToken",value:function(e){localStorage.setItem("Tokenwert",e)}},{key:"getToken",value:function(){var e=localStorage.getItem("Tokenwert");console.log(e)}},{key:"render",value:function(){var e=this.state.tickets.map((function(e){return r.a.createElement(N,{key:e.identifier,ticket:e})}));return r.a.createElement(g.a,{className:"TicketOverview",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/guest/tickets/:identifier"},r.a.createElement(s.b,{to:"/guest/tickets/"},"Alle Tickets anzeigen"),r.a.createElement(M,{tickets:this.state.tickets})),r.a.createElement(x.a,{path:"/guest/tickets/"},r.a.createElement(g.a,null,r.a.createElement(g.a,null,r.a.createElement("h1",{className:"NumberOfTickets"},this.state.tickets.length)),r.a.createElement(g.a,{className:"TicketList"},this.state.loading&&r.a.createElement("p",{className:"loader"}),e)))))}}]),a}(r.a.Component),P=a(672),z=a(666),L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(l.a)(this,a),t.call(this,e)}return Object(o.a)(a,[{key:"render",value:function(){var e=[];this.props.tickets.forEach((function(t){e.push(r.a.createElement(g.a,{key:t.identifier,pad:"small"},r.a.createElement("span",null,"Ticket Identifier: ",t.identifier),r.a.createElement("span",null,"Nachname: ",t.surname),r.a.createElement("span",null,"Vorname: ",t.forename),r.a.createElement("span",null,"Ticket Typ: ",t.ticketType)))}));var t=this.props.booking,a="Buchungs-ID: "+t.id+" Buchungsdatum: "+t.createdAt+" Bezahldatum: "+t.paidAt;return r.a.createElement(P.a,{label:a},r.a.createElement(E.a,{margin:"small"},"Folgende Tickets wurden gebucht:"),e)}}]),a}(r.a.Component),U=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).loadListHandler=n.loadListHandler.bind(Object(p.a)(n)),n.loadTicketsHandler=n.loadTicketsHandler.bind(Object(p.a)(n)),n.state={buchungen:[],tickets:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.loadListHandler()}},{key:"loadListHandler",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,fetch(O.a.BACKEND_BASE_URI+"/api/v2/users/1/bookings",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"}}).catch(console.log);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:return console.log(t),e.next=9,t.json().catch(console.log);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:this.setState({buchungen:a,loading:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadTicketsHandler",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var a,n,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(a=this.state.buchungen[t].id,-1===this.state.tickets.findIndex((function(e){return e.bookingId===a}))){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,fetch(O.a.BACKEND_BASE_URI+"/api/v2/bookings/"+a+"/ticketsBooked",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"}}).catch(console.log);case 8:if(n=e.sent){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,n.json().catch(console.log);case 13:if(r=e.sent){e.next=16;break}return e.abrupt("return");case 16:c=(c=this.state.tickets).concat(r),this.setState({tickets:c});case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[];return this.state.buchungen.forEach((function(a){var n=e.state.tickets.filter((function(e){return e.bookingId===a.id}));t.push(r.a.createElement(L,{key:a.id,booking:a,tickets:n}))})),r.a.createElement(g.a,{className:"BookingOverview",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(g.a,null,this.state.loading&&r.a.createElement("p",{className:"loader"}),r.a.createElement(z.a,{onActive:function(t){e.loadTicketsHandler(t[0])}},t)))}}]),a}(r.a.Component),W=a(333),V=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onInputHandler=n.onInputHandler.bind(Object(p.a)(n)),n.state={forename:"",surname:""},n}return Object(o.a)(a,[{key:"onInputHandler",value:function(e){var t=this.state;t[e.target.name]=e.target.value,this.setState(t),this.props.onInput(this.state)}},{key:"render",value:function(){return r.a.createElement(g.a,null,r.a.createElement(S.a,{name:"forename",placeholder:"Vorname des Gastes",value:this.state.forename,onChange:this.onInputHandler}),r.a.createElement(S.a,{name:"surname",placeholder:"Nachname des Gastes",value:this.state.surname,onChange:this.onInputHandler}))}}]),a}(r.a.Component),F=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).increment=function(e){if("guest"===e&&n.state.guestcount<2){var t=n.state.persons.length,a=r.a.createElement(V,{onInput:function(e){var a=n.state.persons;a[t]=e,n.setState({persons:a})}}),c=n.state.persons;c[t]={},n.state.personInputFields.push(a),n.setState({persons:c,personInputFields:n.state.personInputFields,guestcount:n.state.guestcount+1})}else"park"===e&&n.state.parkcount<3&&n.setState({parkcount:n.state.parkcount+1})},n.decrement=function(e){"guest"===e&&n.state.guestcount>0?n.setState({guestcount:n.state.guestcount-1}):"park"===e&&n.state.parkcount>0&&n.setState({parkcount:n.state.parkcount-1})},n.WindowAbsolventTicket=n.WindowAbsolventTicket.bind(Object(p.a)(n)),n.WindowGuestTicket=n.WindowGuestTicket.bind(Object(p.a)(n)),n.WindowParkTicket=n.WindowParkTicket.bind(Object(p.a)(n)),n.ToOverview=n.ToOverview.bind(Object(p.a)(n)),n.ToOrder=n.ToOrder.bind(Object(p.a)(n)),n.ToPayment=n.ToPayment.bind(Object(p.a)(n)),n.createTickets=n.createTickets.bind(Object(p.a)(n)),n.createBooking=n.createBooking.bind(Object(p.a)(n)),n.onInputHandler=n.onInputHandler.bind(Object(p.a)(n)),n.state={guestcount:0,parkcount:0,step:0,persons:[],personInputFields:[],graduate:{forename:"",surname:""},bookingResult:null},n}return Object(o.a)(a,[{key:"onInputHandler",value:function(e,t){"forename"==t?this.setState({graduate:{forename:e.target.value,surname:this.state.graduate.surname}}):this.setState({graduate:{surname:e.target.value,forename:this.state.graduate.forename}})}},{key:"WindowAbsolventTicket",value:function(){this.setState({step:0})}},{key:"WindowGuestTicket",value:function(){this.setState({step:1})}},{key:"WindowParkTicket",value:function(){this.setState({step:2})}},{key:"ToOverview",value:function(){this.setState({step:3})}},{key:"ToPayment",value:function(){this.setState({step:4})}},{key:"ToOrder",value:function(){this.setState({step:5})}},{key:"createBooking",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"1",e.next=3,fetch(O.a.BACKEND_BASE_URI+"/api/v2/bookings",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"},body:JSON.stringify({userId:"1"})}).catch(console.log);case 3:if(t=e.sent){e.next=7;break}return this.setState({step:100}),e.abrupt("return");case 7:return e.next=9,t.json().catch(console.log);case 9:if(a=e.sent,console.log(a),this.setState({bookingResult:a}),a){e.next=15;break}return this.setState({step:100}),e.abrupt("return");case 15:return console.log(a),e.next=18,this.createTickets();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateIdentifier",value:function(){return 1e5*Math.random()}},{key:"createTickets",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a,n,r,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(this.state),t=this.state.bookingResult.id,a=Object(W.a)(this.state.persons),e.prev=3,a.s();case 5:if((n=a.n()).done){e.next=23;break}return r=n.value,console.log(r),e.next=10,fetch(O.a.BACKEND_BASE_URI+"/api/v2/ticketsBooked",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"},body:JSON.stringify({identifier:this.generateIdentifier(),bookingId:t,ticketType:1,forename:r.forename,surname:r.surname,isWheelchairUser:!1})}).catch(console.log);case 10:if(c=e.sent){e.next=14;break}return this.setState({step:100}),e.abrupt("return");case 14:return e.next=16,c.json().catch(console.log);case 16:if(i=e.sent){e.next=20;break}return this.setState({step:100}),e.abrupt("return");case 20:console.log(i);case 21:e.next=5;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(3),a.e(e.t0);case 28:return e.prev=28,a.f(),e.finish(28);case 31:return e.next=33,fetch(O.a.BACKEND_BASE_URI+"/api/v2/ticketsBooked",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer 91ba3c0f6ae8d56c4714260a8dbb7c6ce606797be4fb79eedfc73e4d6f212d255487b44e9c1b264deca11183605744c4c8c70d01b097872b41551c7a5dc8af3b7b7f755388835c67b8b094de2253e9ac95850e0575717ea5c3a9efa7239a0adaa70f6fcffec09f4b25ee4b6118fe0e9483f0d3faf8be0976a608460b0ad2156c0ddcc5f483db50404c2f6567b16a6087682d10c4ec22935be53f164a206d3f592baad81c301496b5ff5fca105e65a4121e1f0ae327d9eb5ae8f3f754fdbe7187f6a83e9e6fbe789268d8292521760e1b3f1dcb2a162b55a5b8b8089b21b996e1875f14b0b705a9cbcc806f4f3c4ac229cd3740175b0bf610bd514447430d2f15"},body:JSON.stringify({identifier:this.generateIdentifier(),bookingId:t,ticketType:0,forename:this.state.graduate.forename,surname:this.state.graduate.surname,isWheelchairUser:!1})}).catch(console.log);case 33:if(c=e.sent){e.next=37;break}return this.setState({step:100}),e.abrupt("return");case 37:return e.next=39,c.json().catch(console.log);case 39:if(i=e.sent){e.next=43;break}return this.setState({step:100}),e.abrupt("return");case 43:console.log(i),this.ToOrder();case 45:case"end":return e.stop()}}),e,this,[[3,25,28,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return console.log(this.state.persons),r.a.createElement(g.a,{className:"TicketBestellung",direction:"column",gap:"medium",pad:"medium"},0===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(S.a,{name:"forename",placeholder:"Vorname des Absolventen",value:this.state.graduate.forename,onChange:function(t){return e.onInputHandler(t,"forename")}}),r.a.createElement(S.a,{name:"surname",placeholder:"Nachname des Absolventen",value:this.state.graduate.surname,onChange:function(t){return e.onInputHandler(t,"surname")}}),"Klicke hier, um ein Absolvententicket zu kaufen.",r.a.createElement(w.a,{label:" Ein Absolventen Ticket kaufen",onClick:this.WindowGuestTicket,gap:"small"})),1===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Bitte geben sie an, wie viele Begleitpersonen Sie mitnehmen wollen."),r.a.createElement(w.a,{onClick:function(){return e.increment("guest")},className:"guestcount",label:"+"}),r.a.createElement(w.a,{onClick:function(){return e.decrement("guest")},className:"guestcount",label:"-"}),r.a.createElement("h2",null,this.state.guestcount),this.state.personInputFields,r.a.createElement(w.a,{onClick:this.WindowAbsolventTicket,label:"Zur\xfcck"}),r.a.createElement(w.a,{onClick:this.WindowParkTicket,label:"Weiter"})),2===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Bitte geben sie an, wie viele Parktickets Sie ben\xf6tigen."),r.a.createElement(w.a,{onClick:function(){return e.increment("park")},className:"parkcount",label:"+"}),r.a.createElement(w.a,{onClick:function(){return e.decrement("park")},className:"parkcount",label:"-"}),r.a.createElement("h2",null,"Anzahl der Parktickets: ",this.state.parkcount),r.a.createElement(w.a,{onClick:this.WindowGuestTicket,label:"Zur\xfcck"}),r.a.createElement(w.a,{onClick:this.ToOverview,label:"Weiter"})),3===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Sie haben folgende Tickets bestellt: ",r.a.createElement("br",null),"Absolventent: 1 ",r.a.createElement("br",null),"Begleitpersonen: ",this.state.guestcount," ",r.a.createElement("br",null),"Parkticket ",this.state.parkcount),r.a.createElement(w.a,{onClick:this.WindowParkTicket,label:"Zur\xfcck"}),r.a.createElement(w.a,{onClick:this.ToPayment,label:"Zahlungspflichtig bestellen"})),4===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Sie haben folgende Tickets Zahlungspflichtig bestellt.  ",r.a.createElement("br",null),"Bitte \xfcberweisen Sie folgenden Betrag auf das Konto: XXXXYYYYZZZZ.",r.a.createElement("br",null),"Geben Sie ihren Namen als Verwendungszweck an.",r.a.createElement("br",null),"Nach Rechnungseingang erhalten Sie Ihre Tickets an ihr Wallet gesendet.",r.a.createElement("br",null)),r.a.createElement(E.a,null,"Sie haben folgende Tickets bestellt: ",r.a.createElement("br",null),"Absolventent: 1 ",r.a.createElement("br",null),"Begleitpersonen: ",this.state.guestcount," ",r.a.createElement("br",null),"Parkticket ",this.state.parkcount),r.a.createElement(w.a,{label:"Buchung erstellen",onClick:this.createBooking})),5===this.state.step&&r.a.createElement(g.a,{gap:"small"},"Erfolgreich bestellt!"),100===this.state.step&&r.a.createElement(g.a,{gap:"small"},r.a.createElement(E.a,null,"Ein Fehler im Bestellvorgang ist aufgetreten!")))}}]),a}(r.a.Component),K=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(g.a,{className:"Guest"},r.a.createElement(k.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(s.b,{to:"../"},"Home"),r.a.createElement(h.Consumer,null,(function(e){return r.a.createElement(v.a,{label:"Account",items:[{label:"Logout",onClick:e.logout},{label:"Login",onClick:e.login}]})}))),r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/guest/ticketbestellen"},r.a.createElement(F,null)),r.a.createElement(x.a,{path:"/guest/tickets/"},r.a.createElement(_,null)),r.a.createElement(x.a,{path:"/guest/demosetup"},r.a.createElement(H,null)),r.a.createElement(x.a,{path:"/guest/bestellungsuebersicht"},r.a.createElement(U,null)),r.a.createElement(x.a,{path:"/guest/"},r.a.createElement(D,null))))}}]),a}(r.a.Component),G=a(337),J=a(334),q=a.n(J),Z=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.video=r.a.createRef(),n.canvasElement=r.a.createRef(),n.startScan=n.startScan.bind(Object(p.a)(n)),n.tick=n.tick.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"componentWillUnmount",value:function(){this.stopScan()}},{key:"tick",value:function(){if(this.video&&this.video.current){if(this.video.current.readyState===this.video.current.HAVE_ENOUGH_DATA){this.canvasElement.current.height=320,this.canvasElement.current.width=320,this.canvas.drawImage(this.video.current,0,0,this.canvasElement.current.width,this.canvasElement.current.height);var e=this.canvas.getImageData(0,0,this.canvasElement.current.width,this.canvasElement.current.height),t=q()(e.data,e.width,e.height,{inversionAttempts:"dontInvert"});if(t)switch(this.props.contentType){case"ETHEREUM_ADDRESS":var a=t.data.match(Object(G.a)(/(?:ethereum:)(0x[0-9A-Za-z]*)/,{address:1}));if(a&&a.groups.address)return this.stopScan(),void this.props.onDone(a.groups.address);break;case"ETHEREUM_SIGNATURE":case"IP_ADDRESS":case"JSON_DATA":break;default:return this.stopScan(),void this.props.onDone(t.data)}}requestAnimationFrame(this.tick)}}},{key:"startScan",value:function(){var e=this;if(!navigator.mediaDevices)return alert("Der Browser unterst\xfctzt diese Funktion nicht.");navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:320,height:320}}).then((function(t){e.canvas=e.canvasElement.current.getContext("2d"),e.video.current.srcObject=t,e.video.current.setAttribute("playsinline",!0),e.video.current.play(),requestAnimationFrame(e.tick),e.setState({isScanning:!0})})).catch((function(e){console.error(e),alert("Sorry, Kamera-Stream konnte nicht geladen werden.")}))}},{key:"stopScan",value:function(){this.video&&this.video.current&&this.video.current.srcObject&&(this.video.current.srcObject.getVideoTracks()[0].stop(),this.setState({isScanning:!1}))}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"QRScanner"},r.a.createElement("div",null,r.a.createElement("canvas",{ref:this.canvasElement,hidden:!this.state.isScanning}),r.a.createElement("video",{ref:this.video,hidden:!0})),!this.state.isScanning&&r.a.createElement(w.a,{label:this.props.label||"Scan",onClick:this.startScan}))}}]),a}(r.a.Component),Q=(a(645),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"dialog"},r.a.createElement("div",{className:"dialog-background-box"}),r.a.createElement("div",{className:"dialog-center"},r.a.createElement("div",{className:"dialog-content"},r.a.createElement("div",{className:"dialog-header"},r.a.createElement("h1",null,this.props.title),r.a.createElement(w.a,{className:"abort",onClick:this.props.onAbort},"X")),r.a.createElement("div",{className:"dialog-body"},this.props.children))))}}]),a}(r.a.Component)),X=(a(315),function(){function e(){Object(l.a)(this,e),this._iceCandidatesHandler=this._iceCandidatesHandler.bind(this),this._dataChannelOpenHandler=this._dataChannelOpenHandler.bind(this),this._receiveChannelHandler=this._receiveChannelHandler.bind(this),this._dataChannelClosedHandler=this._dataChannelClosedHandler.bind(this),this._connectionChangeHandler=this._connectionChangeHandler.bind(this),this._generateAnswer=this._generateAnswer.bind(this),this.requestMap=new Map,this.icecandidates=[],this.remoteICECandidates=[],this.onConnectionChanged=function(e){},this._initConnection()}return Object(o.a)(e,[{key:"_initConnection",value:function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null,this.localPeerConnection=new RTCPeerConnection(null),this.localPeerConnection.addEventListener("icecandidate",this._iceCandidatesHandler),this.localPeerConnection.addEventListener("connectionstatechange",this._connectionChangeHandler),this.localPeerConnection.addEventListener("datachannel",this._receiveChannelHandler);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_iceCandidatesHandler",value:function(e){this.icecandidates.push(e.candidate),this.answer&&!this.qrcode&&setTimeout(this._generateAnswer,200)}},{key:"_connectionChangeHandler",value:function(e){console.debug(e);var t=e.target.connectionState;this.onConnectionChanged(t)}},{key:"_dataChannelOpenHandler",value:function(e){console.debug(e),this.onReady()}},{key:"_dataChannelClosedHandler",value:function(e){console.debug(e)}},{key:"_messageHandler",value:function(e){console.debug(e.data),alert(e.data)}},{key:"_receiveChannelHandler",value:function(e){this.dataChannel=e.channel,this.dataChannel.addEventListener("message",this._messageHandler),this.dataChannel.addEventListener("open",this._dataChannelOpenHandler),this.dataChannel.addEventListener("close",this._dataChannelClosedHandler)}},{key:"_createUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:0&a).toString(16)}))}},{key:"readTicketRemote",value:function(e){var t=this;return new Promise((function(a,n){var r=t._createUUID();t.requestMap.set(r,{resolve:a,reject:n});var c={type:"Request",reqId:r,context:"ticketMirror",method:"getTicket",params:[e]};try{t.dataChannel.send(JSON.stringify(c))}catch(i){n(i)}}))}},{key:"obliterateTicketRemote",value:function(e,t){var a=this;return new Promise((function(n,r){var c=a._createUUID();a.requestMap.set(c,{resolve:n,reject:r});var i={type:"Request",reqId:c,context:"ticketMirror",method:"obliterateTicket",params:[e,t]};try{a.dataChannel.send(JSON.stringify(i))}catch(s){r(s)}}))}},{key:"setMasterConfig",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var a=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(t.offer)).catch(console.error);case 2:return t.candidates.forEach((function(e){a.localPeerConnection.addIceCandidate(e).catch(console.error),a.remoteICECandidates.push(e)})),e.next=5,this.localPeerConnection.createAnswer().catch(console.error);case 5:return this.answer=e.sent,e.next=8,this.localPeerConnection.setLocalDescription(this.answer).catch(console.error);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_generateAnswer",value:function(){var e={answer:this.answer,candidates:this.icecandidates};this.onAnswer(e)}},{key:"toJSON",value:function(){var e={localDescription:this.localPeerConnection.currentLocalDescription,remoteDescription:this.localPeerConnection.currentRemoteDescription,candidates:this.remoteICECandidates};return JSON.stringify(e)}}]),e}()),Y=a(121),$=a.n(Y),ee=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={connected:null},n.connectTicketReader=n.connectTicketReader.bind(Object(p.a)(n)),n.scanDoneHandler=n.scanDoneHandler.bind(Object(p.a)(n)),n.ticketReader=null,n}return Object(o.a)(a,[{key:"connectTicketReader",value:function(){var e=this,t=new X;t.onReady=function(){e.ticketReader=e.state.connectTR,e.setState({connectTR:null})},t.onConnectionChanged=function(t){switch(t){case"connected":case"disconnected":case"failed":case"closed":e.setState({connected:t})}},t.onAnswer=function(){var t=Object(m.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$.a.deflate(JSON.stringify(a),{level:9,to:"string"}),t.next=3,I.a.toDataURL(n).catch(console.error);case 3:r=t.sent,e.setState({TRQRCode:r,connectTRStep:1});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.setState({connectTR:t,connectTRStep:0})}},{key:"scanDoneHandler",value:function(e){var t=JSON.parse($.a.inflate(e,{to:"string"}));this.state.connectTR.setMasterConfig(t)}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{className:"EntranceManagement",pad:"medium"},!this.state.connected&&r.a.createElement(g.a,null,r.a.createElement("p",null,"Wenn Sie dieses Ger\xe4t als Ticket Leser verwenden m\xf6chten, m\xfcssen Sie es erst mit dem Event-Manager verbinden."),r.a.createElement("p",null,"Bitte stellen Sie sicher, dass dieses Ger\xe4t mit dem selben lokalen Netzwerk, wie der Event-Manager verbunden ist."),r.a.createElement(w.a,{onClick:this.connectTicketReader,label:"Ticket Reader Aktivieren"}),this.state.connectTR&&r.a.createElement(Q,{title:"Als Ticket Reader verbinden",onAbort:function(){e.setState({connectTR:null})}},0===this.state.connectTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"scanner"},r.a.createElement(Z,{onDone:this.scanDoneHandler,label:"Scanvorgang starten"})),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"Bitte den Code des Initiators scannen"))),1===this.state.connectTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"qrcode"},!this.state.TRQRCode&&r.a.createElement("div",{className:"loader"},"Loading..."),this.state.TRQRCode&&r.a.createElement("img",{src:this.state.TRQRCode,width:"100%",alt:"Ein QR-Code sollte hier angezeigt werden."})),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"Bitte nun mit dem Initiator Ger\xe4t scannen"))))),"connected"===this.state.connected&&r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/entrance/"},r.a.createElement("p",null,"Wunderbar, Sie sind verbunden..."),r.a.createElement("p",null,"In Zukunft sollten hier Funktionen zum Ticket-Scan stehen..."),r.a.createElement(w.a,{label:"Lese ein Beispiel Ticket",onClick:function(){e.ticketReader.readTicketRemote("2537f4c1-2bfa-416f-9098-9b61fe4bb59d")}}),r.a.createElement(w.a,{label:"Entwerte Ticket",onClick:function(){e.ticketReader.obliterateTicketRemote(123,"signature")}}),r.a.createElement(w.a,{label:"Beispiel Funktion 3"}))),"disconnected"===this.state.connected&&r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/entrance/"},r.a.createElement("p",null,"Die Verbindung wurde unterbrochen!"),r.a.createElement("p",null,"Bitte warten Sie einen Moment..."))),"failed"===this.state.connected&&r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/entrance/"},r.a.createElement("p",null,"Die Verbindung wurde unterbrochen!"),r.a.createElement("p",null,"Bitte aktivieren Sie den Reader erneut."),r.a.createElement(w.a,{onClick:function(){e.setState({connected:null}),e.connectTicketReader()},label:"Ticket Reader Aktivieren"}))))}}]),a}(r.a.Component),te=function(){function e(){if(Object(l.a)(this,e),this._createDB=this._createDB.bind(this),this.dumpTicketMirror=this.dumpTicketMirror.bind(this),this.getTicketList=this.getTicketList.bind(this),!window.indexedDB)throw Error("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");this.waitingForIDBReadyQueue=[],this._initDB()}return Object(o.a)(e,[{key:"_initDB",value:function(){var e=this;console.debug("Initializing IDB Connection");var t=window.indexedDB.open("TicketMirror",1);t.addEventListener("upgradeneeded",this._createDB),t.addEventListener("success",(function(t){console.debug("IDB Connection established"),e.db=t.target.result,e.waitingForIDBReadyQueue.forEach((function(t){t(e.db)}))})),t.addEventListener("error",(function(e){console.error("Database error: "+e.target.errorCode)}))}},{key:"_createDB",value:function(e){this.db=e.target.result,this.db.createObjectStore("tickets",{keyPath:"identifier"})}},{key:"_getIDB",value:function(){var e=this;return new Promise((function(t){e.db?t(e.db):e.waitingForIDBReadyQueue.push(t)}))}},{key:"dumpTicketMirror",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getIDB().catch(console.error);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:a=t.transaction("tickets","readwrite").objectStore("tickets"),[{identifier:"ca6c9409-0ec9-42fb-9ca7-d42a74642d7e",isValid:!0,isUsed:!1,ticketType:"Parken"},{identifier:"cea4b540-63a4-4abd-9a9a-499bb3879b8c",isValid:!1,isUsed:!0,ticketType:"Begleitperson"},{identifier:"2537f4c1-2bfa-416f-9098-9b61fe4bb59d",isValid:!0,isUsed:!1,ticketType:"Begleitperson"},{identifier:"c3573a44-f9e8-4772-bf80-57d1d07239c8",isValid:!0,isUsed:!0,ticketType:"Begleitperson"},{identifier:"5506d14d-8090-411a-897c-3f6c898ec8d2",isValid:!0,isUsed:!0,ticketType:"Begleitperson"}].forEach((function(e){a.add(e)}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTicketList",value:function(){var e=this;return new Promise(function(){var t=Object(m.a)(b.a.mark((function t(a,n){var r,c,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._getIDB().catch(console.error);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",n());case 5:c=r.transaction("tickets","readonly").objectStore("tickets"),(i=c.getAll()).onerror=n,i.onsuccess=function(e){var t=e.target.result;return a(t)};case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getTicket",value:function(e){var t=this;return new Promise(function(){var a=Object(m.a)(b.a.mark((function a(n,r){var c,i,s;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._getIDB().catch(console.error);case 2:if(c=a.sent){a.next=5;break}return a.abrupt("return",r());case 5:i=c.transaction("tickets","readonly").objectStore("tickets"),(s=i.get(e)).onerror=r,s.onsuccess=function(e){var t=e.target.result;return t?n(t):r("Ticket does not exist.")};case 9:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"obliterateTicket",value:function(e,t){var a=this;return new Promise(function(){var t=Object(m.a)(b.a.mark((function t(n,r){var c,i,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a._getIDB().catch(console.error);case 2:if(c=t.sent){t.next=5;break}return t.abrupt("return",r());case 5:i=c.transaction("tickets","readwrite").objectStore("tickets"),(s=i.get(e)).onerror=r,s.onsuccess=function(e){var t=e.target.result;if(!t)return r("Ticket does not exist.");if(!t.isValid)return r("Ticket is not valid.");if(t.isUsed)return r("Ticket was already used.");t.isUsed=!0;var a=i.put(t);a.onerror=r,a.onsuccess=n};case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}}]),e}(),ae=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;if(Object(l.a)(this,a),(n=t.call(this,e)).state={tickets:[]},n.handleDumpMirror=n.handleDumpMirror.bind(Object(p.a)(n)),n.showTickets=n.showTickets.bind(Object(p.a)(n)),!n.props.localTicketMirror)throw new Error("Missing LocalTicketMirror");return n.showTickets(),n}return Object(o.a)(a,[{key:"handleDumpMirror",value:function(){this.props.localTicketMirror.dumpTicketMirror(),this.showTickets()}},{key:"showTickets",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.localTicketMirror,e.next=3,t.getTicketList().catch(console.error);case 3:if(a=e.sent){e.next=6;break}return e.abrupt("return");case 6:this.setState({tickets:a});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.tickets.map((function(e){return r.a.createElement("li",{key:e.identifier},e.isValid&&"Valid",!e.isValid&&"Not Valid"," -  ",e.isUsed&&"Used",!e.isUsed&&"Not Used"," - ",e.ticketType)}));return r.a.createElement(g.a,{className:"IndexedDBExample",pad:"medium"},r.a.createElement("ul",null,e),r.a.createElement(w.a,{label:"Dump Mirror",onClick:this.handleDumpMirror}))}}]),a}(r.a.Component),ne=function(){function e(){Object(l.a)(this,e),this.iceCandidatesHandler=this.iceCandidatesHandler.bind(this),this.dataChannelOpenHandler=this.dataChannelOpenHandler.bind(this),this.generateOfferCode=this.generateOfferCode.bind(this),this.dataChannelClosedHandler=this.dataChannelClosedHandler.bind(this),this.connectionChangeHandler=this.connectionChangeHandler.bind(this),this.setTicketReaderConfig=this.setTicketReaderConfig.bind(this),this.messageHandler=this.messageHandler.bind(this),this.uuid=this.createUUID(),this.onConnectionChanged=function(e){},this.onReady=function(){},this.onOffer=function(e){},this.onGetTicket=function(e,t){},this.onObliterateTicket=function(e,t,a){},this.initConnection()}return Object(o.a)(e,[{key:"initConnection",value:function(){this.icecandidates=[],this.localPeerConnection=new RTCPeerConnection(null),this.localPeerConnection.addEventListener("icecandidate",this.iceCandidatesHandler),this.localPeerConnection.addEventListener("connectionstatechange",this.connectionChangeHandler),this.dataChannel=this.localPeerConnection.createDataChannel("sendDataChannel",null),this.dataChannel.addEventListener("message",this.messageHandler),this.dataChannel.addEventListener("open",this.dataChannelOpenHandler),this.dataChannel.addEventListener("close",this.dataChannelClosedHandler),this.createOffer()}},{key:"iceCandidatesHandler",value:function(e){this.icecandidates.push(e.candidate),this.offer&&!this.qrcode&&setTimeout(this.generateOfferCode,200)}},{key:"connectionChangeHandler",value:function(e){console.debug(e);var t=e.target.connectionState;this.onConnectionChanged(t)}},{key:"dataChannelOpenHandler",value:function(e){console.debug(e),this.onReady(),this.dataChannel.send("Hallo Client!")}},{key:"dataChannelClosedHandler",value:function(e){console.debug("Data Channel Closed",e)}},{key:"messageHandler",value:function(e){var t,a=this;console.debug("Message received:",e.data);try{t=JSON.parse(e.data)}catch(n){return console.error(n),void console.debug("Message was:",e.data)}switch(t.context){case"ticketMirror":"getTicket"===t.method?this.onGetTicket(t.params[0],(function(e,n){var r={reqId:t.reqId,result:{ticket:e,errorMessage:n}};try{a.dataChannel.send(JSON.stringify(r))}catch(c){console.error(c)}})):"obliterateTicket"===t.method&&this.onObliterateTicket(t.params[0],t.params[1],(function(e,n){var r={reqId:t.reqId,result:{success:e,errorMessage:n}};try{a.dataChannel.send(JSON.stringify(r))}catch(c){console.error(c)}}))}}},{key:"createUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:0&a).toString(16)}))}},{key:"createOffer",value:function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.createOffer().catch(console.error);case 2:return this.offer=e.sent,e.next=5,this.localPeerConnection.setLocalDescription(this.offer).catch(console.error);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateOfferCode",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={offer:this.offer,candidates:this.icecandidates},this.onOffer(t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setTicketReaderConfig",value:function(){var e=Object(m.a)(b.a.mark((function e(t){var a=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(t.answer)).catch(this.handleError);case 2:t.candidates.forEach((function(e){a.localPeerConnection.addIceCandidate(e).catch(a.handleError)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),re=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.connectRemoteTicketReader=n.connectRemoteTicketReader.bind(Object(p.a)(n)),n.scanDoneHandler=n.scanDoneHandler.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"scanDoneHandler",value:function(e){var t=JSON.parse($.a.inflate(e,{to:"string"}));this.state.connectRTR.setTicketReaderConfig(t)}},{key:"connectRemoteTicketReader",value:function(){var e=this,t=new ne;t.onReady=function(){e.setState({connectRTR:null}),e.props.onRTR(t)},t.onOffer=function(){var t=Object(m.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$.a.deflate(JSON.stringify(a),{level:9,to:"string"}),t.next=3,I.a.toDataURL(n).catch(console.error);case 3:r=t.sent,e.setState({RTRQRCode:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.setState({connectRTR:t,addRTRStep:0})}},{key:"disconnectRemoteTicketReader",value:function(e){}},{key:"disconnectAll",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,{className:"TicketReaderManager",pad:"medium"},r.a.createElement("p",null,"Derzeit sind ",this.props.RTRList.length," Ticket Leser verbunden."),r.a.createElement(w.a,{onClick:this.connectRemoteTicketReader,label:"Ticket Leser Hinzuf\xfcgen"}),this.state.connectRTR&&r.a.createElement(Q,{title:"Remote Ticket Reader Hinzuf\xfcgen",onAbort:function(){e.setState({connectRTR:null})}},0===this.state.addRTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-qrcode"},!this.state.RTRQRCode&&r.a.createElement("div",{className:"loader"},"Loading..."),this.state.RTRQRCode&&r.a.createElement("img",{src:this.state.RTRQRCode,width:"100%",alt:"Ein QR-Code sollte hier angezeigt werden."})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte mit dem Zielger\xe4t scannen")),r.a.createElement("div",{className:"ticket-reader-action"},r.a.createElement(w.a,{onClick:function(){e.setState({addRTRStep:1})},label:"Weiter"}))),1===this.state.addRTRStep&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-scanner"},r.a.createElement(Z,{onDone:this.scanDoneHandler,label:"Scanvorgang starten"})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte nun den Code des Zielger\xe4ts scannen")))))}}]),a}(r.a.Component),ce=a(667),ie=a(670),se=a(336),le=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={},n.getConfigured=n.getConfigured.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"getConfigured",value:function(e){var t=this.props.mapTest.get(e);return t?t?r.a.createElement(E.a,{key:e},"Erledigt"):void 0:r.a.createElement(E.a,{key:e},"Nicht erledigt")}},{key:"render",value:function(){var e=[];return 0===this.props.initializeStep&&(e[0]=r.a.createElement(g.a,{pad:"medium",key:"start"},r.a.createElement(E.a,{textAlign:"center"},"Guten Tag und Herzlich Wilkommen zum Ticketsystem."),r.a.createElement(E.a,null,"Die n\xe4chsten Schritte dienen zur Initalisierung des Systems. Sie werden durch die notwendigen Vorbereitungsschritte gef\xfchrt."),r.a.createElement(E.a,{textAlign:"center"},"F\xfcr die Initalisierung sind folgende Schritte notwendig"))),5===this.props.initializeStep&&(e[0]=r.a.createElement(g.a,{pad:"medium",key:"end"},r.a.createElement(E.a,{textAlign:"center"},"Herzlich Gl\xfcckwunsch Sie haben das Ticketsystem erfolgreich konfiguriert!"))),e[1]=r.a.createElement(g.a,null,r.a.createElement(ce.a,{primaryKey:"initializeStep",secondaryKey:"doneSteps",data:[{initializeStep:r.a.createElement(E.a,{size:"large",weight:"bold",key:"header"},"Vorbereitsungsschritt"),doneSteps:r.a.createElement(E.a,{size:"large",weight:"bold",key:"headerZustand"},"Zustand")},{initializeStep:r.a.createElement(E.a,{weight:"normal",key:"StatusDB"}," Initalisieren der Datenbank"),doneSteps:this.getConfigured("DB")},{initializeStep:r.a.createElement(E.a,{weight:"normal",key:"StatusAdminAccount"},"Hinzuf\xfcgen eines Administratorbenutzers"),doneSteps:this.getConfigured("AA")},{initializeStep:r.a.createElement(E.a,{weight:"normal",key:"StatusMS"},"Initialisieren des Mailservers"),doneSteps:this.getConfigured("MS")},{initializeStep:r.a.createElement(E.a,{weight:"normal",key:"StatusAdminWallet"},"Hinzuf\xfcgen eines Wallets f\xfcr den Master-User"),doneSteps:this.getConfigured("AW")},{initializeStep:r.a.createElement(E.a,{weight:"normal",key:"StatusListe"},"Einlesen der Absolventen-Liste und Erstellung der One Time Passw\xf6rter"),doneSteps:this.getConfigured("AL")}]})),e}}]),a}(r.a.Component),oe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={addresse:""},n.configureTheAdminWallet=n.configureTheAdminWallet.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"configureTheAdminWallet",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"/setup/generateWallet",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer f1df51e1835233014368105514f07a70e9f2255b279e5535810d7fbf2d565cc1d692d8b06d53f6157423bb3c63b97e5a42adfbe6277e48dc028d8043683acca13b1b9f83773015ff5f3533e9ad08943bac2eb003f24fc3e6c910d2e83e69f39ec1d3e3ac98d4d2965312670810aab8ec152338654bcab32e7c82cbe83545b0b5f307feed1976239fbe2718c97abab76768e6dcdb3e243fcead76ef2bc2ca72045f748da22dee9881a3aefe0b18ce9dd6d34eb4032ed56e1cb4d8bf11d2ff0d663b65f3ee2b2da04af8bc3b0473c4046fdc53248905d3499955f635c6ed9bb7e2defb03b54414ac617e4f73c96e6639bf1b89111458f5d830387f0c51e2c5a5d6"}}).catch(console.log);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.json().catch(console.log);case 7:if(e.sent.message){e.next=10;break}return e.abrupt("return");case 10:this.props.changeValueOfmapTest("AW");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{size:"large",weight:"bold"},"Hinzuf\xfcgen des Wallets f\xfcr den Master-User:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(S.a,{placeholder:"HTTP-Provider DNS:Port",value:this.state.textInput,onChange:function(t){e.setState({textInput:t.target.value})}})),r.a.createElement(w.a,{onClick:this.setValueTrue,label:"Hinzuf\xfcgen"}))}}]),a}(r.a.Component),ue=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={eMail:"",password:"",role:0},n.configureTheAdminAcc=n.configureTheAdminAcc.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"configureTheAdminAcc",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"/setup/admin",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer f1df51e1835233014368105514f07a70e9f2255b279e5535810d7fbf2d565cc1d692d8b06d53f6157423bb3c63b97e5a42adfbe6277e48dc028d8043683acca13b1b9f83773015ff5f3533e9ad08943bac2eb003f24fc3e6c910d2e83e69f39ec1d3e3ac98d4d2965312670810aab8ec152338654bcab32e7c82cbe83545b0b5f307feed1976239fbe2718c97abab76768e6dcdb3e243fcead76ef2bc2ca72045f748da22dee9881a3aefe0b18ce9dd6d34eb4032ed56e1cb4d8bf11d2ff0d663b65f3ee2b2da04af8bc3b0473c4046fdc53248905d3499955f635c6ed9bb7e2defb03b54414ac617e4f73c96e6639bf1b89111458f5d830387f0c51e2c5a5d6"},body:JSON.stringify({email:this.state.email,password:this.state.password,role:this.state.role})}).catch(console.log);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.json().catch(console.log);case 7:if(e.sent.message){e.next=10;break}return e.abrupt("return");case 10:this.props.changeValueOfmapTest("AA");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{size:"large",weight:"bold"},"Hinzuf\xfcgen des Administratorbenutzers:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{weight:"bold"},"E-Mail-Adresse"),r.a.createElement(S.a,{placeholder:"E-Mail",value:this.state.eMail,onChange:function(t){e.setState({textInput:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{weight:"bold"},"Passwort:"),r.a.createElement(S.a,{placeholder:"Passwort",value:this.state.password,onChange:function(t){e.setState({textInput:t.target.value})}})),r.a.createElement(w.a,{onClick:this.configureTheAdminAcc,label:"Hinzuf\xfcgen"}))}}]),a}(r.a.Component),de=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={host:"",user:"",password:"",db:""},n.configureTheDatabase=n.configureTheDatabase.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"configureTheDatabase",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"/setup/database",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer f1df51e1835233014368105514f07a70e9f2255b279e5535810d7fbf2d565cc1d692d8b06d53f6157423bb3c63b97e5a42adfbe6277e48dc028d8043683acca13b1b9f83773015ff5f3533e9ad08943bac2eb003f24fc3e6c910d2e83e69f39ec1d3e3ac98d4d2965312670810aab8ec152338654bcab32e7c82cbe83545b0b5f307feed1976239fbe2718c97abab76768e6dcdb3e243fcead76ef2bc2ca72045f748da22dee9881a3aefe0b18ce9dd6d34eb4032ed56e1cb4d8bf11d2ff0d663b65f3ee2b2da04af8bc3b0473c4046fdc53248905d3499955f635c6ed9bb7e2defb03b54414ac617e4f73c96e6639bf1b89111458f5d830387f0c51e2c5a5d6"},body:JSON.stringify({HOST:this.state.host,USER:this.state.user,PASSWORD:this.state.password,DB:this.state.db})}).catch(console.log);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.json().catch(console.log);case 7:if(e.sent.message){e.next=10;break}return e.abrupt("return");case 10:this.props.changeValueOfmapTest("DB");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{size:"large",weight:"bold"},"Konfigurieren der Datenbank:")),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{weight:"bold"},"Datenbank-Host:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Datenbank-Host eingeben",value:this.state.host,onChange:function(t){e.setState({host:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Benutzer:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Benutzer eingeben",value:this.state.user,onChange:function(t){e.setState({user:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Passwort:"),r.a.createElement(S.a,{placeholder:"Hier bitte das Passwort eingeben",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"}," Datenbank:"),r.a.createElement(S.a,{placeholder:"Hier bitte die Datenbank eingeben",value:this.state.db,onChange:function(t){e.setState({db:t.target.value})}})),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(w.a,{onClick:this.configureTheDatabase,label:"Abschlie\xdfen"})))}}]),a}(r.a.Component),he=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={host:"",port:null,conncetion:!0,user:"",password:"",standardMail:"",standardPrefix:""},n.configureTheMailserver=n.configureTheMailserver.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"configureTheMailserver",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"/setup/mailserver",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer f1df51e1835233014368105514f07a70e9f2255b279e5535810d7fbf2d565cc1d692d8b06d53f6157423bb3c63b97e5a42adfbe6277e48dc028d8043683acca13b1b9f83773015ff5f3533e9ad08943bac2eb003f24fc3e6c910d2e83e69f39ec1d3e3ac98d4d2965312670810aab8ec152338654bcab32e7c82cbe83545b0b5f307feed1976239fbe2718c97abab76768e6dcdb3e243fcead76ef2bc2ca72045f748da22dee9881a3aefe0b18ce9dd6d34eb4032ed56e1cb4d8bf11d2ff0d663b65f3ee2b2da04af8bc3b0473c4046fdc53248905d3499955f635c6ed9bb7e2defb03b54414ac617e4f73c96e6639bf1b89111458f5d830387f0c51e2c5a5d6"},body:JSON.stringify({HOST:this.state.host,PORT:this.state.port,SECURE:this.state.conncetion,USER:this.state.user,PASSWORD:this.state.password,DEFAULT_FROM:this.state.standardMail,DEFAULT_SUBJECT_PREFIX:this.state.standardPrefix})}).catch(console.log);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.json().catch(console.log);case 7:if(e.sent.message){e.next=10;break}return e.abrupt("return");case 10:this.props.changeValueOfmapTest("MS");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(g.a,null,r.a.createElement(E.a,{size:"large",weight:"bold"},"Konfigurieren des Mailservers:"),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Mailserver-Host:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Mailserver-Host eingeben",value:this.state.textInput,onChange:function(t){e.setState({host:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"}," Port:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Port eingeben",value:this.state.port,onChange:function(t){e.setState({port:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Sichere Verbindung:"),r.a.createElement(ie.a,{options:["true","false"],value:this.state.conncetion,onChange:function(t){t.value;var a=t.option;e.setState({conncetion:a})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"}," Benutzer:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Benutzer eingeben",value:this.state.user,onChange:function(t){e.setState({user:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Passwort: "),r.a.createElement(S.a,{placeholder:"Hier bitte das Passwort eingeben",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Standard Mail:"),r.a.createElement(S.a,{placeholder:"Hier bitte die Standard Mail eingeben",value:this.state.standardMail,onChange:function(t){e.setState({standardMail:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(E.a,{weight:"bold"},"Standard Subject Prefix:"),r.a.createElement(S.a,{placeholder:"Hier bitte den Standard Prefix eingeben",value:this.state.standardPrefix,onChange:function(t){e.setState({standardPrefix:t.target.value})}})),r.a.createElement(g.a,{pad:"small"},r.a.createElement(w.a,{onClick:this.configureTheMailserver,label:"Abschlie\xdfen"})))}}]),a}(r.a.Component),fe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleOnDrop=function(e){var t=[];console.log("---------------------------"),console.log(e),console.log("---------------------------"),e.forEach((function(e){console.log(e.data),t.push(e.data)})),n.setState({listeEingelesen:!0,initialeListe:t})},n.handleOnError=function(e,t,a,n){console.log(e)},n.handleOnRemoveFile=function(e){console.log("---------------------------"),console.log(e),console.log("---------------------------")},n.state={listeEingelesen:!1,finished:!1,initialeListe:[],dateiTyp:"CSV",path:""},n.useListAndSendMail=n.useListAndSendMail.bind(Object(p.a)(n)),n}return Object(o.a)(a,[{key:"useListAndSendMail",value:function(){var e=Object(m.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.a.BACKEND_BASE_URI+"",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer f1df51e1835233014368105514f07a70e9f2255b279e5535810d7fbf2d565cc1d692d8b06d53f6157423bb3c63b97e5a42adfbe6277e48dc028d8043683acca13b1b9f83773015ff5f3533e9ad08943bac2eb003f24fc3e6c910d2e83e69f39ec1d3e3ac98d4d2965312670810aab8ec152338654bcab32e7c82cbe83545b0b5f307feed1976239fbe2718c97abab76768e6dcdb3e243fcead76ef2bc2ca72045f748da22dee9881a3aefe0b18ce9dd6d34eb4032ed56e1cb4d8bf11d2ff0d663b65f3ee2b2da04af8bc3b0473c4046fdc53248905d3499955f635c6ed9bb7e2defb03b54414ac617e4f73c96e6639bf1b89111458f5d830387f0c51e2c5a5d6"}}).catch(console.log);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.json().catch(console.log);case 7:if(e.sent.message){e.next=10;break}return e.abrupt("return");case 10:this.setState({finished:!0}),this.props.changeValueOfmapTest("AL");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.initialeListe;return r.a.createElement(g.a,null,r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,{size:"large",weight:"bold"},"Einlesen der Absolventen Liste")),!this.state.listeEingelesen&&!this.state.finished&&r.a.createElement(g.a,{className:"Eingaben"},r.a.createElement(g.a,{pad:"medium"},r.a.createElement(E.a,null,"Bitte eine Liste in der folgenden Darstellung einlesen:"),r.a.createElement("span",null,r.a.createElement(E.a,{weight:"bold"},"Header: "),r.a.createElement(E.a,null,"E-Mail; Name")),r.a.createElement("span",null,r.a.createElement(E.a,{weight:"bold"},"Datensatz 1: "),r.a.createElement(E.a,null,"Beispiel@web.de; Mustermann, Max"))),r.a.createElement(se.a,{onDrop:this.handleOnDrop,onError:this.handleOnError,config:{delimiter:";",header:!0},addRemoveButton:!0,onRemoveFile:this.handleOnRemoveFile},r.a.createElement("span",null,"Drop CSV file here or click to upload."))),this.state.listeEingelesen&&!this.state.finished&&r.a.createElement(ce.a,{className:"langeListe",pad:"medium",primaryKey:"E-Mail",secondaryKey:"Name",data:e}),r.a.createElement(g.a,{pad:"medium"},r.a.createElement(w.a,{onClick:this.useListAndSendMail,label:"Abschlie\xdfen"})),this.state.listeEingelesen&&this.state.finished&&r.a.createElement(E.a,null,"Bitte den N\xe4chsten Schritt"))}}]),a}(r.a.Component),be=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).changeStep=n.changeStep.bind(Object(p.a)(n)),n.changeValueOfmapTest=n.changeValueOfmapTest.bind(Object(p.a)(n)),n.state={initializeStep:0,mapTest:new Map([["AW",!1],["DB",!1],["MS",!1],["AL",!1],["AA",!1]])},n}return Object(o.a)(a,[{key:"changeValueOfmapTest",value:function(e){this.setState(this.state.mapTest.set(e,!0))}},{key:"changeStep",value:function(){this.setState({initializeStep:1+this.state.initializeStep})}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"SystemInitalisierung",direction:"column",gap:"medium",pad:"medium",align:"center"},0===this.state.initializeStep&&r.a.createElement(le,{mapTest:this.state.mapTest,initializeStep:this.state.initializeStep}),1===this.state.initializeStep&&r.a.createElement(de,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this)}),2===this.state.initializeStep&&r.a.createElement(ue,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this)}),3===this.state.initializeStep&&r.a.createElement(he,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this)}),4===this.state.initializeStep&&r.a.createElement(oe,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this)}),5===this.state.initializeStep&&r.a.createElement(fe,{changeValueOfmapTest:this.changeValueOfmapTest.bind(this)}),6===this.state.initializeStep&&r.a.createElement(le,{mapTest:this.state.mapTest,initializeStep:this.state.initializeStep}),this.state.initializeStep<6&&r.a.createElement(w.a,{onClick:this.changeStep,label:"N\xe4chster Schritt"}),6===this.state.initializeStep&&r.a.createElement(g.a,{pad:"medium"}," ",r.a.createElement(w.a,{label:"Zur\xfcck"})," ",r.a.createElement(w.a,{label:"Konfigurationen anzeigen"})))}}]),a}(r.a.Component),me=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).rTRHandler=n.rTRHandler.bind(Object(p.a)(n)),n.localTicketMirror=new te,n.state={RTRList:[]},n}return Object(o.a)(a,[{key:"rTRHandler",value:function(e){var t=this,a=this.state.RTRList;a.push(e),this.setState({RTRList:a}),e.onConnectionChanged=function(e){console.log(e)},e.onGetTicket=function(e,a){t.localTicketMirror.getTicket(e).then((function(e){a(e)})).catch((function(e){a(null,e)}))},e.onObliterateTicket=function(e,t,a){a(!0)}}},{key:"render",value:function(){return r.a.createElement(g.a,{className:"EventManagement"},r.a.createElement(k.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(s.b,{to:"../"},"Home"),r.a.createElement(h.Consumer,null,(function(e){return r.a.createElement(v.a,{label:"Account",items:[{label:"Logout",onClick:e.logout},{label:"Login",onClick:e.login}]})}))),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/eventmgmt/rtrm"},"Manage Remote Ticket Readers")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/eventmgmt/entrancedb"},"Show Entrance Dashboard")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/eventmgmt/ticketshop"},"Manage Ticketshop")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/eventmgmt/SystemInitalisierung"},"System Initalisieren"))),r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/eventmgmt/rtrm"},r.a.createElement(re,{RTRList:this.state.RTRList,onRTR:this.rTRHandler})),r.a.createElement(x.a,{path:"/eventmgmt/entrancedb"},r.a.createElement(ae,{localTicketMirror:this.localTicketMirror})),r.a.createElement(x.a,{path:"/eventmgmt/SystemInitalisierung"},r.a.createElement(be,null)),r.a.createElement(x.a,{path:"/eventmgmt/ticketshop"},r.a.createElement(g.a,{pad:"medium"},"Hier m\xfcsste dann sowas wie ein Ticketshop Management Dashboard hin..."))))}}]),a}(r.a.Component),pe=a(671),ge=a(668),ke=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={user:{id:null,email:null,role:null,access_token:null}},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return console.log(this.state.user),r.a.createElement(h.Provider,{value:{user:this.state.user,logout:function(){e.setState({user:{id:null,email:null,role:null,access_token:null}})},login:function(){e.setState({user:{id:localStorage.getItem("user_id"),email:localStorage.getItem("user_email"),role:localStorage.getItem("user_role"),access_token:localStorage.getItem("access_token")}})}}},r.a.createElement(pe.a,{theme:ge.a},r.a.createElement(x.c,null,r.a.createElement(x.a,{exact:!0,path:"/"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/guest"},"Gast")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/entrance"},"Einlass-Management")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/eventmgmt"},"Event-Management")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/Accountmanagement"},"Accountmanagement"))))),r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/guest"},r.a.createElement(K,{eigenschaft1:"test"})),r.a.createElement(x.a,{path:"/entrance"},r.a.createElement(ee,null)),r.a.createElement(x.a,{path:"/eventmgmt"},r.a.createElement(me,null)),r.a.createElement(x.a,{path:"/Accountmanagement"},r.a.createElement(j,null)))))}}]),a}(r.a.Component),ve=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ee(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(s.a,null,r.a.createElement(ke,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/bnt-frontend",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/bnt-frontend","/service-worker.js");ve?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ee(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Ee(t,e)}))}}()}},[[344,1,2]]]);
//# sourceMappingURL=main.16dc6f87.chunk.js.map