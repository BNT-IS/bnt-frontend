{"version":3,"sources":["Ticketshop/Components/WalletSetup.js","Ticketshop/Components/UserMainMenu.js","Ticketshop/Components/TicketOverview.js","Ticketshop/Components/AccountManagement.js","Ticketshop/Components/BookingOverview.js","Ticketshop/Components/TicketBestellung.js","Ticketshop/Ticketshop.js","Utilities/Components/QRScanner.js","Utilities/Components/Dialog.js","EventManagement/Classes/TicketReader.js","EntranceManagement/EntranceManagement.js","EventManagement/Classes/LocalTicketMirror.js","EventManagement/Components/IndexedDBExample.js","EventManagement/Classes/RemoteTicketReader.js","EventManagement/Components/TicketReaderManager.js","EventManagement/Components/SystemInitalisierung.js","EventManagement/EventManagement.js","App.js","serviceWorker.js","index.js"],"names":["WalletSetup","props","state","sign","bind","connectWallet","this","init","alert","setState","walletAvailable","window","ethereum","walletLink","WalletLink","appName","appLogoUrl","darkMode","makeWeb3Provider","connected","selectedAddress","web3","Web3","enable","catch","displayError","accounts","console","log","eth","defaultAccount","message","from","text","msg","utils","stringToHex","params","currentProvider","send","method","err","result","error","recovered","recover","toLowerCase","open","Box","className","direction","gap","pad","Text","Button","label","onClick","linkToDownloadMetaMask","TextInput","placeholder","value","signMessage","onChange","event","target","React","Component","UserMainMenu","to","SingleTicketViewer","identifier","useParams","ticket","tickets","find","forename","surname","ticketType","TicketListItem","location","assign","TicketOverview","loading","fetchTickets","fetch","mode","cache","headers","response","json","forEach","ticketsCopy","index","array","data","QRCode","toDataURL","then","url","qrcode","push","length","ticketElements","map","key","path","AccountManagement","createCoinbaseWallet","createUser","otpBest√§tigen","otpInputHandler","setState1","setState6","otp","step","Token","tokenHandler","verifyAddress","walletLogin","walletVerbinden","body","JSON","stringify","address","test","challenge","challengeString","a","signature","jsResponse","setToken","token","localStorage","setItem","getItem","classname","BestellungsItem","ticketsForBooking","buchung","booking","accPanelLabel","id","user","dateBooked","datePaid","AccordionPanel","margin","BookingOverview","loadListHandler","loadTicketsHandler","buchungen","indexOfBooking","undefined","bookingId","findIndex","kopieTickets","concat","filteredTickets","filter","Accordion","onActive","activeItems","TicketBestellung","increment","property","guestcount","parkcount","decrement","WindowAbsolventTicket","WindowGuestTicket","WindowParkTicket","ToOverview","ToPayment","Ticketshop","Header","background","justify","Menu","items","QRScanner","video","createRef","canvasElement","startScan","tick","stopScan","current","readyState","HAVE_ENOUGH_DATA","height","width","canvas","drawImage","imageData","getImageData","code","jsQR","inversionAttempts","contentType","match","groups","onDone","requestAnimationFrame","navigator","mediaDevices","getUserMedia","facingMode","stream","getContext","srcObject","setAttribute","play","isScanning","getVideoTracks","stop","ref","hidden","Dialog","title","onAbort","children","TicketReader","_iceCandidatesHandler","_dataChannelOpenHandler","_receiveChannelHandler","_dataChannelClosedHandler","_connectionChangeHandler","_generateAnswer","requestMap","Map","icecandidates","remoteICECandidates","onConnectionChanged","connectionState","_initConnection","localPeerConnection","RTCPeerConnection","addEventListener","candidate","answer","setTimeout","debug","onReady","dataChannel","channel","_messageHandler","dt","Date","getTime","replace","c","r","Math","random","floor","toString","Promise","resolve","reject","reqId","_createUUID","set","type","context","e","config","setRemoteDescription","RTCSessionDescription","offer","candidates","addIceCandidate","createAnswer","setLocalDescription","onAnswer","lstore","localDescription","currentLocalDescription","remoteDescription","currentRemoteDescription","EntranceManagement","connectTicketReader","scanDoneHandler","ticketReader","connectTR","binaryString","pako","deflate","level","TRQRCode","connectTRStep","obj","parse","inflate","setMasterConfig","src","alt","readTicketRemote","obliterateTicketRemote","LocalTicketMirror","_createDB","dumpTicketMirror","getTicketList","indexedDB","Error","waitingForIDBReadyQueue","_initDB","request","ev","db","errorCode","createObjectStore","keyPath","_getIDB","objectStore","transaction","item","add","getAll","onerror","onsuccess","get","isValid","isUsed","requestUpdate","put","IndexedDBExample","handleDumpMirror","showTickets","localTicketMirror","ltm","RemoteTicketReader","iceCandidatesHandler","dataChannelOpenHandler","generateOfferCode","dataChannelClosedHandler","connectionChangeHandler","setTicketReaderConfig","messageHandler","uuid","createUUID","onOffer","onGetTicket","callback","onObliterateTicket","initConnection","createDataChannel","createOffer","errorMsg","answerMsg","errorMessage","success","handleError","TicketReaderManager","connectRemoteTicketReader","connectRTR","remoteTicketReader","onRTR","RTRQRCode","addRTRStep","RTRList","SystemInitalisierung","dateiTyp","Select","options","option","EventManagement","rTRHandler","getTicket","App","account","obliterateTokens","getAccountDetails","details","verified","getAccountBalance","balance","st","paidTickets","poolTickets","parkTickets","errorDisplay","number","Grommet","theme","grommet","exact","eigenschaft1","Boolean","hostname","ReactDOM","render","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7e2e41df.chunk.js","sourcesContent":["import React from 'react';\nimport { Box, Button, Text, TextInput } from 'grommet';\nimport Web3 from 'web3';\nimport WalletLink from 'walletlink';\n\nclass WalletSetup extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {};\n        this.sign = this.sign.bind(this);\n        this.connectWallet = this.connectWallet.bind(this);\n        \n    }\n\n    /**\n     * Calling the initialization directly after this component\n     * was created and mounted in the DOM.\n     */\n    componentDidMount() {\n        this.init();\n    }\n\n    displayError() {\n        alert(\"Ups, das hat nicht geklappt\");\n    }\n\n    /**\n     * Initializes Ethereum Wallet Provider and Web3 Instance\n     * In case the browser is a desktop browser without wallet capability,\n     * the Standard WalletLink is used to create a Wallet Provider instance.\n     * WalletLink is supported by Coinbase as an example: https://github.com/walletlink/walletlink\n     */\n    init() {\n        // TODO: Move these constants to a global constants file\n        const APP_NAME = 'DHBW Bachelors Night Ticketing 2020'\n        const APP_LOGO_URL = 'https://einfachtierisch.de/media/cache/article_teaser/cms/2015/09/Katze-lacht-in-die-Kamera-shutterstock-Foonia-76562038.jpg?595617'\n        const ETH_JSONRPC_URL = 'https://mainnet.infura.io/v3/efaece4f5f4443979063839c124c8171' // Mainnet\n        const CHAIN_ID = 1\n\n        this.setState({ walletAvailable: window.ethereum ? true : false });\n\n        if (!window.ethereum) {\n\n            // Initialize WalletLink\n            this.walletLink = new WalletLink({\n                appName: APP_NAME,\n                appLogoUrl: APP_LOGO_URL,\n                darkMode: false\n            })\n\n            // Initialize a Web3 Provider object\n            window.ethereum = this.walletLink.makeWeb3Provider(ETH_JSONRPC_URL, CHAIN_ID);\n        }\n\n        // Checking if wallet is already connected or not\n        // eslint-disable-next-line\n        this.setState({ connected: window.ethereum.selectedAddress ? true : false });\n\n        // Creating Web3 Instance\n        this.web3 = new Web3(window.ethereum);\n    }\n\n    /**\n     * Attempts to connect with the Wallet\n     */\n    async connectWallet() {\n        // Requesting connection to wallet\n        var accounts = await window.ethereum.enable().catch(this.displayError);\n        if (!accounts) return;\n\n        console.log(`User's address is ${accounts[0]}`);\n        this.web3.eth.defaultAccount = accounts[0];\n        this.setState({ connected: true });\n    }\n\n    /**\n     * Example method for showing how a message can be signed and verified.\n     */\n    async sign(message) {\n        if (!window.ethereum) return this.displayError();\n        if (!window.ethereum.selectedAddress) return this.displayError();\n        var from = window.ethereum.selectedAddress;\n\n        var text = message;\n        var msg = this.web3.utils.stringToHex(text);\n\n        var params = [msg, from]\n        var method = 'personal_sign'\n\n        this.web3.currentProvider.send({\n            method,\n            params,\n            from,\n        }, (err, result) => {\n            if (err) return console.error(err)\n            if (result.error) return console.error(result.error)\n\n            console.log(result);\n\n            var recovered = this.web3.eth.accounts.recover(msg, result.result);\n\n            if (recovered.toLowerCase() === from.toLowerCase()) {\n                alert('Successfully ecRecovered signer as ' + from)\n            } else {\n                alert('Failed to verify signer when comparing ' + recovered + ' to ' + from)\n            }\n        })\n    }\n\n    /**\n     * Just a method to open a new tab...\n     */\n    linkToDownloadMetaMask() {\n        window.open('https://wallet.coinbase.com/', '_blank');\n    }\n\n    render() {\n        return (\n            <Box className=\"WalletSetup\" direction=\"column\" gap=\"medium\" pad=\"medium\">\n                <h1>Wallet Setup</h1>\n                <Text>\n                    Um Tickets zu erwerben ben√∂tigen Sie ein sogenanntes Wallet.\n                    Dieses ist vergleichbar mit Ihrer Geldb√∂rse zu der nur Sie Zugriff haben.\n                </Text>\n                {(!this.state.walletAvailable && !this.state.connected) &&\n                    <Box gap=\"medium\">\n                        <Text>\n                            F√ºr unser Ticket-System muss dieses Wallet Ethereum-f√§hig sein.\n                            Wir empfehlen Ihnen daher das Coinbase Wallet.\n                            Bitte installieren Sie sich das Coinbase Wallet √ºber die offizielle Website.\n                            Kommen Sie nach Abschluss der Einrichtung wieder auf diese Seite zur√ºck.\n                        </Text>\n                        <Button label=\"Coinbase f√ºr's Smartphone installieren\" onClick={this.linkToDownloadMetaMask}></Button>\n                    </Box>\n                }\n                {!this.state.connected &&\n                    <Box gap=\"medium\">\n                        <Text>\n                            Als N√§chstes ben√∂tigt unsere Plattform die Adresse Ihres Wallets.\n                            Bitte best√§tigen Sie daher die Verbindung mit Ihrem Wallet √ºber folgende Schaltfl√§che.\n                            Sie geben dadurch <b>nicht</b> Ihre Kontrolle √ºber das Wallet ab!\n                        </Text>\n                        <Button label=\"Mit dem Wallet verbinden\" onClick={this.connectWallet}></Button>\n                    </Box>\n                }\n                <Text>\n                    Hier folgt eine DEMO!!!\n                </Text>\n                <TextInput\n                    placeholder=\"Nachricht zum signieren\"\n                    value={this.state.signMessage}\n                    onChange={(event) => { this.setState({ signMessage: event.target.value }) }}\n                ></TextInput>\n                <Button label=\"Sign and Verify Message\" onClick={() => { this.sign(this.state.signMessage) }}></Button>\n            </Box>\n        );\n    }\n}\n\nexport default WalletSetup;\n","import React from 'react';\nimport './UserMainMenu.css';\nimport { Box } from 'grommet';\nimport { Link } from \"react-router-dom\";\n\nclass UserMainMenu extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { };\n    }\n\n    render() {\n        return (\n            <Box className=\"UserMainMenu\" direction=\"column\" gap=\"medium\" pad=\"medium\">\n                <Link className=\"MenuLink\" to=\"/guest/tickets\">Tickets Anzeigen</Link>\n                <Link className=\"MenuLink\" to=\"/guest/ticketbestellen\">Tickets Bestellen</Link>\n                <Link className=\"MenuLink\" to=\"/guest/bestellungsuebersicht\">Bestellungen Anzeigen</Link>\n                <Link className=\"MenuLink\" to=\"/guest/setup\">Setup</Link>\n            </Box>\n        );\n    }\n}\n\nexport default UserMainMenu;\n","import React from 'react';\nimport './TicketOverview.css';\nimport { Box, Button, Text } from 'grommet';\nimport { Switch, Route, Link, useParams } from \"react-router-dom\";\nimport QRCode from 'qrcode';\n\nfunction SingleTicketViewer(props) {\n    let { identifier } = useParams();\n    const ticket = props.tickets.find(ticket => ticket.identifier === identifier);\n    return (\n        <Box className=\"SingleTicket\">\n            {ticket.forename}\n            {ticket.surname}\n            {ticket.ticketType}\n        </Box>\n    );\n}\n\nfunction TicketListItem(props) {\n    return (\n        <Box className=\"TicketListItem\" direction=\"row\" gap=\"small\" pad=\"small\">\n            <Text className=\"Name\">{props.ticket.forename} {props.ticket.surname}</Text>\n            <Text className=\"Type\">{props.ticket.ticketType}</Text>\n            <Button label=\"Anzeigen\" onClick={() => { window.location.assign('#/guest/tickets/' + props.ticket.identifier); }}></Button>\n        </Box>\n    );\n}\n\nclass TicketOverview extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { tickets: [], loading: false }\n    }\n\n    componentDidMount() {\n        this.fetchTickets();\n    }\n\n    async fetchTickets() {\n        this.setState({ loading: true });\n        let address = \"0x3Da85f73bC1B1662FE247391dEcD2a52f139fd13\";\n        var response = await fetch(\"http://localhost:3000/api/v1/users/\" + address + \"/tickets\", {\n            //method: 'GET', // *GET, POST, PUT, DELETE, etc.\n            mode: 'cors', // no-cors, *cors, same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': 'Bearer 43059960ead1db519cbbed4aa934462808262fa6204daefabcab4b0b38b667d61828556556e4b9e80b6a91e9990fc8704bbf399cdafd41b06ddc0c31a500accb94b96fa096bf8789c7c582f9e5df0ead8f23ef77a9b045ccbb78a60cd2401592e79b8c396cd4520297cfb0603011a7f373f9dbbc6a37527bd160b5e754850cbf8779a4c5049e816a9b9bee268e110baf53e901e80aa8df89d6a07b92cf33b581294bedc1b8da2c9a583845b13766f4c89abc9ac3466b69748a1ba0bf6a80a8c2b6aa6ec084c88c2cc4d212470089dbb9e4bce056c90e8a0ebaa5b9e563c80d20ac173b791769eac9d29c509810086f1700c7cec0071a03bb7aed67fec7215979',\n            }\n        }).catch(console.log);\n\n        if (!response) return;\n\n        var tickets = await response.json().catch(console.log);\n\n        if (!tickets) return;\n\n        tickets.forEach((ticket) => {\n            switch (ticket.ticketType) {\n                case \"0\": ticket.ticketType = \"Absolvent\"; break;\n                case \"1\": ticket.ticketType = \"Begleitperson\"; break;\n                case \"2\": ticket.ticketType = \"Parkticket\"; break;\n                default: break;\n            }\n        });\n\n        this.setState({ tickets: tickets, loading: false });\n    }\n\n    generateQRCodes() {\n        var ticketsCopy = [];\n        this.state.tickets.forEach((ticket, index, array) => {\n            let data = ticket.identifier; // TODO Change to signature and so on...\n            QRCode.toDataURL(data).then((url) => {\n                ticket.qrcode = url;\n                ticketsCopy.push(ticket);\n                if (index === array.length - 1) {\n                    this.setState({ tickets: ticketsCopy });\n                }\n            }).catch(console.log);\n        })\n    }\n\n    render() {\n        let ticketElements = this.state.tickets.map((ticket) => <TicketListItem key={ticket.identifier} ticket={ticket}></TicketListItem>);\n        \n        return (\n            <Box className=\"TicketOverview\" direction=\"column\" gap=\"medium\" pad=\"medium\">\n                <Switch>\n                    <Route path=\"/guest/tickets/:identifier\">\n                        <Link to=\"/guest/tickets/\">Alle Tickets anzeigen</Link>\n                        <SingleTicketViewer tickets={this.state.tickets}></SingleTicketViewer>\n                    </Route>\n                    <Route path=\"/guest/tickets/\">\n                        <Box>\n                            <Box>\n                                <h1 className=\"NumberOfTickets\">{this.state.tickets.length}</h1>\n                            </Box>\n                            <Box className=\"TicketList\">\n                                {this.state.loading && <p className=\"loader\"></p>}\n                                {ticketElements}\n                            </Box>\n                        </Box>\n                    </Route>\n                </Switch>\n            </Box>\n        );\n    }\n}\n\nexport default TicketOverview;\n","import React from 'react';\nimport { Box, Button, TextInput, Text } from 'grommet';\nimport Web3 from 'web3';\nimport WalletLink from 'walletlink';\n\n\nclass AccountManagement extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.connectWallet = this.connectWallet.bind(this);\n        this.createCoinbaseWallet = this.createCoinbaseWallet.bind(this);\n        this.createUser = this.createUser.bind(this);\n        this.otpBest√§tigen = this.otpBest√§tigen.bind(this);\n        this.otpInputHandler = this.otpInputHandler.bind(this);\n        this.setState1 = this.setState1.bind(this);\n        this.setState6 = this.setState6.bind(this);\n        this.sign = this.sign.bind(this);\n        this.state = { otp: \"\", step: 0, Token: \"\" };\n        this.tokenHandler = this.tokenHandler.bind(this);\n        this.verifyAddress = this.verifyAddress.bind(this);\n        this.walletLogin = this.walletLogin.bind(this);\n        this.walletVerbinden = this.walletVerbinden.bind(this);\n    }\n\n    componentDidMount() {\n        //Ruft die Initialisierung auf, nachdem die Komponente erstellt wurde\n        this.init();\n    }\n\n    init() {\n        const APP_NAME = 'DHBW Bachelors Night Ticketing - 2020'\n        const APP_LOGO_URL = 'https://einfachtierisch.de/media/cache/article_teaser/cms/2015/09/Katze-lacht-in-die-Kamera-shutterstock-Foonia-76562038.jpg?595617'\n        const ETH_JSONRPC_URL = 'https://mainnet.infura.io/v3/efaece4f5f4443979063839c124c8171'\n        const CHAIN_ID = 1\n\n        this.setState({ walletAvailable: window.ethereum ? true : false });\n\n        if (!window.ethereum) {\n            //Initialisiere WalletLink\n            this.walletLink = new WalletLink({\n                appName: APP_NAME,\n                appLogoUrl: APP_LOGO_URL,\n                darkMode: false\n            })\n\n            window.ethereum = this.walletLink.makeWeb3Provider(ETH_JSONRPC_URL, CHAIN_ID);\n\n        }\n        this.setState({ connected: window.ethereum.selectedAddress ? true : false });\n\n        this.web3 = new Web3(window.ethereum);\n    }\n\n    otpInputHandler(event) {\n        this.setState({ otp: event.target.value });\n    }\n\n    tokenHandler(event) {\n        this.setState({ Token: event.target.value });\n    }\n\n    otpBest√§tigen() {\n        console.log(this.state.otp);\n        this.setState({ step: 2 });\n    }\n\n    createCoinbaseWallet() {\n        window.open('https://wallet.coinbase.com/#signup', '_blank');\n    }\n\n    async connectWallet() {\n        var accounts = await window.ethereum.enable().catch(this.displayError)\n        if (!accounts) return;\n\n        console.log(`User's address is ${accounts[0]}`);\n        this.setState({ connected: true });\n        this.setState({ step: 3 });\n    }\n\n    displayError() {\n        alert(\"Ups, das hat leider nicht funktioniert. Bitte versuche es erneut.\")\n    }\n\n    async verifyAddress() {\n        if (!window.ethereum) return this.displayError();\n        if (!window.ethereum.selectedAddress) return this.displayError();\n        var from = window.ethereum.selectedAddress;\n\n        var testsignatur = 'Drei3333';\n        var msg = this.web3.utils.stringToHex(testsignatur);\n\n        var params = [msg, from]\n        var method = 'personal_sign'\n\n        this.web3.currentProvider.send({\n            method,\n            params,\n            from,\n        }, (err, result) => {\n            if (err) return console.error(err)\n            if (result.error) return console.error(result.error)\n\n            console.log(result);\n\n            var recovered = this.web3.eth.accounts.recover(msg, result.result);\n            if (recovered.toLowerCase() === from.toLowerCase()) {\n                alert('Successfully ecRecovered signer as ' + from)\n                this.setState({ step: 4 })\n            } else {\n                alert('Failed to verify signer when comparing ' + recovered + ' to ' + from)\n            }\n        })\n    }\n\n    async createUser() {\n        const response = await fetch('http://localhost:3000/auth/otpcreate/' + this.state.otp, {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-cache',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ address: window.ethereum.selectedAddress })\n        }).catch(console.log);\n\n        if (!response) {\n            alert(\"Fehler\");\n            return;\n        }\n\n        const test = await response.json().catch(console.log);\n\n        console.log(test);\n        this.setState({ step: 5 });\n    }\n\n    async walletLogin() {\n\n        const response = await fetch(\"http://localhost:3000/auth/login\", {\n            method: 'POST',\n            mode: 'cors',\n            cache: 'no-cache',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ address: window.ethereum.selectedAddress })\n        }).catch(console.log);\n\n        if (!response) {\n            alert(\"Fehler!\");\n            return;\n        }\n\n        const data = await response.json().catch(console.log);\n        console.log(data);\n        if (!data.challenge) {\n            alert(\"Ihre aktuelle Ethereum Adresse ist uns nicht bekannt. M√∂glicherweise haben Sie noch kein Konto bei uns!\")\n        } else {\n            this.sign(data.challenge);\n        }\n    }\n\n    async sign(challengeString) {\n        if (!window.ethereum) return this.displayError();\n        if (!window.ethereum.selectedAddress) return this.displayError();\n        var from = window.ethereum.selectedAddress;\n\n        var text = challengeString;\n        var msg = this.web3.utils.stringToHex(text);\n\n        var params = [msg, from]\n        var method = 'personal_sign'\n\n        this.web3.currentProvider.send({\n            method,\n            params,\n            from,\n        }, async (err, result) => {\n            if (err) return console.error(err)\n            if (result.error) return console.error(result.error)\n\n            console.log(result); //result = Ergebnis des Blockchain-Aufrufs\n            //Mit dem Result weiterrechnen, um Token auszugeben\n            //Hier muss dann noch eine \"Login-Funktion\" ausgef√ºhrt werden.\n\n            const response = await fetch('http://localhost:3000/auth/chr/' + challengeString, {\n                method: 'POST',\n                mode: 'cors',\n                cache: 'no-cache',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ address: from, signature: result.result })\n            }).catch(console.log);\n\n            if (!response) {\n                alert(\"Fehler\");\n                return;\n            }\n            console.log(response)\n            //Nur Javascript Response Object\n            var jsResponse = await response.json().catch(console.log);\n\n            console.log(jsResponse)\n            if (!jsResponse) return;\n\n            this.setToken(jsResponse.token);\n\n        })\n    }\n\n    setState1() {\n        this.setState({ step: 1 });\n    }\n\n    setState6() {\n        this.setState({ step: 6 });\n    }\n\n    async walletVerbinden() {\n        var accounts = await window.ethereum.enable().catch(this.displayError)\n        if (!accounts) return;\n\n        console.log(`User's address is ${accounts[0]}`);\n        this.setState({ connected: true });\n        this.setState({ step: 6 });\n    }\n\n    setToken(Token) {\n        localStorage.setItem('Tokenwert', Token);\n        var value = localStorage.getItem('Tokenwert');\n        console.log(value);\n    }\n\n    render() {\n        return (\n            <Box className=\"AccountManagement\" pad=\"medium\" gap=\"small\">\n                {this.state.step === 0 &&\n                    <Box gap=\"small\">\n                        <Text>Klicke hier, um einen neuen Account anzulegen</Text>\n                        <Button label=\"Neuen Account anlegen\" gap=\"small\" onClick={this.setState1}></Button>\n                        <Text>Klicke hier, um dich mit einem bestehenden Account anzumelden</Text>\n                        <Button label=\"Mit bestehendem Account anmelden\" onClick={this.setState6}></Button>\n                    </Box>\n                }\n                {this.state.step === 1 &&\n                    <Box gap=\"small\">\n                        <Text>Bitte geben Sie das OneTime-Passwort ein und best√§tigen Sie die Eingabe</Text>\n                        <TextInput placeholder=\"OTP eingeben\" value={this.state.otp} onChange={this.otpInputHandler}></TextInput>\n                        <Button label=\"Eingabe best√§tigen\" onClick={this.otpBest√§tigen}></Button>\n                    </Box>\n                }\n                {this.state.step === 2 &&\n                    <Box classname=\"WalletSetup\" direction=\"column\" gap=\"small\">\n                        <h1>Wallet Setup</h1>\n                        <Text>Um Tickets zu erwerben ben√∂tigen Sie ein sogenanntes Wallet. Dieses ist vergleichbar mit Ihrer Geldb√∂rse zu der nur Sie Zugriff haben.</Text>\n                        {(!this.state.walletAvailable && !this.state.connected) &&\n                            <Box gap=\"small\">\n                                <Button label=\"Wallet auf dem Smartphone erstellen\" onClick={this.createCoinbaseWallet}></Button>\n                            </Box>\n                        }\n                        {(!this.state.connected) &&\n                            <Box gap=\"small\">\n                                <Text>Als N√§chstes ben√∂tigt unsere Plattform die Addresse Ihres Wallets. Bitte best√§tigen Sie daher die Verbindung mit Ihrem Wallet √ºber folgende Schaltfl√§che.Sie geben dadurch <b>nicht</b> Ihre Kontrolle √ºber das Wallet ab!\n                            Nach einem Klick auf den Button muss mit Coinbase Wallet der angezeigte QR-Code eingescannt werden, um das Wallet zu √ºberpr√ºfen.</Text>\n                                <Button label=\"Mit vorhandenem Wallet anmelden\" onClick={this.connectWallet}></Button>\n                            </Box>\n                        }\n                        {(this.state.walletAvailable && this.state.connected) &&\n                            //this.verifyAddress() <- @Robin: Das hier geht nicht!!!!\n                            <p>Test</p>\n                            //Was kommt genau hier rein?\n                        }\n                    </Box>\n                }\n                {this.state.step === 3 &&\n                    <Box gap=\"small\">\n                        <Text>Ein Wallet wurde erfolgreich verbunden. Das Wallet muss anhand einer Testsignatur √ºberpr√ºft werden.</Text>\n                        <Button label=\"F√ºhre Testsignatur aus\" onClick={this.verifyAddress}></Button>\n                    </Box>\n                }\n                {this.state.step === 4 &&\n                    <Box gap=\"small\">\n                        <Text>Klicke auf den Button, um einen Benutzer zu erstellen.</Text>\n                        <Button label=\"Benutzer erstellen\" onClick={this.createUser}></Button>\n                    </Box>\n                }\n                {this.state.step === 5 &&\n                    <Box gap=\"small\">\n                        <Text>Der Benutzer wurde erfolgreich angelegt. Klicke auf den Button, um zur Anmeldung zu gelangen. </Text>\n                        <Button label=\"Zur Anmeldung\" onClick={this.setState6}></Button>\n                    </Box>\n                }\n                {this.state.step === 6 &&\n                    <Box gap=\"small\">\n                        <h1>Anmeldung mit einem vorhandenen Wallet</h1>\n                        {(!this.state.walletAvailable && !this.state.connected) &&\n                            <Box gap=\"small\">\n                                <Text>Es ist kein Wallet verf√ºgbar. Bitte erstellen Sie ein Wallet und verbinden Sie dieses.</Text>\n                                <Button label=\"Wallet erstellen\" onClick={this.createCoinbaseWallet}></Button>\n                            </Box>\n                        }\n                        {(!this.state.connected) &&\n                            <Box gap=\"small\">\n                                <Text>Ihr Wallet scheint nicht verbunden zu sein. Bitte verbinden Sie das Wallet.</Text>\n                                <Button label=\"Wallet verbinden\" onClick={this.walletVerbinden}></Button>\n                            </Box>\n                        }\n                        {(this.state.connected) &&\n                            <Box gap=\"small\">\n                                <Text>Ein Wallet ist vorhanden und verbunden. Die Anmeldung ist m√∂glich.</Text>\n                                <Button label=\"Anmeldung starten\" onClick={this.walletLogin}></Button>\n                            </Box>\n                        }\n                    </Box>\n                }\n                {this.state.step === 888 &&\n                    <Box gap=\"small\">\n                        <h1>Willkommen bei Barry's Testgel√§nde</h1>\n                        <TextInput placeholder=\"Test-Token eingeben\" value={this.state.Token} onChange={this.tokenHandler}></TextInput>\n                        <Button label=\"Test\" onClick={() => { this.setToken(this.state.Token) }}></Button>\n                    </Box>\n                }\n            </Box>\n        );\n    }\n}\nexport default AccountManagement;","import React from 'react';\nimport './TicketOverview.css';\nimport { Box, Text, Accordion, AccordionPanel } from 'grommet';\n\nclass BestellungsItem extends React.Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        var ticketsForBooking = [];\n        this.props.tickets.forEach((ticket) => {\n            ticketsForBooking.push(\n                <Box key={ticket.identifier} pad=\"small\">\n                    <span>Ticket Identifier: {ticket.identifier}</span>\n                    <span>Nachname: {ticket.surname}</span>\n                    <span>Vorname: {ticket.forename}/</span>\n                    <span>Ticket Typ: {ticket.ticketType}</span>\n                </Box>\n            )\n        });\n        var buchung = this.props.booking;\n        var accPanelLabel = \"Buchungs-ID: \" + buchung.id + \" Account: \" + buchung.user + \" Buchungsdatum: \" + buchung.dateBooked + \" Bezahldatum: \" + buchung.datePaid;\n        return (\n            <AccordionPanel label={accPanelLabel}>\n                <Text margin=\"small\">Folgende Tickets wurden gebucht:</Text>\n                {ticketsForBooking}\n            </AccordionPanel>\n        )\n    }\n\n}\n\nclass BookingOverview extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.loadListHandler = this.loadListHandler.bind(this);\n        this.loadTicketsHandler = this.loadTicketsHandler.bind(this);\n        this.state = { buchungen: [], tickets: [] };\n    }\n\n    componentDidMount() {\n        this.loadListHandler();\n    }\n\n    async loadListHandler() {\n        this.setState({ loading: true });\n        var response = await fetch(\"http://localhost:3000/api/v1/users/0x1/bookings\", {\n            method: 'GET', // *GET, POST, PUT, DELETE, etc.\n            mode: 'cors', // no-cors, *cors, same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': 'Bearer 43059960ead1db519cbbed4aa934462808262fa6204daefabcab4b0b38b667d61828556556e4b9e80b6a91e9990fc8704bbf399cdafd41b06ddc0c31a500accb94b96fa096bf8789c7c582f9e5df0ead8f23ef77a9b045ccbb78a60cd2401592e79b8c396cd4520297cfb0603011a7f373f9dbbc6a37527bd160b5e754850cbf8779a4c5049e816a9b9bee268e110baf53e901e80aa8df89d6a07b92cf33b581294bedc1b8da2c9a583845b13766f4c89abc9ac3466b69748a1ba0bf6a80a8c2b6aa6ec084c88c2cc4d212470089dbb9e4bce056c90e8a0ebaa5b9e563c80d20ac173b791769eac9d29c509810086f1700c7cec0071a03bb7aed67fec7215979',\n            }\n        }).catch(console.log)\n        if (!response) return\n        console.log(response)\n        var data = await response.json().catch(console.log)\n        if (!data) return;\n        this.setState({ buchungen: data, loading: false })\n    }\n\n    async loadTicketsHandler(indexOfBooking) {\n        if(indexOfBooking === undefined) return;\n\n        let bookingId = this.state.buchungen[indexOfBooking].id;\n        let ticketsLoaded = this.state.tickets.findIndex((ticket) => {\n            return ticket.booking === bookingId\n        })\n         \n        if(ticketsLoaded !== -1) return;\n\n        var response = await fetch(\"http://localhost:3000/api/v1/bookings/\" + bookingId + \"/ticketsBooked\", {\n            method: 'GET', // *GET, POST, PUT, DELETE, etc.\n            mode: 'cors', // no-cors, *cors, same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': 'Bearer 43059960ead1db519cbbed4aa934462808262fa6204daefabcab4b0b38b667d61828556556e4b9e80b6a91e9990fc8704bbf399cdafd41b06ddc0c31a500accb94b96fa096bf8789c7c582f9e5df0ead8f23ef77a9b045ccbb78a60cd2401592e79b8c396cd4520297cfb0603011a7f373f9dbbc6a37527bd160b5e754850cbf8779a4c5049e816a9b9bee268e110baf53e901e80aa8df89d6a07b92cf33b581294bedc1b8da2c9a583845b13766f4c89abc9ac3466b69748a1ba0bf6a80a8c2b6aa6ec084c88c2cc4d212470089dbb9e4bce056c90e8a0ebaa5b9e563c80d20ac173b791769eac9d29c509810086f1700c7cec0071a03bb7aed67fec7215979',\n            }\n        }).catch(console.log)\n\n        if (!response) return\n\n        var data = await response.json().catch(console.log)\n\n        if (!data) return\n\n        var kopieTickets = this.state.tickets;\n        kopieTickets = kopieTickets.concat(data);\n\n        this.setState({ tickets: kopieTickets });\n    }\n\n    render() {\n        var buchungen = [];\n        this.state.buchungen.forEach((buchung) => {\n            var filteredTickets = this.state.tickets.filter((ticket) => {\n                return ticket.booking === buchung.id\n            })\n            buchungen.push(<BestellungsItem key={buchung.id} booking={buchung} tickets={filteredTickets}></BestellungsItem>)\n        });\n\n        return (\n            <Box className=\"BookingOverview\" direction=\"column\" gap=\"medium\" pad=\"medium\">\n                <Box>\n                    {this.state.loading && <p className=\"loader\"></p>}\n                    <Accordion onActive={(activeItems) => { this.loadTicketsHandler(activeItems[0]) }}>\n                        {buchungen}\n                    </Accordion>\n                </Box>\n            </Box>\n        );\n    }\n}\n\nexport default BookingOverview;\n","import React from 'react';\n\nimport { Box, Button, Text } from 'grommet';\n\nclass TicketBestellung extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.WindowAbsolventTicket = this.WindowAbsolventTicket.bind(this);\n        this.WindowGuestTicket = this.WindowGuestTicket.bind(this);\n        this.WindowParkTicket = this.WindowParkTicket.bind(this);\n        this.ToOverview = this.ToOverview.bind(this);\n        this.ToPayment = this.ToPayment.bind(this);\n    \n        this.state = { \n            guestcount: 0, \n            parkcount: 0, \n            step: 0 \n        };        \n    }\n\n\n\n    WindowAbsolventTicket(){\n        this.setState({ step: 0})\n    }\n    \n\n\n    WindowGuestTicket(){\n        //Wechselt die Ansicht zu den G√§steTickets\n        this.setState({ step: 1 })\n    }\n    WindowParkTicket(){\n        this.setState({ step: 2})\n    }\n    ToOverview(){\n        this.setState({ step: 3})\n    }\n    ToPayment(){\n        this.setState({ step: 4})\n    }\n\n\n    //Funktion f√ºr die Counter\n    increment = (property) => {\n        if (property === \"guest\" && this.state.guestcount < 2){\n            this.setState({guestcount: this.state.guestcount + 1});\n        }\n        else if (property === \"park\" && this.state.parkcount < 3){\n            this.setState({parkcount: this.state.parkcount + 1});\n        }\n    }\n    decrement = (property) => {\n        if (property === \"guest\" && this.state.guestcount > 0){\n            this.setState({guestcount: this.state.guestcount - 1});\n        }\n        else if (property ===\"park\" && this.state.parkcount > 0){\n            this.setState({parkcount: this.state.parkcount - 1});\n        }\n    }\n\n    render() {\n        return (\n            <Box className=\"TicketBestellung\" direction=\"column\" gap=\"medium\" pad=\"medium\">\n               \n               {this.state.step === 0 &&\n                <Box gap=\"small\">\n                    Klicke hier, um ein Absolvententicket zu kaufen.\n                    <Button label=\" Ein Absolventen Ticket kaufen\" onClick={this.WindowGuestTicket} gap=\"small\"></Button>\n                   \n                </Box>\n                }\n\n                {this.state.step === 1 &&\n                <Box gap=\"small\">\n                    <Text>Bitte geben sie an, wie viele G√§ste Sie mitnehmen wollen.</Text>\n                    <Button onClick={() => this.increment(\"guest\")} className=\"guestcount\" label=\"+\"></Button>\n                    <Button onClick={() => this.decrement(\"guest\")} className=\"guestcount\" label=\"-\"></Button>\n                    <h2>{this.state.guestcount}</h2>\n\n                    <Button onClick={this.WindowAbsolventTicket} label=\"Zur√ºck\"></Button>\n                    <Button onClick={this.WindowParkTicket} label=\"Weiter\"></Button>\n                </Box>\n                }\n\n                {this.state.step === 2 &&\n                <Box gap=\"small\">\n                    <Text>Bitte geben sie an, wie viele Parktickets Sie ben√∂tigen.</Text>   \n\n                    <Button onClick={() => this.increment(\"park\")} className=\"parkcount\" label=\"+\"></Button>\n                    <Button onClick={() => this.decrement(\"park\")} className=\"parkcount\" label=\"-\"></Button>\n                    <h2>{this.state.parkcount}</h2>\n                    <Button onClick={this.WindowGuestTicket} label=\"Zur√ºck\"></Button>\n                    <Button onClick={this.ToOverview} label=\"Weiter\"></Button>\n                </Box>\n                }\n\n                {this.state.step === 3 &&\n                <Box gap=\"small\">\n                    <Text>Sie haben folgendes bestellt: <br/>\n                    Absolvententicket 1 <br/> \n                    G√§steticket {this.state.guestcount} <br/>\n                    Parkticket {this.state.parkcount}\n                    </Text>\n                    <Button onClick={this.WindowParkTicket} label=\"Zur√ºck\"></Button>\n                    <Button onClick={this.ToPayment}  label=\"Zahlungspflichtig bestellen\"></Button>\n                </Box>\n                }\n                {this.state.step === 4 &&\n                <Box gap=\"small\">\n                    <Text>Sie haben folgende Tickets Zahlungspflichtig bestellt.  <br/>\n                    Bitte √ºberweisen Sie folgenden Betrag auf das Konto: XXXXYYYYZZZZ.<br/>\n                    Geben Sie ihren Namen als Verwendungszweck an.<br/>\n                    Nach Rechnungseingang erhalten Sie Ihre Tickets an ihr Wallet gesendet.<br/>\n                    </Text>   \n                    <Text>Sie haben folgendes bestellt: <br/>\n                    Absolvententicket 1 <br/> \n                    G√§steticket {this.state.guestcount} <br/>\n                    Parkticket {this.state.parkcount}\n                    </Text>\n                </Box>\n                }\n\n\n            </Box>\n        );\n    }\n}\n\nexport default TicketBestellung;\n","import React from 'react';\nimport { Menu, Header, Box } from 'grommet';\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport WalletSetup from './Components/WalletSetup';\nimport UserMainMenu from './Components/UserMainMenu';\nimport TicketOverview from './Components/TicketOverview';\nimport AccountManagement from './Components/AccountManagement';\nimport BookingOverview from './Components/BookingOverview';\nimport TicketBestellung from './Components/TicketBestellung';\n\nclass Ticketshop extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n    render() {\n        return (\n            <Box className=\"Guest\">\n                <Header background=\"brand\" justify=\"between\" pad=\"10px\">\n                    <Link to=\"/guest\">Home</Link>\n                    <Menu label=\"Account\" items={[{ label: 'Logout' }]} />\n                </Header>\n                <Switch>\n                    <Route path=\"/guest/ticketbestellen\">\n                        <TicketBestellung></TicketBestellung>\n                    </Route>\n                    <Route path=\"/guest/tickets/\">\n                        <TicketOverview></TicketOverview>\n                    </Route>\n                    <Route path=\"/guest/setup\">\n                        <AccountManagement></AccountManagement>\n                    </Route>\n                    <Route path=\"/guest/demosetup\">\n                        <WalletSetup></WalletSetup>\n                    </Route>\n                    <Route path=\"/guest/bestellungsuebersicht\">\n                        <BookingOverview></BookingOverview>\n                    </Route>\n                    <Route path=\"/guest/\">\n                        <UserMainMenu></UserMainMenu>\n                    </Route>\n                </Switch>\n            </Box>\n        );\n    }\n}\n\nexport default Ticketshop;\n","import React from 'react';\nimport jsQR from 'jsqr';\nimport { Box, Button } from 'grommet';\n\nclass QRScanner extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.video = React.createRef();\n    this.canvasElement = React.createRef();\n    this.startScan = this.startScan.bind(this);\n    this.tick = this.tick.bind(this);\n  }\n\n  componentWillUnmount(){\n    this.stopScan();\n  }\n\n  tick() {\n    if (!this.video || !this.video.current) return;\n    if (this.video.current.readyState === this.video.current.HAVE_ENOUGH_DATA) {\n      this.canvasElement.current.height = 320;\n      this.canvasElement.current.width = 320;\n      this.canvas.drawImage(this.video.current, 0, 0, this.canvasElement.current.width, this.canvasElement.current.height);\n      let imageData = this.canvas.getImageData(0, 0, this.canvasElement.current.width, this.canvasElement.current.height);\n      let code = jsQR(imageData.data, imageData.width, imageData.height, { inversionAttempts: \"dontInvert\" });\n      if (code) {\n        // Selecting the right search pattern\n        // This should be defined via props: contentType\n        switch (this.props.contentType) {\n          case 'ETHEREUM_ADDRESS':\n            let match = code.data.match(/(?:ethereum:)(?<address>0x[A-Za-z\\d]*)/);\n            if (match && match.groups.address) {\n              this.stopScan();\n              this.props.onDone(match.groups.address);\n              return;\n            }\n            break;\n          case 'ETHEREUM_SIGNATURE':\n            // TODO: enter regex\n            break;\n          case 'IP_ADDRESS':\n            // TODO: enter regex\n            break;\n          case 'JSON_DATA':\n            // TODO: enter regex\n            break;\n          default:\n            this.stopScan();\n            this.props.onDone(code.data);\n            return;\n        }\n      }\n    }\n    requestAnimationFrame(this.tick);\n  }\n\n  startScan() {\n    if (!navigator.mediaDevices) return alert('Der Browser unterst√ºtzt diese Funktion nicht.');\n    const constraints = { video: { facingMode: \"environment\", width: 320, height: 320 } }\n    navigator.mediaDevices.getUserMedia(constraints)\n      .then((stream) => {\n        /* use the stream */\n        this.canvas = this.canvasElement.current.getContext(\"2d\");\n        this.video.current.srcObject = stream;\n        this.video.current.setAttribute('playsinline', true);\n        this.video.current.play();\n        requestAnimationFrame(this.tick);\n        this.setState({ isScanning: true });\n      })\n      .catch(function (err) {\n        console.error(err);\n        /* handle the error */\n        alert('Sorry, Kamera-Stream konnte nicht geladen werden.');\n      });\n  }\n\n  stopScan() {\n    if (!this.video || !this.video.current || !this.video.current.srcObject) return;\n    let videoTracks = this.video.current.srcObject.getVideoTracks();\n    videoTracks[0].stop();\n    this.setState({ isScanning: false });\n  }\n\n  render() {\n    return (\n      <Box className=\"QRScanner\">\n        <div>\n          <canvas ref={this.canvasElement} hidden={!this.state.isScanning} />\n          <video ref={this.video} hidden />\n        </div>\n        {!this.state.isScanning && <Button label={this.props.label || \"Scan\"} onClick={this.startScan}></Button>}\n      </Box>\n    );\n  }\n}\n\nexport default QRScanner;\n","import React from 'react';\nimport { Button } from 'grommet';\nimport './Dialog.css';\n\nclass Dialog extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { };\n    }\n\n    render() {\n        return (\n            <div className=\"dialog\">\n                <div className=\"dialog-background-box\"></div>\n                <div className=\"dialog-center\">\n                    <div className=\"dialog-content\">\n                        <div className=\"dialog-header\">\n                            <h1>{this.props.title}</h1>\n                            <Button className=\"abort\" onClick={this.props.onAbort}>X</Button>\n                        </div>\n                        <div className=\"dialog-body\">\n                            {this.props.children}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Dialog;\n","// eslint-disable-next-line\nimport adapter from 'webrtc-adapter';\n\n/**\n * Represents a ticket reader on a remote device.\n * Use this class to connect to a RemoteTicketReader.\n */\nclass TicketReader {\n\n    constructor() {\n        this._iceCandidatesHandler = this._iceCandidatesHandler.bind(this);\n        this._dataChannelOpenHandler = this._dataChannelOpenHandler.bind(this);\n        this._receiveChannelHandler = this._receiveChannelHandler.bind(this);\n        this._dataChannelClosedHandler = this._dataChannelClosedHandler.bind(this);\n        this._connectionChangeHandler = this._connectionChangeHandler.bind(this);\n        this._generateAnswer = this._generateAnswer.bind(this);\n\n        // Map for requests sent via datachannel. Usage is: uuid =>  { resolve: resolve, reject: reject }\n        this.requestMap = new Map();\n\n        // Collection of all local icecandidates\n        this.icecandidates = [];\n\n        // Collection for all icecandidates that the master will provide\n        this.remoteICECandidates = [];\n\n        /**\n         * This eventlistener is called when the \n         * ticket reader changed its connection state. Please implement externally.\n         * @param {String} connectionState - State of the connection.\n         */\n        this.onConnectionChanged = function (connectionState) { };\n\n        // Finally prepare connection\n        this._initConnection();\n    }\n\n    /**\n     * Method that initializes the peer connection.\n     */\n    async _initConnection() {\n        const servers = null;\n\n        this.localPeerConnection = new RTCPeerConnection(servers);\n        this.localPeerConnection.addEventListener('icecandidate', this._iceCandidatesHandler);\n        this.localPeerConnection.addEventListener('connectionstatechange', this._connectionChangeHandler);\n        this.localPeerConnection.addEventListener('datachannel', this._receiveChannelHandler);\n    }\n\n    _iceCandidatesHandler(event) {\n        this.icecandidates.push(event.candidate);\n        if (this.answer && !this.qrcode) {\n            setTimeout(this._generateAnswer, 200); // Set a delay to collect some more icecandidates\n        }\n    }\n\n    _connectionChangeHandler(event) {\n        console.debug(event);\n        let connectionState = event.target.connectionState;\n\n        switch (connectionState) {\n            case \"connected\":\n                // The connection has become fully connected\n                break;\n            case \"disconnected\":\n                break;\n            case \"failed\":\n                // One or more transports has terminated unexpectedly or in an error\n                break;\n            case \"closed\":\n                // The connection has been closed\n                break;\n            default:\n                break;\n        }\n\n        this.onConnectionChanged(connectionState);\n\n    }\n\n    _dataChannelOpenHandler(event) {\n        console.debug(event);\n        this.onReady();\n    }\n\n    _dataChannelClosedHandler(event) {\n        console.debug(event);\n    }\n\n    _messageHandler(event) {\n        console.debug(event.data);\n        alert(event.data);\n    }\n\n    _receiveChannelHandler(event) {\n        this.dataChannel = event.channel;\n        this.dataChannel.addEventListener('message', this._messageHandler);\n        this.dataChannel.addEventListener('open', this._dataChannelOpenHandler);\n        this.dataChannel.addEventListener('close', this._dataChannelClosedHandler);\n    }\n\n    _createUUID() {\n        var dt = new Date().getTime();\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n            var r = (dt + Math.random() * 16) % 16 | 0;\n            dt = Math.floor(dt / 16);\n            return (c === 'x' ? r : (r & 0x3 & 0x8)).toString(16);\n        });\n        return uuid;\n    }\n\n    readTicketRemote(identifier) {\n        return new Promise((resolve, reject) => {\n            let reqId = this._createUUID();\n            this.requestMap.set(reqId, { resolve: resolve, reject: reject });\n            const msg = {\n                type: \"Request\",\n                reqId: reqId,\n                context: \"ticketMirror\",\n                method: \"getTicket\",\n                params: [identifier]\n            }\n            try {\n                this.dataChannel.send(JSON.stringify(msg));\n            } catch (e) {\n                reject(e);\n            }\n        });\n    }\n\n    obliterateTicketRemote(identifier, signature) {\n        return new Promise((resolve, reject) => {\n            let reqId = this._createUUID();\n            this.requestMap.set(reqId, { resolve: resolve, reject: reject });\n            const msg = {\n                type: \"Request\",\n                reqId: reqId,\n                context: \"ticketMirror\",\n                method: \"obliterateTicket\",\n                params: [identifier, signature]\n            }\n            try {\n                this.dataChannel.send(JSON.stringify(msg));\n            } catch (e) {\n                reject(e);\n            }\n        });\n    }\n\n    /**\n     * Method to set the config received from the master.\n     * @param {Object} config - A JS Object containing the offer and ice candidates from the master. \n     */\n    async setMasterConfig(config) {\n        // Setting remote description\n        await this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(config.offer)).catch(console.error);\n\n        // Adding ice candidates from remote\n        config.candidates.forEach((candidate) => {\n            this.localPeerConnection.addIceCandidate(candidate).catch(console.error);\n            this.remoteICECandidates.push(candidate);\n        });\n\n        // Creating answer\n        this.answer = await this.localPeerConnection.createAnswer().catch(console.error);\n        await this.localPeerConnection.setLocalDescription(this.answer).catch(console.error);\n    }\n\n    _generateAnswer(){\n        let data = { answer: this.answer, candidates: this.icecandidates };\n        this.onAnswer(data);\n    }\n\n    /**\n     * Dumps all settings to JSON. Use this method to restore a broken session.\n     */\n    toJSON() {\n        let lstore = {\n            localDescription: this.localPeerConnection.currentLocalDescription,\n            remoteDescription: this.localPeerConnection.currentRemoteDescription,\n            candidates: this.remoteICECandidates\n        }\n        return JSON.stringify(lstore);\n    }\n\n}\n\nexport default TicketReader;","import React from 'react';\nimport { Box, Button } from 'grommet';\nimport { Switch, Route } from \"react-router-dom\";\nimport QRScanner from '../Utilities/Components/QRScanner';\nimport Dialog from '../Utilities/Components/Dialog';\n\nimport TicketReader from '../EventManagement/Classes/TicketReader';\n\nimport QRCode from 'qrcode';\nimport pako from 'pako';\n\nclass EntranceManagement extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { connected: null };\n        this.connectTicketReader = this.connectTicketReader.bind(this);\n        this.scanDoneHandler = this.scanDoneHandler.bind(this);\n        /**\n         * @type {TicketReader}\n         */\n        this.ticketReader = null;\n    }\n\n    connectTicketReader() {\n        let ticketReader = new TicketReader();\n        ticketReader.onReady = () => {\n            this.ticketReader = this.state.connectTR;\n            this.setState({ connectTR: null });\n        };\n        ticketReader.onConnectionChanged = (connectionState) => {\n            switch (connectionState) {\n                case \"connected\":\n                    // The connection has become fully connected\n                    this.setState({ connected: connectionState });\n                    break;\n                case \"disconnected\":\n                    this.setState({ connected: connectionState });\n                    break;\n                case 'failed':\n                    this.setState({ connected: connectionState });\n                    break;\n                case \"closed\":\n                    // The connection has been closed\n                    this.setState({ connected: connectionState });\n                    break;\n                default:\n                    break;\n            }\n        };\n        ticketReader.onAnswer = async (config) => {\n            // Compress data\n            let binaryString = pako.deflate(JSON.stringify(config), { level: 9, to: \"string\" });\n\n            // Create QR Code\n            let url = await QRCode.toDataURL(binaryString).catch(console.error);\n            this.setState({ TRQRCode: url, connectTRStep: 1 });\n        };\n        this.setState({ connectTR: ticketReader, connectTRStep: 0 });\n    }\n\n    scanDoneHandler(binaryString) {\n        let obj = JSON.parse(pako.inflate(binaryString, { to: 'string' }));\n        this.state.connectTR.setMasterConfig(obj);\n    }\n\n    render() {\n        return (\n            <Box className=\"EntranceManagement\" pad=\"medium\">\n                {!this.state.connected &&\n                    <Box>\n                        <p>Wenn Sie dieses Ger√§t als Ticket Leser verwenden m√∂chten, m√ºssen Sie es erst mit dem Event-Manager verbinden.</p>\n                        <p>Bitte stellen Sie sicher, dass dieses Ger√§t mit dem selben lokalen Netzwerk, wie der Event-Manager verbunden ist.</p>\n                        <Button onClick={this.connectTicketReader} label=\"Ticket Reader Aktivieren\"></Button>\n                        {this.state.connectTR &&\n                            <Dialog title=\"Als Ticket Reader verbinden\" onAbort={() => { this.setState({ connectTR: null }); }}>\n                                {this.state.connectTRStep === 0 &&\n                                    <div>\n                                        <div className=\"scanner\">\n                                            <QRScanner onDone={this.scanDoneHandler} label=\"Scanvorgang starten\"></QRScanner>\n                                        </div>\n                                        <div className=\"description\">\n                                            <p>Bitte den Code des Initiators scannen</p>\n                                        </div>\n                                    </div>\n                                }\n                                {this.state.connectTRStep === 1 &&\n                                    <div>\n                                        <div className=\"qrcode\">\n                                            {!this.state.TRQRCode && <div className=\"loader\">Loading...</div>}\n                                            {this.state.TRQRCode && <img src={this.state.TRQRCode} width=\"100%\" alt=\"Ein QR-Code sollte hier angezeigt werden.\" />}\n                                        </div>\n                                        <div className=\"description\">\n                                            <p>Bitte nun mit dem Initiator Ger√§t scannen</p>\n                                        </div>\n                                    </div>\n                                }\n                            </Dialog>\n                        }\n                    </Box>\n                }\n                {this.state.connected === 'connected' &&\n                    <Switch>\n                        <Route path=\"/entrance/\">\n                            <p>Wunderbar, Sie sind verbunden...</p>\n                            <p>In Zukunft sollten hier Funktionen zum Ticket-Scan stehen...</p>\n                            <Button label=\"Lese ein Beispiel Ticket\" onClick={() => { this.ticketReader.readTicketRemote(\"2537f4c1-2bfa-416f-9098-9b61fe4bb59d\") }}></Button>\n                            <Button label=\"Entwerte Ticket\" onClick={() => { this.ticketReader.obliterateTicketRemote(123, \"signature\") }}></Button>\n                            <Button label=\"Beispiel Funktion 3\"></Button>\n                        </Route>\n                    </Switch>\n                }\n                {this.state.connected === 'disconnected' &&\n                    <Switch>\n                        <Route path=\"/entrance/\">\n                            <p>Die Verbindung wurde unterbrochen!</p>\n                            <p>Bitte warten Sie einen Moment...</p>\n                        </Route>\n                    </Switch>\n                }\n                {this.state.connected === 'failed' &&\n                    <Switch>\n                        <Route path=\"/entrance/\">\n                            <p>Die Verbindung wurde unterbrochen!</p>\n                            <p>Bitte aktivieren Sie den Reader erneut.</p>\n                            <Button onClick={() => { this.setState({ connected: null }); this.connectTicketReader() }} label=\"Ticket Reader Aktivieren\"></Button>\n                        </Route>\n                    </Switch>\n                }\n            </Box>\n        );\n    }\n}\n\nexport default EntranceManagement;\n","/**\n * Class for basic operations and preparations for the local caching of ticket data\n */\nclass LocalTicketMirror {\n\n    constructor() {\n\n        // Binding \"this\" to methods that get called from other contexts\n        this._createDB = this._createDB.bind(this);\n        this.dumpTicketMirror = this.dumpTicketMirror.bind(this);\n        this.getTicketList = this.getTicketList.bind(this);\n\n        // Check if Indexed DB (IDB) technology is supported in the current browser\n        if (!window.indexedDB) {\n            throw Error(\"Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.\");\n        }\n\n        // Collection for DB Requests that happen before initialization of the DB connection instance (this.db)\n        this.waitingForIDBReadyQueue = [];\n\n        // Finally initializing DB connection\n        this._initDB();\n    }\n\n    /**\n     * Initializes connection to IDB and saves the connection\n     * instance to \"this.db\"\n     */\n    _initDB() {\n        console.debug('Initializing IDB Connection');\n        var request = window.indexedDB.open(\"TicketMirror\", 1);\n\n        request.addEventListener('upgradeneeded', this._createDB);\n        request.addEventListener('success', (ev) => {\n            console.debug('IDB Connection established');\n            this.db = ev.target.result;\n            this.waitingForIDBReadyQueue.forEach((resolve) => {\n                resolve(this.db);\n            });\n        });\n        request.addEventListener('error', (ev) => {\n            console.error(\"Database error: \" + ev.target.errorCode);\n        });\n    }\n\n    /**\n     * Eventhandler for cases where the IDB has to be created / initialized\n     * Only for internal use.\n     * @param {Event} event \n     */\n    _createDB(event) {\n        this.db = event.target.result;\n\n        // Create an objectStore for this database\n        this.db.createObjectStore(\"tickets\", { keyPath: \"identifier\" });\n    }\n\n    /**\n     * Getter for the IDB Connection. Only for internal use.\n     * @returns Returns a Promis that is resolved with a IDBConnection when it is ready.\n     */\n    _getIDB() {\n        return new Promise((resolve) => {\n            if (this.db) {\n                resolve(this.db);\n            } else {\n                this.waitingForIDBReadyQueue.push(resolve);\n            }\n        });\n    }\n\n    /**\n     * Method that writes data to the IDB datastore \"tickets\"\n     */\n    async dumpTicketMirror() {\n        var db = await this._getIDB().catch(console.error);\n        if (!db) return;\n\n        var objectStore = db.transaction(\"tickets\", \"readwrite\").objectStore(\"tickets\");\n\n        // TODO: Fetch real data from the blockchain when online\n        const dummyData = [{\n            \"identifier\": \"ca6c9409-0ec9-42fb-9ca7-d42a74642d7e\",\n            \"isValid\": true,\n            \"isUsed\": false,\n            \"ticketType\": \"Parken\"\n        }, {\n            \"identifier\": \"cea4b540-63a4-4abd-9a9a-499bb3879b8c\",\n            \"isValid\": false,\n            \"isUsed\": true,\n            \"ticketType\": \"Begleitperson\"\n        }, {\n            \"identifier\": \"2537f4c1-2bfa-416f-9098-9b61fe4bb59d\",\n            \"isValid\": true,\n            \"isUsed\": false,\n            \"ticketType\": \"Begleitperson\"\n        }, {\n            \"identifier\": \"c3573a44-f9e8-4772-bf80-57d1d07239c8\",\n            \"isValid\": true,\n            \"isUsed\": true,\n            \"ticketType\": \"Begleitperson\"\n        }, {\n            \"identifier\": \"5506d14d-8090-411a-897c-3f6c898ec8d2\",\n            \"isValid\": true,\n            \"isUsed\": true,\n            \"ticketType\": \"Begleitperson\"\n        }]\n\n        dummyData.forEach((item) => {\n            objectStore.add(item);\n        });\n\n    }\n\n    /**\n     * A local representation of a ticket joined out of the private db and the smart contract\n     * @typedef {Object} Ticket\n     * @property {String} identifier\n     * @property {Boolean} isValid\n     * @property {Boolean} isUsed\n     * @property {String} ticketType \n     */\n\n    /**\n     * For frontend purposes to get all tickets out of the db.\n     * @returns {Ticket[]} Returns an array of tickets\n     */\n    getTicketList() {\n        return new Promise(async (resolve, reject) => {\n            var db = await this._getIDB().catch(console.error);\n            if (!db) return reject();\n            var objectStore = db.transaction(\"tickets\", \"readonly\").objectStore(\"tickets\");\n            var request = objectStore.getAll();\n            request.onerror = reject;\n            request.onsuccess = function (event) {\n                var tickets = event.target.result;\n                return resolve(tickets);\n            };\n        });\n    }\n\n    /**\n     * Fetches a ticket by its identifier\n     * @param {String} identifier - Unique identifier of the ticket\n     * @returns {Ticket} Returns a promise that resolves as the ticket\n     */\n    getTicket(identifier) {\n        return new Promise(async (resolve, reject) => {\n            var db = await this._getIDB().catch(console.error);\n            if (!db) return reject();\n            var objectStore = db.transaction(\"tickets\", \"readonly\").objectStore(\"tickets\");\n            var request = objectStore.get(identifier);\n            request.onerror = reject;\n            request.onsuccess = function (event) {\n                var ticket = event.target.result;\n                if (!ticket) return reject(\"Ticket does not exist.\");\n                return resolve(ticket);\n            };\n        });\n    }\n\n    /**\n     * Obliterates a ticket selected by its unique identifer.\n     * The signature of the owner is checked to validate the persons identity.\n     * @param {String} identifier - Unique identifier of the ticket\n     * @param {String} signature - Specific signature of the owner that was used to generate the identifer\n     * @returns {Promise} Returns a promise that is resolved with null or rejected with an error message\n     */\n    obliterateTicket(identifier, signature) {\n        return new Promise(async (resolve, reject) => {\n            var db = await this._getIDB().catch(console.error);\n            if (!db) return reject();\n            var objectStore = db.transaction(\"tickets\", \"readwrite\").objectStore(\"tickets\");\n            var request = objectStore.get(identifier);\n            request.onerror = reject;\n            request.onsuccess = (event) => {\n                // Get the old value that we want to update\n                var ticket = event.target.result;\n                if (!ticket) return reject(\"Ticket does not exist.\");\n\n                // TODO: Check signature and identifier hash\n\n                // Check validity and if it was not used before\n                if (!ticket.isValid) return reject(\"Ticket is not valid.\");\n                if (ticket.isUsed) return reject(\"Ticket was already used.\");\n\n                ticket.isUsed = true;\n\n                // Put this updated object back into the database.\n                var requestUpdate = objectStore.put(ticket);\n                requestUpdate.onerror = reject;\n                requestUpdate.onsuccess = resolve;\n            };\n        });\n    }\n\n}\n\nexport default LocalTicketMirror;","import React from 'react';\nimport { Box, Button } from 'grommet';\n\n// eslint-disable-next-line\nimport { LocalTicketMirror } from '../Classes/LocalTicketMirror';\n\n\nclass IndexedDBExample extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { tickets: [] };\n        this.handleDumpMirror = this.handleDumpMirror.bind(this);\n        this.showTickets = this.showTickets.bind(this);\n        if (!this.props.localTicketMirror) throw new Error(\"Missing LocalTicketMirror\");\n        this.showTickets();\n    }\n\n    handleDumpMirror() {\n        /**\n         * @type LocalTicketMirror\n         */\n        let ltm = this.props.localTicketMirror;\n        ltm.dumpTicketMirror();\n        this.showTickets();\n    }\n\n    async showTickets() {\n        // Reading out of idb all tickets\n        /**\n         * @type LocalTicketMirror\n         */\n        let ltm = this.props.localTicketMirror;\n        let tickets = await ltm.getTicketList().catch(console.error);\n        if (!tickets) return;\n\n        this.setState({ tickets });\n    }\n\n    render() {\n        let tickets = this.state.tickets.map((ticket) => {\n            return <li key={ticket.identifier}>{ticket.isValid && 'Valid'}{!ticket.isValid && 'Not Valid'} -  {ticket.isUsed && 'Used'}{!ticket.isUsed && 'Not Used'} - {ticket.ticketType}</li>\n        });\n\n        return (\n            <Box className=\"IndexedDBExample\" pad=\"medium\">\n                <ul>\n                    {tickets}\n                </ul>\n                <Button label=\"Dump Mirror\" onClick={this.handleDumpMirror}></Button>\n            </Box>\n        );\n    }\n}\n\nexport default IndexedDBExample;\n","// eslint-disable-next-line\nimport adapter from 'webrtc-adapter';\n\n/**\n * Represents an object holder for diverse connectio objects to the ticket reader.\n */\nclass RemoteTicketReader {\n\n    constructor() {\n        // Binding \"this\" to the event handlers\n        this.iceCandidatesHandler = this.iceCandidatesHandler.bind(this);\n        this.dataChannelOpenHandler = this.dataChannelOpenHandler.bind(this);\n        this.generateOfferCode = this.generateOfferCode.bind(this);\n        this.dataChannelClosedHandler = this.dataChannelClosedHandler.bind(this);\n        this.connectionChangeHandler = this.connectionChangeHandler.bind(this);\n        this.setTicketReaderConfig = this.setTicketReaderConfig.bind(this);\n        this.messageHandler = this.messageHandler.bind(this);\n\n        // Defining a unique id for this instance\n        this.uuid = this.createUUID();\n\n        // Initializing empty event listeners to prevent \"undefined\" errors\n\n        /**\n         * @public\n         * This eventlistener is called when the \n         * ticket reader changed its connection state. Please implement externally.\n         * @param {String} connectionState - State of the connection.\n         */\n        this.onConnectionChanged = function (connectionState) { };\n\n        /**\n         * @public\n         * This eventlistener is called once when the \n         * ticket reader datachannel is ready to use after initiaization. Please implement externally.\n         */\n        this.onReady = function () { };\n\n        /**\n         * @public\n         * This eventlistener is called when the data \n         * for the connection offer is generated. Please implement externally.\n         * @param {Object} config - The config.\n         */\n        this.onOffer = function (config) { };\n\n        /**\n         * This callback is for onGetTicket eventlistener.\n         * @callback onGetTicketCallback\n         * @param {Object} ticket - The ticket as JS Object.\n         * @param {String} [errorMessage] - In case of ticket = null an error a message should be provided.\n         */\n\n        /**\n         * @public\n         * This eventlistener requires an identifier and a callback \n         * that needs to be called with the ticket as JS Object.\n         * Please implement externally.\n         * @param {String} identifier - Identifier of the ticket.\n         * @param {onGetTicketCallback} callback - Callback that should be called with a ticket Object.\n         */\n        this.onGetTicket = function (identifier, callback) { };\n\n        /**\n         * This callback is for onObliterateTicket eventlistener.\n         * @callback onObliterateTicketCallback\n         * @param {Boolean} success - Whether the obliterating was successful or not.\n         * @param {String} [errorMessage] - In case of success = false, an error message should be provided.\n         */\n\n        /**\n         * @public\n         * This eventlistener requires identifier and signature and a callback \n         * that needs to be called with true or false depending if successfully obliterated or not. \n         * Please implement externally.\n         * @param {String} identifier - Identifier of the ticket.\n         * @param {String} signature - Signature used for generating the identifier of the ticket.\n         * @param {onObliterateTicketCallback} callback - Callback that should be called with a ticket Object.\n         */\n        this.onObliterateTicket = function (identifier, signature, callback) { };\n\n        // Initializing the RTC connection\n        this.initConnection();\n    }\n\n    /**\n     * @private\n     * Prepares RTCPeerConnection and datachannels for\n     * the connection with a ticket reader client.\n     */\n    initConnection() {\n        const servers = null;\n        const dataConstraint = null;\n\n        this.icecandidates = [];\n\n        this.localPeerConnection = new RTCPeerConnection(servers);\n        this.localPeerConnection.addEventListener('icecandidate', this.iceCandidatesHandler);\n\n        this.localPeerConnection.addEventListener('connectionstatechange', this.connectionChangeHandler);\n\n        this.dataChannel = this.localPeerConnection.createDataChannel('sendDataChannel', dataConstraint);\n        this.dataChannel.addEventListener('message', this.messageHandler);\n        this.dataChannel.addEventListener('open', this.dataChannelOpenHandler);\n        this.dataChannel.addEventListener('close', this.dataChannelClosedHandler);\n\n        this.createOffer();\n    }\n\n    /**\n     * @private\n     * Eventhandler for new icecandidates from the RTCPeerConnection.\n     * Only for internal use.\n     * @param {RTCPeerConnectionIceEvent} event \n     */\n    iceCandidatesHandler(event) {\n        this.icecandidates.push(event.candidate);\n        if (this.offer && !this.qrcode) {\n            setTimeout(this.generateOfferCode, 200); // Set a delay to collect some more icecandidates\n        }\n    }\n\n    /**\n     * @private\n     * Eventhandler for changed connection states.\n     * Only for internal use. For external event-listening, the \"onConnectionChanged\" property\n     * should be implemented!\n     * @param {Event} event \n     */\n    connectionChangeHandler(event) {\n        console.debug(event);\n        let connectionState = event.target.connectionState;\n\n        switch (connectionState) {\n            case \"connected\":\n                // The connection has become fully connected\n                break;\n            case \"disconnected\":\n                break;\n            case \"failed\":\n                // One or more transports has terminated unexpectedly or in an error\n                break;\n            case \"closed\":\n                // The connection has been closed\n                break;\n            default:\n                break;\n        }\n\n        this.onConnectionChanged(connectionState);\n\n    }\n\n    /**\n     * @private\n     * Eventhandler for the case when the datachannel is ready.\n     * @param {Event} event \n     */\n    dataChannelOpenHandler(event) {\n        console.debug(event);\n        this.onReady();\n        this.dataChannel.send('Hallo Client!');\n    }\n\n    /**\n     * @private\n     * Eventhandler for the case when the datachannel is closed.\n     * @param {Event} event \n     */\n    dataChannelClosedHandler(event) {\n        console.debug('Data Channel Closed', event);\n    }\n\n    /**\n     * @private\n     * Eventhandler for new incoming messages via the datachannel.\n     * @param {Event} event \n     */\n    messageHandler(event) {\n        console.debug(\"Message received:\", event.data);\n        var msg;\n        try {\n            msg = JSON.parse(event.data);\n        } catch (e) {\n            console.error(e);\n            console.debug(\"Message was:\", event.data);\n            return;\n        }\n\n        /** Messages look like this...\n         * msg = {\n                type: \"Request\",     \n                reqId: Unique String,\n                context: String,\n                method: String,\n                params: [Any]\n            }\n         */\n\n        /** Answer Messages should look like this...\n        * msg = {\n               type: \"Answer\",\n               reqId: Unique String,\n               result: Any\n           }\n        */\n\n        // Switching between different request types and contexts\n        switch (msg.context) {\n            case \"ticketMirror\":\n                if (msg.method === \"getTicket\") {\n                    this.onGetTicket(msg.params[0], (ticket, errorMsg) => {\n                        let answerMsg = {\n                            reqId: msg.reqId,\n                            result: { ticket: ticket, errorMessage: errorMsg }\n                        }\n                        try {\n                            this.dataChannel.send(JSON.stringify(answerMsg));\n                        } catch (error) {\n                            console.error(error);\n                        }\n                    });\n                } else if (msg.method === \"obliterateTicket\") {\n                    this.onObliterateTicket(msg.params[0], msg.params[1], (success, errorMsg) => {\n                        let answerMsg = {\n                            reqId: msg.reqId,\n                            result: { success: success, errorMessage: errorMsg }\n                        }\n                        try {\n                            this.dataChannel.send(JSON.stringify(answerMsg));\n                        } catch (error) {\n                            console.error(error);\n                        }\n                    });\n                }\n                break;\n            default:\n                break;\n        }\n    }\n\n    /**\n     * @private\n     * Method to create unique id.\n     */\n    createUUID() {\n        var dt = new Date().getTime();\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n            var r = (dt + Math.random() * 16) % 16 | 0;\n            dt = Math.floor(dt / 16);\n            return (c === 'x' ? r : (r & 0x3 & 0x8)).toString(16);\n        });\n        return uuid;\n    }\n\n    /**\n     * @private\n     * Method that creates a new connection configuration offer.\n     */\n    async createOffer() {\n        this.offer = await this.localPeerConnection.createOffer().catch(console.error);\n        await this.localPeerConnection.setLocalDescription(this.offer).catch(console.error);\n    }\n\n    /**\n     * @private\n     * Method to generate a complete configuration for the\n     * ticketreader client.\n     */\n    async generateOfferCode() {\n        let data = { offer: this.offer, candidates: this.icecandidates };\n        this.onOffer(data);\n    }\n\n    /**\n     * @typedef {Object} TicketReaderConfig\n     * @property {RTCSessionDescriptionInit} answer\n     * @property {RTCIceCandidate[]} candidates\n     */\n\n    /**\n     * @public\n     * Method to set the connection config received from the\n     * ticketreader client.\n     * @param {TicketReaderConfig} config \n     */\n    async setTicketReaderConfig(config) {\n        // Setting remote description\n        await this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(config.answer)).catch(this.handleError);\n\n        // Adding ice candidates from remote\n        config.candidates.forEach((candidate) => {\n            this.localPeerConnection.addIceCandidate(candidate).catch(this.handleError);\n        });\n    }\n\n}\nexport default RemoteTicketReader;","import React from 'react';\nimport { Box, Button } from 'grommet';\nimport QRScanner from '../../Utilities/Components/QRScanner';\nimport Dialog from '../../Utilities/Components/Dialog';\n\nimport RemoteTicketReader from '../Classes/RemoteTicketReader';\n\nimport QRCode from 'qrcode';\nimport pako from 'pako';\n\n/**\n * The main unit (master) to which instances of TicketReader can connect.\n */\nclass TicketReaderManager extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {};\n        this.connectRemoteTicketReader = this.connectRemoteTicketReader.bind(this);\n        this.scanDoneHandler = this.scanDoneHandler.bind(this);\n    }\n\n    scanDoneHandler(binaryString){\n        let config = JSON.parse(pako.inflate(binaryString, { to: 'string' }));\n        this.state.connectRTR.setTicketReaderConfig(config);\n    }\n\n    /**\n     * Initiates the RTC Peer connection to an instance of TicketReader on another device.\n     */\n    connectRemoteTicketReader() {\n        let remoteTicketReader = new RemoteTicketReader();\n        remoteTicketReader.onReady = () => {\n            this.setState({ connectRTR: null });\n            this.props.onRTR(remoteTicketReader);\n        };\n        remoteTicketReader.onOffer = async (config) => {\n            // Compress data\n            let binaryString = pako.deflate(JSON.stringify(config), { level: 9, to: \"string\" });\n\n            // Create QR Code\n            let url = await QRCode.toDataURL(binaryString).catch(console.error);\n            this.setState({ RTRQRCode: url });\n        }\n        this.setState({ connectRTR: remoteTicketReader, addRTRStep: 0 });\n    }\n\n    disconnectRemoteTicketReader(remoteTicketReader) {\n\n    }\n\n    disconnectAll() {\n\n    }\n\n    render() {\n        return (\n            <Box className=\"TicketReaderManager\" pad=\"medium\">\n                <p>\n                    Derzeit sind {this.props.RTRList.length} Ticket Leser verbunden.\n                </p>\n                <Button onClick={this.connectRemoteTicketReader} label=\"Ticket Leser Hinzuf√ºgen\"></Button>\n                {this.state.connectRTR &&\n                    <Dialog title=\"Remote Ticket Reader Hinzuf√ºgen\" onAbort={() => { this.setState({ connectRTR: null }); }}>\n                        {this.state.addRTRStep === 0 &&\n                            <div>\n                                <div className=\"ticket-reader-qrcode\">\n                                    {!this.state.RTRQRCode && <div className=\"loader\">Loading...</div>}\n                                    {this.state.RTRQRCode && <img src={this.state.RTRQRCode} width=\"100%\" alt=\"Ein QR-Code sollte hier angezeigt werden.\" />}\n                                </div>\n                                <div className=\"ticket-reader-description\">\n                                    <p>Bitte mit dem Zielger√§t scannen</p>\n                                </div>\n                                <div className=\"ticket-reader-action\">\n                                    <Button onClick={() => { this.setState({ addRTRStep: 1 }); }} label=\"Weiter\"></Button>\n                                </div>\n                            </div>\n                        }\n                        {this.state.addRTRStep === 1 &&\n                            <div>\n                                <div className=\"ticket-reader-scanner\">\n                                    <QRScanner onDone={this.scanDoneHandler} label=\"Scanvorgang starten\"></QRScanner>\n                                </div>\n                                <div className=\"ticket-reader-description\">\n                                    <p>Bitte nun den Code des Zielger√§ts scannen</p>\n                                </div>\n                            </div>\n                        }\n                    </Dialog>\n                }\n            </Box>\n        );\n    }\n\n}\n\nexport default TicketReaderManager;","import React from 'react';\n//import './TicketOverview.css';\nimport { Box, Button, Accordion, AccordionPanel, Select } from 'grommet';\n\nclass InitialeListeEinlesen extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { listeEingelesen: false, initialeListe: [] };\n    }\n\n    render() {\n        if (!this.state.ListeEingelesen);\n        return;\n    }\n\n}\n\nclass SystemInitalisierung extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = { dateiTyp: \"CSV\" };\n        \n\n    }\n\n    render() {\n\n        return (\n            <Box className=\"SystemInitalisierung\" direction=\"column\" gap=\"medium\" pad=\"medium\">\n                <Box className=\"Auswahlmen√º\">\n                    <Select\n                        options={['CSV', 'XLSX']}\n                        value={this.state.dateiTyp}\n                        onChange={({ value, option }) => {this.setState({dateiTyp: option})}}\n                    />\n                </Box>\n            </Box>\n\n        );\n    }\n}\n\nexport default SystemInitalisierung;\n","import React from 'react';\nimport { Box } from 'grommet';\nimport { Switch, Route, Link } from \"react-router-dom\";\nimport IndexedDBExample from './Components/IndexedDBExample';\nimport TicketReaderManager from './Components/TicketReaderManager';\nimport SystemInitalisierung from './Components/SystemInitalisierung';\n\nimport LocalTicketMirror from './Classes/LocalTicketMirror';\n\n// eslint-disable-next-line\nimport RemoteTicketReader from './Classes/RemoteTicketReader';\n\nclass EventManagement extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.rTRHandler = this.rTRHandler.bind(this);\n\n        // Required code for offline ticket data sync\n        this.localTicketMirror = new LocalTicketMirror();\n\n        // RTRList should be an array of remoteTicketReaders\n        this.state = { RTRList: [] };\n    }\n\n    /**\n     * Handler for new connected remote ticket readers\n     * @param {RemoteTicketReader} remoteTicketReader \n     */\n    rTRHandler(remoteTicketReader) {\n        // Adding the remote ticket reader to the list\n        let RTRList = this.state.RTRList;\n        RTRList.push(remoteTicketReader);\n        this.setState({ RTRList: RTRList });\n\n        // In case the rtr is dicsonnected, it should be removed from the list in the view state\n        remoteTicketReader.onConnectionChanged = (connectionState) => {\n            console.log(connectionState);\n            /**console.debug(\"Attempting to remove closed remote ticket reader\");\n            let RTRList = this.state.RTRList;\n            let idx = RTRList.indexOf(remoteTicketReader);\n            RTRList.splice(idx, 1);\n            this.setState({ RTRList: RTRList });*/\n        }\n\n        // Setting eventhandler for reading a ticket\n        remoteTicketReader.onGetTicket = (identifier, callback) => {\n            // Trying to get the ticket from the IDB\n            this.localTicketMirror.getTicket(identifier).then((ticket) => {\n                callback(ticket);\n            }).catch((error) => { \n                // In case of an error, providing an error msg\n                callback(null, error);\n            });\n        }\n\n        // Setting eventhandler for obliterating a ticket\n        remoteTicketReader.onObliterateTicket = (identifier, signature, callback) => {\n            // TODO: Request localmirror \n            callback(true);\n        }\n    }\n\n    render() {\n        return (\n            <Box className=\"EventManagement\">\n                <ul>\n                    <li><Link to=\"/eventmgmt/rtrm\">Manage Remote Ticket Readers</Link></li>\n                    <li><Link to=\"/eventmgmt/entrancedb\">Show Entrance Dashboard</Link></li>\n                    <li><Link to=\"/eventmgmt/ticketshop\">Manage Ticketshop</Link></li>\n                    <li><Link to=\"/eventmgmt/SystemInitalisierung\">System Initalisieren</Link></li>\n                </ul>\n                <Switch>\n                    <Route path=\"/eventmgmt/rtrm\">\n                        <TicketReaderManager RTRList={this.state.RTRList} onRTR={this.rTRHandler}></TicketReaderManager>\n                    </Route>\n                    <Route path=\"/eventmgmt/entrancedb\">\n                        <IndexedDBExample localTicketMirror={this.localTicketMirror}></IndexedDBExample>\n                    </Route>\n                    <Route path=\"/eventmgmt/SystemInitalisierung\">\n                        <SystemInitalisierung></SystemInitalisierung>\n                    </Route>\n                    <Route path=\"/eventmgmt/ticketshop\">\n                        <Box pad=\"medium\">Hier m√ºsste dann sowas wie ein Ticketshop Management Dashboard hin...</Box>\n                    </Route>\n                </Switch>\n            </Box>\n        );\n    }\n}\n\nexport default EventManagement;\n","import React from 'react';\nimport './App.css';\nimport Ticketshop from './Ticketshop/Ticketshop';\nimport EntranceManagement from './EntranceManagement/EntranceManagement';\nimport EventManagement from './EventManagement/EventManagement';\nimport { Grommet, grommet } from 'grommet';\nimport { Switch, Route, Link } from \"react-router-dom\";\n\n\nclass App extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      account: null\n    };\n    this.scanDoneHandler = this.scanDoneHandler.bind(this);\n    this.obliterateTokens = this.obliterateTokens.bind(this);\n  }\n\n  errorDisplay(msg) {\n    alert('Sorry, there was an error. Please try again.');\n  }\n\n  scanDoneHandler(address) {\n    this.getAccountDetails(address).then((details) => {\n      if (!details.verified) {\n        return alert('Account nicht f√ºr TBN-Nutzung verifiziert');\n      }\n\n      this.getAccountBalance(address).then((balance) => {\n        const st = this.state;\n        st.account = {\n          address: address,\n          balance: balance,\n          verified: details.verified,\n          paidTickets: details.paidTickets,\n          poolTickets: details.poolTickets,\n          parkTickets: details.parkTickets\n        };\n        this.setState(st);\n      })\n    });\n  }\n\n  async getAccountBalance(address) {\n    // Fetch current token balance\n    const response = await fetch('http://localhost:3000/balanceOf?address=' + address, {\n      method: 'GET',\n      //headers: myHeaders,\n      mode: 'cors',\n      cache: 'no-cache',\n    }).catch(this.errorDisplay);\n    const data = await response.json().catch(this.errorDisplay);\n    return data;\n  }\n\n  async getAccountDetails(address) {\n    // Fetch current token balance\n    const response = await fetch('http://localhost:3000/accountDetails?address=' + address, {\n      method: 'GET',\n      //headers: myHeaders,\n      mode: 'cors',\n      cache: 'no-cache',\n    }).catch(this.errorDisplay);\n    const data = await response.json().catch(this.errorDisplay);\n    return data;\n  }\n\n  obliterateTokens(number) {\n    let prom = new Promise((resolve, reject) => {\n      setTimeout(() => { resolve('√úbertragen'); this.scanDoneHandler(null) }, 3000); // DUMMY\n      // Call transferFrom address to obliterate-wallet\n    });\n\n    return prom;\n  }\n\n  render() {\n    return (\n      <Grommet theme={grommet}>\n        <Switch>\n          <Route exact path=\"/\">\n            <ul>\n              <li><Link to=\"/guest\">Gast</Link></li>\n              <li><Link to=\"/entrance\">Einlass-Management</Link></li>\n              <li><Link to=\"/eventmgmt\">Event-Management</Link></li>\n            </ul>\n          </Route>\n        </Switch>\n        <Switch>\n          <Route path=\"/guest\">\n            <Ticketshop eigenschaft1=\"test\"></Ticketshop>\n          </Route>\n          <Route path=\"/entrance\">\n            <EntranceManagement></EntranceManagement>\n          </Route>\n          <Route path=\"/eventmgmt\">\n            <EventManagement></EventManagement>\n          </Route>\n        </Switch>\n      </Grommet>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { HashRouter } from \"react-router-dom\";\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<HashRouter><App /></HashRouter>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}