(this["webpackJsonpexample-client"]=this["webpackJsonpexample-client"]||[]).push([[0],{313:function(e,t,a){e.exports=a(618)},318:function(e,t,a){},320:function(e,t,a){},330:function(e,t){},355:function(e,t){},357:function(e,t){},398:function(e,t){},400:function(e,t){},429:function(e,t){},537:function(e,t){},589:function(e,t,a){},593:function(e,t,a){},594:function(e,t,a){},616:function(e,t,a){},618:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(153),i=a.n(c),s=a(39),l=(a(318),a(11)),o=a.n(l),d=a(33),u=a(19),h=a(20),m=a(12),p=a(18),b=a(21),v=(a(320),a(620)),f=a(628),k=a(631),E=a(77),g=a(633),C=a(634),O=a(127),y=a.n(O),w=a(291),j=a.n(w),_=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n.sign=n.sign.bind(Object(m.a)(n)),n.connectWallet=n.connectWallet.bind(Object(m.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.init()}},{key:"displayError",value:function(){alert("Ups, das hat nicht geklappt")}},{key:"init",value:function(){this.setState({walletAvailable:!!window.ethereum}),window.ethereum||(this.walletLink=new j.a({appName:"DHBW Bachelors Night Ticketing 2020",appLogoUrl:"https://einfachtierisch.de/media/cache/article_teaser/cms/2015/09/Katze-lacht-in-die-Kamera-shutterstock-Foonia-76562038.jpg?595617",darkMode:!1}),window.ethereum=this.walletLink.makeWeb3Provider("https://mainnet.infura.io/v3/efaece4f5f4443979063839c124c8171",1)),this.setState({connected:!!window.ethereum.selectedAddress}),this.web3=new y.a(window.ethereum)}},{key:"connectWallet",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.enable().catch(this.displayError);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:console.log("User's address is ".concat(t[0])),this.web3.eth.defaultAccount=t[0],this.setState({connected:!0});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t,a,n,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.ethereum){e.next=2;break}return e.abrupt("return",this.displayError());case 2:if(window.ethereum.selectedAddress){e.next=4;break}return e.abrupt("return",this.displayError());case 4:t=window.ethereum.selectedAddress,"Hallo du Frosch!",a=this.web3.utils.stringToHex("Hallo du Frosch!"),n=[a,t],"personal_sign",this.web3.currentProvider.send({method:"personal_sign",params:n,from:t},(function(e,n){if(e)return console.error(e);if(n.error)return console.error(n.error);console.log(n);var c=r.web3.eth.accounts.recover(a,n.result);c.toLowerCase()===t.toLowerCase()?alert("Successfully ecRecovered signer as "+t):alert("Failed to verify signer when comparing "+c+" to "+t)}));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"linkToDownloadMetaMask",value:function(){window.open("https://wallet.coinbase.com/","_blank")}},{key:"render",value:function(){return r.a.createElement(v.a,{className:"WalletSetup",direction:"column",gap:"medium",pad:"medium"},r.a.createElement("h1",null,"Wallet Setup"),r.a.createElement(g.a,null,"Um Tickets zu erwerben ben\xf6tigen Sie ein sogenanntes Wallet. Dieses ist vergleichbar mit Ihrer Geldb\xf6rse zu der nur Sie Zugriff haben."),!this.state.walletAvailable&&!this.state.connected&&r.a.createElement(v.a,{gap:"medium"},r.a.createElement(g.a,null,"F\xfcr unser Ticket-System muss dieses Wallet Ethereum-f\xe4hig sein. Wir empfehlen Ihnen daher das Coinbase Wallet. Bitte installieren Sie sich das Coinbase Wallet \xfcber die offizielle Website. Kommen Sie nach Abschluss der Einrichtung wieder auf diese Seite zur\xfcck."),r.a.createElement(C.a,{label:"Coinbase f\xfcr's Smartphone installieren",onClick:this.linkToDownloadMetaMask})),!this.state.connected&&r.a.createElement(v.a,{gap:"medium"},r.a.createElement(g.a,null,"Als N\xe4chstes ben\xf6tigt unsere Plattform die Adresse Ihres Wallets. Bitte best\xe4tigen Sie daher die Verbindung mit Ihrem Wallet \xfcber folgende Schaltfl\xe4che. Sie geben dadurch ",r.a.createElement("b",null,"nicht")," Ihre Kontrolle \xfcber das Wallet ab!"),r.a.createElement(C.a,{label:"Mit dem Wallet verbinden",onClick:this.connectWallet})),r.a.createElement(g.a,null,"Hier folgt eine DEMO!!!"),r.a.createElement(C.a,{label:"Sign and Verify Message",onClick:this.sign}))}}]),a}(r.a.Component),H=(a(589),function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement(v.a,{className:"UserMainMenu",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(s.b,{className:"MenuLink",to:"/guest/tickets"},"Tickets Anzeigen"),r.a.createElement(s.b,{className:"MenuLink",to:"/guest/"},"Tickets Bestellen"),r.a.createElement(s.b,{className:"MenuLink",to:"/guest/"},"Bestellungen Anzeigen"),r.a.createElement(s.b,{className:"MenuLink",to:"/guest/setup"},"Setup"))}}]),a}(r.a.Component)),T=(a(593),a(594),a(128)),S=a.n(T),R=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={qrcode:void 0},n.web3=new y.a(y.a.givenProvider||"ws://localhost:8545"),n.state={error:!1},n.sign(),n}return Object(h.a)(a,[{key:"sign",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t,a,n,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect();case 2:return e.next=4,this.getSelectedAddress();case 4:t=e.sent,"Hallo du Frosch!",a=this.web3.utils.stringToHex("Hallo du Frosch!"),n=[a,t],"personal_sign",this.web3.currentProvider.sendAsync({method:"personal_sign",params:n,from:t},(function(e,t){if(e)return r.setState({error:!0}),console.error(e);if(t.error)return r.setState({error:!0}),console.error(t.error);var a=t.result;S.a.toDataURL(a).then((function(e){r.setState({qrcode:e})})).catch((function(e){r.setState({error:!0}),console.error(e)}))}));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof window.ethereum){e.next=3;break}return e.next=3,window.ethereum.enable().catch(console.error);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getSelectedAddress",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.web3.eth.getAccounts().catch(console.error);case 2:return t=e.sent,e.abrupt("return",t[0].toLowerCase());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(v.a,{className:"Obliterator",direction:"column",gap:"medium",pad:"medium"},!this.state.error&&r.a.createElement(v.a,null,r.a.createElement("img",{src:this.state.qrcode,alt:"QRCODE",width:"300px",height:"300px"}),r.a.createElement("h2",null,this.props.ticketType)),this.state.error&&r.a.createElement(v.a,null,r.a.createElement(g.a,null,"Ups, das hat nicht geklappt!")),r.a.createElement(C.a,{label:"Fertig",onClick:this.props.onReady}))}}]),a}(r.a.Component),N=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).obliterate=n.obliterate.bind(Object(m.a)(n)),n.onReadyHandler=n.onReadyHandler.bind(Object(m.a)(n)),n.state={obliterate:void 0},n}return Object(h.a)(a,[{key:"onReadyHandler",value:function(){this.setState({obliterate:void 0})}},{key:"obliterate",value:function(){this.setState({obliterate:"Absolvent"})}},{key:"render",value:function(){return r.a.createElement(v.a,{className:"TicketOverview",direction:"column",gap:"medium",pad:"medium"},r.a.createElement(v.a,null,r.a.createElement(v.a,null,r.a.createElement("h1",{className:"NumberOfTickets"},"4")),r.a.createElement(v.a,null,r.a.createElement(v.a,{className:"Ticket",direction:"row",gap:"small",pad:"small"},r.a.createElement(g.a,{className:"Type"},"Absolvent"),r.a.createElement(C.a,{label:"Einl\xf6sen",onClick:this.obliterate})),r.a.createElement(v.a,{className:"Ticket",direction:"row",gap:"small",pad:"small"},r.a.createElement(g.a,{className:"Type"},"Gast Regul\xe4r"),r.a.createElement(C.a,{label:"Einl\xf6sen",onClick:this.obliterate})),r.a.createElement(v.a,{className:"Ticket",direction:"row",gap:"small",pad:"small"},r.a.createElement(g.a,{className:"Type"},"Gast Regul\xe4r"),r.a.createElement(C.a,{label:"Einl\xf6sen",onClick:this.obliterate})),r.a.createElement(v.a,{className:"Ticket",direction:"row",gap:"small",pad:"small"},r.a.createElement(g.a,{className:"Type"},"Parken"),r.a.createElement(C.a,{label:"Einl\xf6sen",onClick:this.obliterate})))),this.state.obliterate&&r.a.createElement(R,{ticketType:this.state.obliterate,onReady:this.onReadyHandler}))}}]),a}(r.a.Component),D=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement(v.a,{className:"Guest"},r.a.createElement(f.a,{background:"brand",justify:"between",pad:"10px"},r.a.createElement(s.b,{to:"/guest"},"Home"),r.a.createElement(k.a,{label:"Account",items:[{label:"Logout"}]})),r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/guest/tickets"},r.a.createElement(N,null)),r.a.createElement(E.a,{path:"/guest/setup"},r.a.createElement(_,null)),r.a.createElement(E.a,{path:"/guest/"},r.a.createElement(H,null))))}}]),a}(r.a.Component),x=a(310),A=a(308),L=a.n(A),M=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n.video=r.a.createRef(),n.canvasElement=r.a.createRef(),n.startScan=n.startScan.bind(Object(m.a)(n)),n.tick=n.tick.bind(Object(m.a)(n)),n}return Object(h.a)(a,[{key:"componentWillUnmount",value:function(){this.stopScan()}},{key:"tick",value:function(){if(this.video&&this.video.current){if(this.video.current.readyState===this.video.current.HAVE_ENOUGH_DATA){this.canvasElement.current.height=this.video.current.videoHeight,this.canvasElement.current.width=this.video.current.videoWidth,this.canvas.drawImage(this.video.current,0,0,this.canvasElement.current.width,this.canvasElement.current.height);var e=this.canvas.getImageData(0,0,this.canvasElement.current.width,this.canvasElement.current.height),t=L()(e.data,e.width,e.height,{inversionAttempts:"dontInvert"});if(t)switch(this.props.contentType){case"ETHEREUM_ADDRESS":var a=t.data.match(Object(x.a)(/(?:ethereum:)(0x[0-9A-Za-z]*)/,{address:1}));if(a&&a.groups.address)return this.stopScan(),void this.props.onDone(a.groups.address);break;case"ETHEREUM_SIGNATURE":case"IP_ADDRESS":case"JSON_DATA":break;default:return this.stopScan(),void this.props.onDone(t.data)}}requestAnimationFrame(this.tick)}}},{key:"startScan",value:function(){var e=this;if(!navigator.mediaDevices)return alert("Der Browser unterst\xfctzt diese Funktion nicht.");navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:300,height:300}}).then((function(t){e.canvas=e.canvasElement.current.getContext("2d"),e.video.current.srcObject=t,e.video.current.setAttribute("playsinline",!0),e.video.current.play(),requestAnimationFrame(e.tick),e.setState({isScanning:!0})})).catch((function(e){console.error(e),alert("Sorry, Kamera-Stream konnte nicht geladen werden.")}))}},{key:"stopScan",value:function(){this.video&&this.video.current&&this.video.current.srcObject&&(this.video.current.srcObject.getVideoTracks()[0].stop(),this.setState({isScanning:!1}))}},{key:"render",value:function(){return r.a.createElement(v.a,{className:"QRScanner"},r.a.createElement(v.a,{pad:"medium"},r.a.createElement("canvas",{ref:this.canvasElement,hidden:!this.state.isScanning}),r.a.createElement("video",{ref:this.video,hidden:!0})),!this.state.isScanning&&r.a.createElement(C.a,{label:this.props.label||"Scan",onClick:this.startScan}))}}]),a}(r.a.Component),P=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).obliterate=n.obliterate.bind(Object(m.a)(n)),n.state={obliterating:!1},n}return Object(h.a)(a,[{key:"obliterate",value:function(){var e=this,t=this.state;t.obliterating=!0,this.setState(t),this.props.onStartObliterate(2).then((function(e){alert(e)})).catch((function(a){alert(a),t.obliterating=!1,e.setState(t)}))}},{key:"render",value:function(){var e=parseInt(this.props.account.poolTickets)+parseInt(this.props.account.paidTickets)+parseInt(this.props.account.parkTickets),t=parseInt(this.props.account.balance);return r.a.createElement(v.a,{className:"ObliteratePanel",direction:"column",gap:"medium",pad:"medium"},r.a.createElement("span",null,"Wallet Address: ",this.props.account.address),r.a.createElement("span",null,"Balance: ",this.props.account.balance),!this.state.obliterating&&r.a.createElement(v.a,{gap:"small"},t===e+1&&r.a.createElement(C.a,{label:"Studenten-Ticket Einl\xf6sen",onClick:this.obliterate}),t<=e+1&&r.a.createElement(C.a,{label:"Besucher-Ticket Einl\xf6sen",onClick:this.obliterate})),this.state.obliterating&&r.a.createElement("span",null,"Obliterating Tickets..."))}}]),a}(r.a.Component),W=(a(617),a(616),function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={step:0},n._iceCandidatesHandler=n._iceCandidatesHandler.bind(Object(m.a)(n)),n._dataChannelOpenHandler=n._dataChannelOpenHandler.bind(Object(m.a)(n)),n._generateOfferCode=n._generateOfferCode.bind(Object(m.a)(n)),n._abortHandler=n._abortHandler.bind(Object(m.a)(n)),n._scanDoneHandler=n._scanDoneHandler.bind(Object(m.a)(n)),n._dataChannelClosedHandler=n._dataChannelClosedHandler.bind(Object(m.a)(n)),n._initConnection(),n}return Object(h.a)(a,[{key:"_initConnection",value:function(){this.icecandidates=[],this.localPeerConnection=new RTCPeerConnection(null),this.localPeerConnection.addEventListener("icecandidate",this._iceCandidatesHandler),this.localPeerConnection.addEventListener("iceconnectionstatechange",this._connectionChangeHandler),this.dataChannel=this.localPeerConnection.createDataChannel("sendDataChannel",null),this.dataChannel.addEventListener("message",this._messageHandler),this.dataChannel.addEventListener("open",this._dataChannelOpenHandler),this.dataChannel.addEventListener("close",this._dataChannelClosedHandler),this._createOffer()}},{key:"_iceCandidatesHandler",value:function(e){this.icecandidates.length<=1&&this.icecandidates.push(e.candidate),this.offer&&!this.qrcode&&setTimeout(this._generateOfferCode,100)}},{key:"_connectionChangeHandler",value:function(e){console.log(e)}},{key:"_dataChannelOpenHandler",value:function(e){console.log(e),this.props.onReady(),this.dataChannel.send("Hallo Client!")}},{key:"_dataChannelClosedHandler",value:function(e){console.log(e),this.props.onClosed()}},{key:"_messageHandler",value:function(e){alert(e.data)}},{key:"_readTicketRemote",value:function(){}},{key:"_obliterateTicketRemote",value:function(){}},{key:"_createOffer",value:function(){var e=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.localPeerConnection.createOffer().catch(console.error);case 2:return this.offer=e.sent,e.next=5,this.localPeerConnection.setLocalDescription(this.offer).catch(console.error);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_generateOfferCode",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={offer:this.offer,candidates:this.icecandidates},e.next=3,S.a.toDataURL(JSON.stringify(t)).catch(console.error);case 3:a=e.sent,this.setState({qrcode:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_scanDoneHandler",value:function(){var e=Object(d.a)(o.a.mark((function e(t){var a,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(t),e.next=3,this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(a.answer)).catch(this.handleError);case 3:a.candidates.forEach((function(e){n.localPeerConnection.addIceCandidate(e).catch(n.handleError)}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_abortHandler",value:function(){this.props.onAbort()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"ticket-reader-dialog"},r.a.createElement("div",{className:"ticket-reader-background-box"}),r.a.createElement("div",{className:"ticket-reader-dialog-center"},r.a.createElement("div",{className:"ticket-reader-dialog-box"},r.a.createElement("div",{className:"ticket-reader-db-header"},r.a.createElement("h1",null,"Remote Ticket Reader Hinzuf\xfcgen"),r.a.createElement(C.a,{className:"abort",onClick:this._abortHandler},"X")),0===this.state.step&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-qrcode"},!this.state.qrcode&&r.a.createElement("div",{className:"loader"},"Loading..."),this.state.qrcode&&r.a.createElement("img",{src:this.state.qrcode,alt:"Ein QR-Code sollte hier angezeigt werden."})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte mit dem Zielger\xe4t scannen")),r.a.createElement("div",{className:"ticket-reader-action"},r.a.createElement(C.a,{onClick:function(){e.setState({step:1})},label:"Weiter"}))),1===this.state.step&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-scanner"},r.a.createElement(M,{onDone:this._scanDoneHandler,label:"Scanvorgang starten"})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte nun den Code des Zielger\xe4ts scannen"))))))}}]),a}(r.a.Component)),B=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={step:0},n._iceCandidatesHandler=n._iceCandidatesHandler.bind(Object(m.a)(n)),n._dataChannelOpenHandler=n._dataChannelOpenHandler.bind(Object(m.a)(n)),n._receiveChannelHandler=n._receiveChannelHandler.bind(Object(m.a)(n)),n._generateAnswerCode=n._generateAnswerCode.bind(Object(m.a)(n)),n._abortHandler=n._abortHandler.bind(Object(m.a)(n)),n._scanDoneHandler=n._scanDoneHandler.bind(Object(m.a)(n)),n._dataChannelClosedHandler=n._dataChannelClosedHandler.bind(Object(m.a)(n)),n._initConnection(),n}return Object(h.a)(a,[{key:"_initConnection",value:function(){this.icecandidates=[],this.localPeerConnection=new RTCPeerConnection(null),this.localPeerConnection.addEventListener("icecandidate",this._iceCandidatesHandler),this.localPeerConnection.addEventListener("iceconnectionstatechange",this._connectionChangeHandler),this.localPeerConnection.addEventListener("datachannel",this._receiveChannelHandler)}},{key:"_iceCandidatesHandler",value:function(e){this.icecandidates.length<=1&&this.icecandidates.push(e.candidate),this.answer&&!this.qrcode&&setTimeout(this._generateAnswerCode,100)}},{key:"_connectionChangeHandler",value:function(e){console.log(e)}},{key:"_dataChannelOpenHandler",value:function(e){console.log(e),this.props.onReady(),this.dataChannel.send("Hallo Master!")}},{key:"_dataChannelClosedHandler",value:function(e){console.log(e),this.props.onClosed()}},{key:"_messageHandler",value:function(e){alert(e.data)}},{key:"_receiveChannelHandler",value:function(e){this.dataChannel=e.channel,this.dataChannel.addEventListener("message",this._messageHandler),this.dataChannel.addEventListener("open",this._dataChannelOpenHandler),this.dataChannel.addEventListener("close",this._dataChannelClosedHandler)}},{key:"_readTicketRemote",value:function(){}},{key:"_obliterateTicketRemote",value:function(){}},{key:"_generateAnswerCode",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={answer:this.answer,candidates:this.icecandidates},e.next=3,S.a.toDataURL(JSON.stringify(t)).catch(console.error);case 3:a=e.sent,this.setState({qrcode:a});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_scanDoneHandler",value:function(){var e=Object(d.a)(o.a.mark((function e(t){var a,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(t),e.next=3,this.localPeerConnection.setRemoteDescription(new RTCSessionDescription(a.offer)).catch(console.error);case 3:return a.candidates.forEach((function(e){n.localPeerConnection.addIceCandidate(e).catch(console.error)})),e.next=6,this.localPeerConnection.createAnswer().catch(console.error);case 6:return this.answer=e.sent,e.next=9,this.localPeerConnection.setLocalDescription(this.answer).catch(console.error);case 9:this.setState({step:1});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_abortHandler",value:function(){this.props.onAbort()}},{key:"render",value:function(){return r.a.createElement("div",{className:"ticket-reader-dialog"},r.a.createElement("div",{className:"ticket-reader-background-box"}),r.a.createElement("div",{className:"ticket-reader-dialog-center"},r.a.createElement("div",{className:"ticket-reader-dialog-box"},r.a.createElement("div",{className:"ticket-reader-db-header"},r.a.createElement("h1",null,"Als Ticket Reader verbinden"),r.a.createElement(C.a,{className:"abort",onClick:this._abortHandler},"X")),0===this.state.step&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-scanner"},r.a.createElement(M,{onDone:this._scanDoneHandler,label:"Scanvorgang starten"})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte den Code des Initiators scannen"))),1===this.state.step&&r.a.createElement("div",null,r.a.createElement("div",{className:"ticket-reader-qrcode"},!this.state.qrcode&&r.a.createElement("div",{className:"loader"},"Loading..."),this.state.qrcode&&r.a.createElement("img",{src:this.state.qrcode,alt:"Ein QR-Code sollte hier angezeigt werden."})),r.a.createElement("div",{className:"ticket-reader-description"},r.a.createElement("p",null,"Bitte nun mit dem Initiator Ger\xe4t scannen"))))))}}]),a}(r.a.Component),I=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={remoteTicketReader:[]},n.connectRemoteTicketReader=n.connectRemoteTicketReader.bind(Object(m.a)(n)),n}return Object(h.a)(a,[{key:"connectRemoteTicketReader",value:function(){var e=this,t=r.a.createElement(W,{onAbort:function(){e.setState({connect:null})},onReady:function(){e.setState({connect:null});var a=e.state.remoteTicketReader;a.push(t),e.setState({remoteTicketReader:a})},onClosed:function(){console.log("Attempting to remove closed ticketreader");var a=e.state.remoteTicketReader;console.log(a);var n=a.indexOf(t);a.splice(n,1),console.log(a),e.setState({remoteTicketReader:a})}});this.setState({connect:t})}},{key:"disconnectRemoteTicketReader",value:function(e){}},{key:"disconnectAll",value:function(){}},{key:"render",value:function(){return r.a.createElement(v.a,{className:"TicketReaderManager",pad:"medium"},r.a.createElement("p",null,"Derzeit sind ",this.state.remoteTicketReader.length," Ticket Leser verbunden."),r.a.createElement(C.a,{onClick:this.connectRemoteTicketReader,label:"Ticket Leser Hinzuf\xfcgen"}),this.state.connect)}}]),a}(r.a.Component),z=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n.connectTicketReader=n.connectTicketReader.bind(Object(m.a)(n)),n._closedHandler=n._closedHandler.bind(Object(m.a)(n)),n._readyHandler=n._readyHandler.bind(Object(m.a)(n)),n._abortHandler=n._abortHandler.bind(Object(m.a)(n)),n}return Object(h.a)(a,[{key:"connectTicketReader",value:function(){this.ticketReader=r.a.createElement(B,{onAbort:this._abortHandler,onReady:this._readyHandler,onClosed:this._closedHandler}),this.setState({connectTR:this.ticketReader})}},{key:"_abortHandler",value:function(){this.setState({connectTR:null})}},{key:"_closedHandler",value:function(){this.setState({connected:!1})}},{key:"_readyHandler",value:function(){this.setState({connectTR:null,connected:!0})}},{key:"render",value:function(){return r.a.createElement(v.a,{className:"EntranceManagement",pad:"medium"},!this.state.connected&&r.a.createElement(v.a,null,r.a.createElement("p",null,"Wenn Sie dieses Ger\xe4t als Ticket Leser verwenden m\xf6chten, m\xfcssen Sie es erst mit dem Event-Manager verbinden."),r.a.createElement("p",null,"Bitte stellen Sie sicher, dass dieses Ger\xe4t mit dem selben lokalen Netzwerk, wie der Event-Manager verbunden ist."),r.a.createElement(C.a,{onClick:this.connectTicketReader,label:"Ticket Reader Aktivieren"}),this.state.connectTR),this.state.connected&&r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/entrance/test"},!this.state.account&&r.a.createElement(M,{contentType:"ETHEREUM_ADDRESS",onDone:this.scanDoneHandler}),this.state.account&&r.a.createElement(P,{account:this.state.account,onStartObliterate:this.obliterateTokens})),r.a.createElement(E.a,{path:"/entrance/"},r.a.createElement("p",null,"Wunderbar, Sie sind verbunden..."),r.a.createElement("p",null,"In Zukunft sollten hier Funktionen zum Ticket-Scan stehen..."),r.a.createElement(C.a,{label:"Beispiel Funktion 1"}),r.a.createElement(C.a,{label:"Beispiel Funktion 2"}),r.a.createElement(C.a,{label:"Beispiel Funktion 3"}))))}}]),a}(r.a.Component),q=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"showTicketHandler",value:function(){var e=Object(d.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(new I).connectTicketReader();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(v.a,{className:"IndexedDBExample"},r.a.createElement(I,null))}}]),a}(r.a.Component),U=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={},n}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement(v.a,{className:"EventManagement"},r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/"},r.a.createElement(q,null))))}}]),a}(r.a.Component),F=a(632),G=a(630),J=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={account:null},n.scanDoneHandler=n.scanDoneHandler.bind(Object(m.a)(n)),n.obliterateTokens=n.obliterateTokens.bind(Object(m.a)(n)),n}return Object(h.a)(a,[{key:"errorDisplay",value:function(e){alert("Sorry, there was an error. Please try again.")}},{key:"scanDoneHandler",value:function(e){var t=this;this.getAccountDetails(e).then((function(a){if(!a.verified)return alert("Account nicht f\xfcr TBN-Nutzung verifiziert");t.getAccountBalance(e).then((function(n){var r=t.state;r.account={address:e,balance:n,verified:a.verified,paidTickets:a.paidTickets,poolTickets:a.poolTickets,parkTickets:a.parkTickets},t.setState(r)}))}))}},{key:"getAccountBalance",value:function(){var e=Object(d.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3000/balanceOf?address="+t,{method:"GET",mode:"cors",cache:"no-cache"}).catch(this.errorDisplay);case 2:return a=e.sent,e.next=5,a.json().catch(this.errorDisplay);case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAccountDetails",value:function(){var e=Object(d.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3000/accountDetails?address="+t,{method:"GET",mode:"cors",cache:"no-cache"}).catch(this.errorDisplay);case 2:return a=e.sent,e.next=5,a.json().catch(this.errorDisplay);case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obliterateTokens",value:function(e){var t=this;return new Promise((function(e,a){setTimeout((function(){e("\xdcbertragen"),t.scanDoneHandler(null)}),3e3)}))}},{key:"render",value:function(){return r.a.createElement(F.a,{theme:G.a},r.a.createElement(E.c,null,r.a.createElement(E.a,{exact:!0,path:"/"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(s.b,{to:"/guest"},"Gast")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/entrance"},"Einlass-Management")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/eventmgmt"},"Event-Management"))))),r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/guest"},r.a.createElement(D,null)),r.a.createElement(E.a,{path:"/entrance"},r.a.createElement(z,null)),r.a.createElement(E.a,{path:"/eventmgmt"},r.a.createElement(U,null))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(s.a,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[313,1,2]]]);
//# sourceMappingURL=main.39531e05.chunk.js.map